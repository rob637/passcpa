/**
 * CISA Diagnostic Quiz
 * 25-question assessment covering all 5 CISA domains to identify knowledge gaps.
 * Single exam format — no sections, just domains.
 */
import type { DiagnosticQuiz } from '../../../types/diagnostic';

export const CISA_AREA_NAMES: Record<string, string> = {
  'CISA1': 'Information Systems Auditing Process',
  'CISA2': 'Governance and Management of IT',
  'CISA3': 'Information Systems Acquisition, Development, and Implementation',
  'CISA4': 'Information Systems Operations and Business Resilience',
  'CISA5': 'Protection of Information Assets',
};

export const CISA_DIAGNOSTIC: DiagnosticQuiz = {
  courseId: 'cisa',
  section: 'CISA',
  title: 'CISA Diagnostic Assessment',
  description: 'Assess your readiness across all 5 CISA domains',
  timeLimit: 35,
  passingScore: 65,
  questions: [
    // Domain 1: Information Systems Auditing Process (21%) — 5 questions
    {
      id: 'cisa-d01',
      question: 'An IS auditor discovers that a critical control is not operating effectively. The auditor should FIRST:',
      options: ['Report to external regulators', 'Inform management and assess compensating controls', 'Immediately halt the audit', 'Implement a corrective control'],
      correctAnswer: 1,
      blueprintArea: 'CISA1',
      topic: 'Audit Process',
      difficulty: 'medium',
      explanation: 'The auditor should inform management and evaluate whether compensating controls mitigate the risk.',
    },
    {
      id: 'cisa-d02',
      question: 'Risk-based audit planning requires the IS auditor to:',
      options: ['Audit all areas equally', 'Prioritize areas based on risk assessment', 'Only audit areas with prior findings', 'Follow the same plan as last year'],
      correctAnswer: 1,
      blueprintArea: 'CISA1',
      topic: 'Risk-Based Planning',
      difficulty: 'easy',
      explanation: 'Risk-based planning directs audit resources to areas of highest risk.',
    },
    {
      id: 'cisa-d03',
      question: 'The PRIMARY purpose of audit evidence is to:',
      options: ['Prove management is wrong', 'Support audit findings and conclusions', 'Satisfy regulatory requirements', 'Create a paper trail'],
      correctAnswer: 1,
      blueprintArea: 'CISA1',
      topic: 'Audit Evidence',
      difficulty: 'easy',
      explanation: 'Audit evidence provides the factual basis for findings, conclusions, and recommendations.',
    },
    {
      id: 'cisa-d04',
      question: 'Substantive testing is PRIMARILY used to:',
      options: ['Evaluate control design', 'Detect material errors or irregularities in data', 'Test system availability', 'Evaluate employee competency'],
      correctAnswer: 1,
      blueprintArea: 'CISA1',
      topic: 'Testing Methods',
      difficulty: 'medium',
      explanation: 'Substantive testing verifies the integrity and accuracy of data and transactions.',
    },
    {
      id: 'cisa-d05',
      question: 'The IS audit charter should define:',
      options: ['Technical testing procedures', 'Authority, scope, and responsibility of the IS audit function', 'Specific software to use', 'Employee salary bands'],
      correctAnswer: 1,
      blueprintArea: 'CISA1',
      topic: 'Audit Charter',
      difficulty: 'easy',
      explanation: 'The charter defines the IS audit function\'s authority, scope, and responsibilities.',
    },

    // Domain 2: Governance and Management of IT (16%) — 4 questions
    {
      id: 'cisa-d06',
      question: 'IT governance is PRIMARILY the responsibility of:',
      options: ['The IT department', 'The board and executive management', 'External auditors', 'The compliance team'],
      correctAnswer: 1,
      blueprintArea: 'CISA2',
      topic: 'IT Governance',
      difficulty: 'easy',
      explanation: 'IT governance is a board/executive responsibility ensuring IT supports organizational objectives.',
    },
    {
      id: 'cisa-d07',
      question: 'An IT strategic plan should align with:',
      options: ['Industry trends only', 'The organization\'s business strategy and objectives', 'Current IT budget constraints', 'Vendor recommendations'],
      correctAnswer: 1,
      blueprintArea: 'CISA2',
      topic: 'IT Strategy',
      difficulty: 'easy',
      explanation: 'IT strategy must be aligned with and support the business objectives.',
    },
    {
      id: 'cisa-d08',
      question: 'A RACI matrix helps ensure:',
      options: ['All employees are paid equally', 'Clear assignment of roles: Responsible, Accountable, Consulted, Informed', 'Budget allocation efficiency', 'Software licensing compliance'],
      correctAnswer: 1,
      blueprintArea: 'CISA2',
      topic: 'IT Management',
      difficulty: 'easy',
      explanation: 'RACI clarifies roles and responsibilities in organizational processes.',
    },
    {
      id: 'cisa-d09',
      question: 'IT risk management should be:',
      options: ['A one-time exercise', 'Integrated into the enterprise risk management framework', 'Handled by IT staff only', 'Performed only after incidents'],
      correctAnswer: 1,
      blueprintArea: 'CISA2',
      topic: 'IT Risk Management',
      difficulty: 'medium',
      explanation: 'IT risk management should be integrated into the broader enterprise risk management program.',
    },

    // Domain 3: IS Acquisition, Development, and Implementation (18%) — 5 questions
    {
      id: 'cisa-d10',
      question: 'The MOST important control in system change management is:',
      options: ['Documenting all changes', 'Testing changes before implementation', 'Having a rollback plan', 'All of the above are equally important'],
      correctAnswer: 3,
      blueprintArea: 'CISA3',
      topic: 'Change Management',
      difficulty: 'medium',
      explanation: 'Effective change management requires documentation, testing, rollback planning, and approval.',
    },
    {
      id: 'cisa-d11',
      question: 'User acceptance testing (UAT) is performed to:',
      options: ['Verify technical performance', 'Confirm the system meets business requirements', 'Test network bandwidth', 'Evaluate code quality'],
      correctAnswer: 1,
      blueprintArea: 'CISA3',
      topic: 'Testing',
      difficulty: 'easy',
      explanation: 'UAT validates that the system meets business requirements from the end-user perspective.',
    },
    {
      id: 'cisa-d12',
      question: 'A feasibility study in system acquisition should evaluate:',
      options: ['Only cost', 'Technical, economic, operational, and schedule feasibility', 'Only vendor reputation', 'Only security features'],
      correctAnswer: 1,
      blueprintArea: 'CISA3',
      topic: 'System Acquisition',
      difficulty: 'easy',
      explanation: 'Feasibility covers technical, economic, operational, and schedule dimensions.',
    },
    {
      id: 'cisa-d13',
      question: 'In the SDLC, the MOST critical audit involvement occurs during:',
      options: ['Maintenance', 'Requirements definition phase', 'Implementation', 'Disposal'],
      correctAnswer: 1,
      blueprintArea: 'CISA3',
      topic: 'SDLC',
      difficulty: 'medium',
      explanation: 'Early auditor involvement during requirements ensures controls are built into the design.',
    },
    {
      id: 'cisa-d14',
      question: 'Post-implementation review should verify:',
      options: ['The project was under budget', 'Expected benefits are being realized and controls are effective', 'All vendors were paid', 'The technology is the newest available'],
      correctAnswer: 1,
      blueprintArea: 'CISA3',
      topic: 'Post-Implementation',
      difficulty: 'easy',
      explanation: 'Post-implementation reviews validate that expected benefits are achieved and controls operate effectively.',
    },

    // Domain 4: IS Operations and Business Resilience (20%) — 5 questions
    {
      id: 'cisa-d15',
      question: 'Recovery Time Objective (RTO) is defined as:',
      options: ['The time to complete a backup', 'The maximum tolerable downtime before operations must resume', 'The age of the oldest recoverable backup', 'The time to detect a disaster'],
      correctAnswer: 1,
      blueprintArea: 'CISA4',
      topic: 'BCP/DRP',
      difficulty: 'easy',
      explanation: 'RTO: maximum acceptable time between disruption and restoration of service.',
    },
    {
      id: 'cisa-d16',
      question: 'A hot site provides:',
      options: ['Storage for backup tapes only', 'A fully operational alternate facility ready for immediate use', 'Office space without IT infrastructure', 'Temporary housing for employees'],
      correctAnswer: 1,
      blueprintArea: 'CISA4',
      topic: 'Disaster Recovery',
      difficulty: 'easy',
      explanation: 'A hot site is a fully equipped and operational facility available for immediate failover.',
    },
    {
      id: 'cisa-d17',
      question: 'Service Level Agreements (SLAs) should include:',
      options: ['Only cost terms', 'Performance metrics, availability targets, and penalties for non-compliance', 'Technical specifications only', 'Vendor marketing materials'],
      correctAnswer: 1,
      blueprintArea: 'CISA4',
      topic: 'IT Service Management',
      difficulty: 'easy',
      explanation: 'SLAs define performance metrics, availability, response times, and remedies for non-compliance.',
    },
    {
      id: 'cisa-d18',
      question: 'Job scheduling controls ensure:',
      options: ['All employees have work', 'Processing occurs in the correct sequence and at the right time', 'CPU utilization is maximized', 'No overtime is needed'],
      correctAnswer: 1,
      blueprintArea: 'CISA4',
      topic: 'IT Operations',
      difficulty: 'easy',
      explanation: 'Job scheduling ensures batch processing runs in correct sequence and timing.',
    },
    {
      id: 'cisa-d19',
      question: 'A business impact analysis (BIA) determines:',
      options: ['Insurance premiums', 'The impact of disruptions on business functions and their recovery priorities', 'Employee headcount reductions', 'Software licensing costs'],
      correctAnswer: 1,
      blueprintArea: 'CISA4',
      topic: 'Business Impact Analysis',
      difficulty: 'medium',
      explanation: 'BIA identifies critical functions, assesses disruption impact, and sets recovery priorities.',
    },

    // Domain 5: Protection of Information Assets (25%) — 6 questions
    {
      id: 'cisa-d20',
      question: 'The principle of least privilege means:',
      options: ['Users have no access', 'Users are granted only the access necessary to perform their job', 'All users have the same access', 'Privileged access is given to senior management only'],
      correctAnswer: 1,
      blueprintArea: 'CISA5',
      topic: 'Access Control',
      difficulty: 'easy',
      explanation: 'Least privilege: users receive only the minimum access required for their role.',
    },
    {
      id: 'cisa-d21',
      question: 'A firewall operates PRIMARILY at which OSI layers?',
      options: ['Physical and Data Link', 'Network and Transport', 'Session and Presentation', 'Application only'],
      correctAnswer: 1,
      blueprintArea: 'CISA5',
      topic: 'Network Security',
      difficulty: 'medium',
      explanation: 'Traditional firewalls filter at Network (Layer 3) and Transport (Layer 4) layers; NGFWs also inspect Application.',
    },
    {
      id: 'cisa-d22',
      question: 'Data classification helps organizations:',
      options: ['Reduce storage costs only', 'Apply appropriate security controls based on data sensitivity', 'Comply with a single regulation', 'Automate all data handling'],
      correctAnswer: 1,
      blueprintArea: 'CISA5',
      topic: 'Data Classification',
      difficulty: 'easy',
      explanation: 'Classification enables risk-based protection — more sensitive data receives stronger controls.',
    },
    {
      id: 'cisa-d23',
      question: 'Intrusion detection systems (IDS) are designed to:',
      options: ['Prevent all attacks', 'Detect and alert on suspicious activity', 'Replace firewalls', 'Encrypt network traffic'],
      correctAnswer: 1,
      blueprintArea: 'CISA5',
      topic: 'Security Monitoring',
      difficulty: 'easy',
      explanation: 'IDS monitors and detects suspicious activity, generating alerts for investigation.',
    },
    {
      id: 'cisa-d24',
      question: 'The MOST effective control against phishing attacks is:',
      options: ['Stronger firewalls', 'Security awareness training combined with email filtering', 'More complex passwords', 'Increased network bandwidth'],
      correctAnswer: 1,
      blueprintArea: 'CISA5',
      topic: 'Security Awareness',
      difficulty: 'medium',
      explanation: 'Phishing targets humans; training + technical controls (email filtering) provide the best defense.',
    },
    {
      id: 'cisa-d25',
      question: 'Public key infrastructure (PKI) provides:',
      options: ['Physical security only', 'Authentication, encryption, integrity, and non-repudiation', 'Network monitoring', 'Database optimization'],
      correctAnswer: 1,
      blueprintArea: 'CISA5',
      topic: 'Cryptography',
      difficulty: 'medium',
      explanation: 'PKI enables authentication, encryption, data integrity, and non-repudiation through digital certificates.',
    },
  ],
};

export const CISA_DIAGNOSTIC_QUIZZES: Record<string, DiagnosticQuiz> = {
  CISA: CISA_DIAGNOSTIC,
};
