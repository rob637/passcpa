/**
 * CISA Domain 5: Protection of Information Assets
 * Additional Questions - Batch 9
 * Focus on Security Controls and Compliance
 */

import { Question } from '../../../types';

export const CISA5_QUESTIONS_BATCH9: Question[] = [
  {
    id: 'cisa5-210',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'The MOST effective control against insider threats is:',
    options: [
      'Antivirus software',
      'Strong perimeter firewalls',
      'Annual security training only',
      'Combination of monitoring, access controls, and behavioral analytics',
    ],
    correctAnswer: 3,
    explanation: 'Insider threats require layered controls including access restrictions, activity monitoring, and behavioral analytics to detect anomalies.',
    topic: 'Information Security',
    subtopic: 'Insider Threats'
  },
  {
    id: 'cisa5-211',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Defense in depth strategy means:',
    options: [
      'Relying on user awareness alone',
      'Having one very strong security control',
      'Focusing only on network perimeter',
      'Implementing multiple layers of security controls',
    ],
    correctAnswer: 3,
    explanation: 'Defense in depth uses multiple overlapping security layers so if one control fails, others still provide protection.',
    topic: 'Information Security',
    subtopic: 'Security Architecture'
  },
  {
    id: 'cisa5-212',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Network segmentation PRIMARILY reduces risk by:',
    options: [
      'Increasing network speed',
      'Simplifying management',
      'Reducing hardware costs',
      'Limiting lateral movement and containing breaches',
    ],
    correctAnswer: 3,
    explanation: 'Segmentation limits attacker movement between network zones and contains breaches to smaller areas.',
    topic: 'Network Security',
    subtopic: 'Segmentation'
  },
  {
    id: 'cisa5-213',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Role-based access control (RBAC) assigns permissions based on:',
    options: [
      'Individual user preferences',
      'Department budget',
      'Seniority level only',
      'Job function/role within the organization',
    ],
    correctAnswer: 3,
    explanation: 'RBAC assigns access based on roles aligned to job functions, simplifying administration and enforcing least privilege.',
    topic: 'Access Control',
    subtopic: 'RBAC'
  },
  {
    id: 'cisa5-214',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'When reviewing encryption controls, the auditor should be MOST concerned about:',
    options: [
      'Encryption policy publication',
      'Vendor certifications display',
      'Algorithm choice documentation',
      'Key management practices and procedures',
    ],
    correctAnswer: 3,
    explanation: 'Key management is often the weakest link. Poor key practices can undermine even strong algorithms.',
    topic: 'Cryptography',
    subtopic: 'Key Management'
  },
  {
    id: 'cisa5-215',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Digital certificates are used to:',
    options: [
      'Store private keys securely',
      'Replace passwords completely',
      'Encrypt all network traffic automatically',
      'Bind public keys to identities for verification',
    ],
    correctAnswer: 3,
    explanation: 'Digital certificates link public keys to verified identities, enabling authentication and secure communications.',
    topic: 'Cryptography',
    subtopic: 'PKI'
  },
  {
    id: 'cisa5-216',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Perfect forward secrecy in TLS ensures:',
    options: [
      'All certificates are validated',
      'Connections are never broken',
      'Connections are faster',
      'Compromise of long-term keys cannot decrypt past sessions',
    ],
    correctAnswer: 3,
    explanation: 'Perfect forward secrecy uses ephemeral session keys, so compromising the server\'s private key cannot decrypt recorded past traffic.',
    topic: 'Cryptography',
    subtopic: 'TLS Security'
  },
  {
    id: 'cisa5-217',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    topic: 'Information Security',
    subtopic: 'Security Awareness',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'An IS auditor finds that the organization\'s security awareness program has not been updated in three years. Which risk does this PRIMARILY create?',
    options: [
      'Employees may not recognize current social engineering techniques such as spear phishing and vishing',
      'The organization\'s firewall rules may be outdated',
      'Physical security guards may not be properly trained',
      'The organization\'s backup procedures may fail',
    ],
    correctAnswer: 0,
    explanation: 'An outdated security awareness program leaves employees unaware of evolving threats such as sophisticated phishing campaigns, social engineering tactics, and new attack vectors. Since employees are often the weakest link in security, regular updates to awareness training are critical for maintaining an effective human firewall.',
  },
  {
    id: 'cisa5-218',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Phishing simulation exercises are valuable because they:',
    options: [
      'Punish employees who click',
      'Replace all other training',
      'Guarantee phishing prevention',
      'Identify training needs and measure awareness improvement',
    ],
    correctAnswer: 3,
    explanation: 'Simulations provide metrics on susceptibility and identify individuals/groups needing additional training.',
    topic: 'Information Security',
    subtopic: 'Phishing Defense'
  },
  {
    id: 'cisa5-219',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    topic: 'Network Security',
    subtopic: 'WAF',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An IS auditor evaluating web application security finds that the organization relies solely on a network firewall to protect web applications. Why should the auditor recommend implementing a Web Application Firewall (WAF)?',
    options: [
      'Network firewalls provide identical protection to WAFs',
      'WAFs inspect HTTP/HTTPS application-layer traffic and can block application-specific attacks like SQL injection, XSS, and CSRF that network firewalls cannot detect at Layer 3/4',
      'WAFs are less expensive than network firewalls',
      'WAFs replace the need for secure coding practices',
    ],
    correctAnswer: 1,
    explanation: 'Network firewalls operate at Layers 3-4 (IP/port) and cannot inspect application-layer content. WAFs operate at Layer 7, analyzing HTTP/HTTPS traffic content to detect and block application-specific attacks (SQL injection, XSS, CSRF) based on OWASP rules. Both are needed for defense-in-depth.',
  },
  {
    id: 'cisa5-220',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Endpoint Detection and Response (EDR) differs from traditional antivirus by:',
    options: [
      'Using signature-only detection',
      'Requiring no updates',
      'Being less expensive',
      'Providing continuous monitoring, behavioral analysis, and response capabilities',
    ],
    correctAnswer: 3,
    explanation: 'EDR provides continuous endpoint visibility, behavioral detection beyond signatures, and automated response capabilities.',
    topic: 'Information Security',
    subtopic: 'EDR'
  },
  {
    id: 'cisa5-221',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Data classification should be performed by:',
    options: [
      'IT department only',
      'Security vendor',
      'External auditors',
      'Data owners based on sensitivity and regulatory requirements',
    ],
    correctAnswer: 3,
    explanation: 'Data owners understand the business value and sensitivity of their data and are accountable for classification decisions.',
    topic: 'Data Protection',
    subtopic: 'Data Classification'
  },
  {
    id: 'cisa5-222',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Security event correlation in SIEM helps by:',
    options: [
      'Eliminating false positives',
      'Reducing log storage',
      'Replacing manual investigation',
      'Identifying attack patterns across multiple data sources',
    ],
    correctAnswer: 3,
    explanation: 'Correlation connects related events from different sources to identify attack patterns that individual logs wouldn\'t reveal.',
    topic: 'Security Operations',
    subtopic: 'SIEM'
  },
  {
    id: 'cisa5-223',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    topic: 'Access Control',
    subtopic: 'PAM',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An IS auditor reviewing privileged access management (PAM) controls discovers that privileged session recordings are retained for only 7 days. What is the PRIMARY risk of this short retention period?',
    options: [
      'It violates the principle of least privilege',
      'It may prevent forensic investigation of privileged user activities if incidents are discovered after the retention window',
      'It increases the cost of storage infrastructure',
      'It causes performance degradation in the PAM system',
    ],
    correctAnswer: 1,
    explanation: 'Short retention of privileged session recordings limits the organization\'s ability to investigate security incidents that are discovered after the retention period. Many breaches are not detected for weeks or months, so inadequate log retention prevents forensic analysis of potentially malicious privileged activities.',
  },
  {
    id: 'cisa5-224',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Vulnerability assessment differs from penetration testing in that:',
    options: [
      'Penetration testing is automated only',
      'Vulnerability assessment is more thorough',
      'They are identical',
      'Vulnerability assessment identifies weaknesses; penetration testing actively exploits them',
    ],
    correctAnswer: 3,
    explanation: 'Vulnerability assessment scans for weaknesses; penetration testing actively attempts exploitation to prove real-world risk.',
    topic: 'Information Security',
    subtopic: 'Security Testing'
  },
  {
    id: 'cisa5-225',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Data Loss Prevention (DLP) monitors:',
    options: [
      'Hardware failures',
      'User login times',
      'Network performance only',
      'Data movement to prevent unauthorized exfiltration',
    ],
    correctAnswer: 3,
    explanation: 'DLP inspects data in motion, at rest, and in use to detect and prevent unauthorized data transfers.',
    topic: 'Data Protection',
    subtopic: 'DLP'
  },
  {
    id: 'cisa5-226',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    topic: 'Information Security',
    subtopic: 'Security Metrics',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An IS auditor reviewing security metrics finds that management reports on the number of security incidents per month but not the mean time to detect (MTTD) or respond (MTTR). Why is this metric set insufficient?',
    options: [
      'The number of incidents is not a relevant security metric',
      'Incident count alone does not measure the organization\'s ability to detect and respond quickly — MTTD and MTTR indicate whether the security team can identify and contain threats before significant damage occurs',
      'MTTD and MTTR are only relevant for physical security',
      'Incident count is the only metric that matters for compliance',
    ],
    correctAnswer: 1,
    explanation: 'Incident count measures volume but not capability. An organization experiencing 10 incidents with an average 200-day detection time is far more vulnerable than one with 50 incidents detected in 2 hours. MTTD and MTTR measure the security team\'s effectiveness and the organization\'s actual risk exposure.',
  },
  {
    id: 'cisa5-227',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Biometric authentication provides:',
    options: [
      'Something you have',
      'Something you know',
      'Somewhere you are',
      'Something you are',
    ],
    correctAnswer: 3,
    explanation: 'Biometrics (fingerprint, face, iris) represent "something you are" - inherent physical characteristics.',
    topic: 'Access Control',
    subtopic: 'Biometrics'
  },
  {
    id: 'cisa5-228',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Supply chain security for software should include:',
    options: [
      'Only using well-known vendors',
      'Monthly vendor reviews only',
      'Avoiding all third-party code',
      'SBOM, code signing, and dependency vulnerability management',
    ],
    correctAnswer: 3,
    explanation: 'Modern supply chain security requires software bill of materials, code signing verification, and active dependency management.',
    topic: 'Information Security',
    subtopic: 'Supply Chain Security'
  },
  {
    id: 'cisa5-229',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Privacy by Design means:',
    options: [
      'Adding privacy settings after development',
      'External privacy audits',
      'Creating privacy policies only',
      'Embedding privacy throughout the system development lifecycle',
    ],
    correctAnswer: 3,
    explanation: 'Privacy by Design embeds privacy considerations into system design from inception rather than adding privacy controls afterward.',
    topic: 'Privacy',
    subtopic: 'Privacy by Design'
  },
  {
    id: 'cisa5-230',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'GDPR data breach notification requires:',
    options: [
      'No notification if data was encrypted',
      'Annual notification only',
      'Public announcement within 30 days',
      'Notification to supervisory authority within 72 hours of awareness',
    ],
    correctAnswer: 3,
    explanation: 'GDPR requires breach notification to the supervisory authority within 72 hours unless the breach is unlikely to result in risk.',
    topic: 'Privacy',
    subtopic: 'GDPR'
  },
  {
    id: 'cisa5-231',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    topic: 'Information Security',
    subtopic: 'Secure Coding',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An organization\'s code review process identifies that developers frequently use string concatenation to build SQL queries. What secure coding practice should the IS auditor recommend?',
    options: [
      'Adding comments to the SQL queries for documentation',
      'Replacing string concatenation with parameterized queries (prepared statements) to prevent SQL injection',
      'Increasing the complexity of database passwords',
      'Moving the database to a different server',
    ],
    correctAnswer: 1,
    explanation: 'Parameterized queries (prepared statements) separate SQL code from user-supplied data, preventing SQL injection attacks. String concatenation allows user input to be interpreted as SQL commands. This is a OWASP-recommended secure coding practice for all database interactions.',
  },
  {
    id: 'cisa5-232',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Security architecture review should occur:',
    options: [
      'During annual audits only',
      'Never for agile projects',
      'Only after implementation',
      'During design phase before significant development investment',
    ],
    correctAnswer: 3,
    explanation: 'Architecture review during design is most cost-effective - fixing security issues later is exponentially more expensive.',
    topic: 'Information Security',
    subtopic: 'Security Architecture'
  },
  {
    id: 'cisa5-233',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    topic: 'Network Security',
    subtopic: 'NAC',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'An IS auditor discovers that the organization\'s NAC solution only checks whether devices have valid certificates but does not assess security posture (patch level, antivirus status). What risk does this limited implementation create?',
    options: [
      'Unauthorized devices will bypass all network controls',
      'Authenticated but compromised or unpatched devices can connect to the network and spread malware or be exploited as attack vectors',
      'The NAC solution will consume excessive network bandwidth',
      'Certificate management will become unnecessarily complex',
    ],
    correctAnswer: 1,
    explanation: 'NAC that only validates device identity without assessing security posture allows authenticated devices with missing patches, disabled antivirus, or active malware infections to access the network. Comprehensive NAC should evaluate device health and enforce compliance with security policies before granting full network access.',
  },
  {
    id: 'cisa5-234',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Threat hunting is:',
    options: [
      'Reactive incident response',
      'Annual penetration testing',
      'Automated malware scanning',
      'Proactive search for threats that evade existing controls',
    ],
    correctAnswer: 3,
    explanation: 'Threat hunting proactively searches for indicators of compromise that automated tools may miss.',
    topic: 'Security Operations',
    subtopic: 'Threat Hunting'
  },
  {
    id: 'cisa5-235',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Security exception management should include:',
    options: [
      'Permanent exceptions by default',
      'Automatic approval',
      'No documentation',
      'Risk assessment, approval authority, expiration, and compensating controls',
    ],
    correctAnswer: 3,
    explanation: 'Exceptions require documented risk assessment, appropriate approval, defined expiration, and compensating controls.',
    topic: 'Information Security',
    subtopic: 'Exception Management'
  },
  {
    id: 'cisa5-236',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Third-party security assessments should be based on:',
    options: [
      'Vendor reputation only',
      'Contract value alone',
      'Geographic location',
      'Risk level of the relationship and data involved',
    ],
    correctAnswer: 3,
    explanation: 'Assessment rigor should be proportionate to the risk - higher risk third parties require more thorough assessment.',
    topic: 'Information Security',
    subtopic: 'Third-Party Risk'
  },
  {
    id: 'cisa5-237',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Secure configuration management includes:',
    options: [
      'Default vendor configurations',
      'Ad hoc changes',
      'No documentation needed',
      'Hardening baselines, change control, and compliance monitoring',
    ],
    correctAnswer: 3,
    explanation: 'Secure configuration includes defined hardening baselines, controlled changes, and ongoing compliance verification.',
    topic: 'Information Security',
    subtopic: 'Configuration Management'
  },
  {
    id: 'cisa5-238',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    topic: 'Information Security',
    subtopic: 'Red Team',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'How do red team exercises differ from standard penetration testing in scope and methodology?',
    options: [
      'Red team exercises only test network perimeter defenses',
      'Red team exercises simulate realistic advanced adversary behavior across all attack surfaces — including social engineering, physical intrusion, and technical exploitation — to test the organization\'s detection and response capabilities',
      'Red team exercises are automated scans performed monthly',
      'Red team exercises are less comprehensive than penetration tests',
    ],
    correctAnswer: 1,
    explanation: 'Red team exercises go beyond standard penetration testing by emulating realistic advanced persistent threat (APT) tactics, techniques, and procedures (TTPs) across multiple attack vectors including technical, social engineering, and physical. The primary goal is testing the organization\'s detection, response, and resilience capabilities.',
  },
  {
    id: 'cisa5-239',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Tokenization differs from encryption in that:',
    options: [
      'Tokenization works only for text',
      'They are identical',
      'Encryption is not secure',
      'Tokenization replaces data with non-reversible substitutes maintained in a secure vault',
    ],
    correctAnswer: 3,
    explanation: 'Tokenization substitutes sensitive data with tokens that have no mathematical relationship to the original data.',
    topic: 'Data Protection',
    subtopic: 'Tokenization'
  },
  {
    id: 'cisa5-240',
    courseId: 'cisa',
    section: 'CISA5',
    blueprintArea: 'CISA5-1',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Security Operations Center (SOC) maturity can be measured by:',
    options: [
      'Building size only',
      'Staff headcount alone',
      'Number of monitors displayed',
      'Detection capabilities, mean time to respond, and threat coverage',
    ],
    correctAnswer: 3,
    explanation: 'SOC maturity is measured by operational metrics: detection rates, response times, and coverage of threat landscape.',
    topic: 'Security Operations',
    subtopic: 'SOC Maturity'
  }
];
