/**
 * CMA Part 1: Financial Planning, Performance, and Analytics - Flashcard Formulas
 * Key calculations and formulas for CMA Part 1
 */

import { CMAFlashcard } from './types';

export const CMA1_FORMULAS: CMAFlashcard[] = [
  // ============================================
  // A: External Financial Reporting Decisions
  // ============================================
  {
    id: 'cma1-form-001',
    section: 'CMA1',
    type: 'formula',
    topic: 'External Reporting',
    subtopic: 'Depreciation',
    blueprintArea: 'CMA1-A',
    front: 'How do you calculate Straight-Line Depreciation?',
    back: '**Straight-Line Depreciation:**\n\nAnnual Depreciation = (Cost - Salvage Value) / Useful Life\n\n**Book Value at any point:**\nBook Value = Cost - Accumulated Depreciation',
    formula: 'Depreciation = (Cost - Salvage) / Useful Life',
    example: 'Asset cost $50,000, salvage $5,000, 5-year life\nAnnual depreciation = ($50,000 - $5,000) / 5 = $9,000/year',
    difficulty: 'easy',
    tags: ['depreciation', 'fixed assets'],
    reference: 'ASC 360',
  },
  {
    id: 'cma1-form-002',
    section: 'CMA1',
    type: 'formula',
    topic: 'External Reporting',
    subtopic: 'DDB Depreciation',
    blueprintArea: 'CMA1-A',
    front: 'How do you calculate Double-Declining Balance Depreciation?',
    back: '**Double-Declining Balance:**\n\n1) Calculate DDB Rate = (1 / Useful Life) × 2\n\n2) Annual Depreciation = Book Value × DDB Rate\n\n**Note:** Ignore salvage value initially, but never depreciate below salvage value.',
    formula: 'Depreciation = Book Value × (2 / Useful Life)',
    example: '$100,000 asset, 5-year life, DDB rate = 40%\nYear 1: $100,000 × 0.40 = $40,000\nYear 2: $60,000 × 0.40 = $24,000',
    difficulty: 'medium',
    tags: ['depreciation', 'DDB'],
  },
  {
    id: 'cma1-form-003',
    section: 'CMA1',
    type: 'formula',
    topic: 'External Reporting',
    subtopic: 'Inventory',
    blueprintArea: 'CMA1-A',
    front: 'How do you calculate inventory using FIFO, LIFO, and Weighted Average?',
    back: '**FIFO (First-In, First-Out):**\nEnding Inventory = Most recent costs\nCOGS = Oldest costs\n\n**LIFO (Last-In, First-Out):**\nEnding Inventory = Oldest costs\nCOGS = Most recent costs\n\n**Weighted Average:**\nWeighted Avg Cost = Total Cost of Goods Available / Total Units Available',
    formula: 'WAC = Total Cost Available / Total Units Available',
    difficulty: 'medium',
    tags: ['inventory', 'FIFO', 'LIFO'],
  },

  // ============================================
  // B: Planning, Budgeting, and Forecasting
  // ============================================
  {
    id: 'cma1-form-004',
    section: 'CMA1',
    type: 'formula',
    topic: 'Budgeting',
    subtopic: 'Production Budget',
    blueprintArea: 'CMA1-B',
    front: 'How do you calculate the Production Budget?',
    back: '**Production Budget Formula:**\n\n  Budgeted Sales (units)\n+ Desired Ending Inventory\n- Beginning Inventory\n= **Required Production**\n\n**Key:** Must ensure enough inventory to meet sales plus desired ending inventory.',
    formula: 'Production = Sales + Ending Inv - Beginning Inv',
    example: 'Sales: 10,000 units, Ending Inv: 2,000, Beginning Inv: 1,500\nProduction = 10,000 + 2,000 - 1,500 = 10,500 units',
    difficulty: 'easy',
    tags: ['production budget', 'planning'],
  },
  {
    id: 'cma1-form-005',
    section: 'CMA1',
    type: 'formula',
    topic: 'Budgeting',
    subtopic: 'Direct Materials Budget',
    blueprintArea: 'CMA1-B',
    front: 'How do you calculate the Direct Materials Purchases Budget?',
    back: '**Direct Materials Purchases:**\n\n  Materials needed for production\n+ Desired Ending Materials Inventory\n- Beginning Materials Inventory\n= **Materials to be Purchased**\n× Cost per unit\n= **Total Purchases Cost**',
    formula: 'Purchases = Needed + Ending DM - Beginning DM',
    example: 'Need 21,000 lbs, Ending DM: 4,000 lbs, Beginning DM: 3,000 lbs\nPurchases = 21,000 + 4,000 - 3,000 = 22,000 lbs',
    difficulty: 'medium',
    tags: ['materials budget', 'planning'],
  },
  {
    id: 'cma1-form-006',
    section: 'CMA1',
    type: 'formula',
    topic: 'Budgeting',
    subtopic: 'Cash Collections',
    blueprintArea: 'CMA1-B',
    front: 'How do you calculate Cash Collections for the Cash Budget?',
    back: '**Cash Collections Formula:**\n\nCollections = \n(% collected in month of sale × Current month sales) +\n(% collected in following month × Prior month sales) +\n(Prior period A/R collections)\n\n**Note:** Account for bad debts percentage',
    formula: 'Collections = Σ(Sales × Collection %)',
    example: 'Terms: 60% current month, 35% next month, 5% bad debts\nNov sales $100K, Dec sales $120K\nDec collections = (0.60 × $120K) + (0.35 × $100K) = $107K',
    difficulty: 'medium',
    tags: ['cash budget', 'collections'],
  },

  // ============================================
  // C: Performance Management
  // ============================================
  {
    id: 'cma1-form-007',
    section: 'CMA1',
    type: 'formula',
    topic: 'Performance Management',
    subtopic: 'ROI',
    blueprintArea: 'CMA1-C',
    front: 'How do you calculate Return on Investment (ROI)?',
    back: '**Return on Investment:**\n\nROI = Operating Income / Average Invested Capital\n\n**DuPont Formula:**\nROI = Profit Margin × Asset Turnover\n\nWhere:\n• Profit Margin = Operating Income / Sales\n• Asset Turnover = Sales / Average Invested Capital',
    formula: 'ROI = Operating Income / Invested Capital\nROI = (OI/Sales) × (Sales/Assets)',
    example: 'Operating Income: $500K, Invested Capital: $2M\nROI = $500K / $2M = 25%',
    difficulty: 'medium',
    tags: ['ROI', 'performance measurement'],
  },
  {
    id: 'cma1-form-008',
    section: 'CMA1',
    type: 'formula',
    topic: 'Performance Management',
    subtopic: 'Residual Income',
    blueprintArea: 'CMA1-C',
    front: 'How do you calculate Residual Income (RI)?',
    back: '**Residual Income:**\n\nRI = Operating Income - (Required Rate of Return × Invested Capital)\n\n**Interpretation:**\n• Positive RI = Created value above required return\n• Negative RI = Destroyed value\n\n**Advantage over ROI:** Encourages accepting all projects earning above required return',
    formula: 'RI = Operating Income - (Required Rate × Capital)',
    example: 'Operating Income: $500K, Required Rate: 12%, Capital: $2M\nRI = $500K - (0.12 × $2M) = $500K - $240K = $260K',
    difficulty: 'medium',
    tags: ['residual income', 'performance'],
  },
  {
    id: 'cma1-form-009',
    section: 'CMA1',
    type: 'formula',
    topic: 'Performance Management',
    subtopic: 'EVA',
    blueprintArea: 'CMA1-C',
    front: 'How do you calculate Economic Value Added (EVA)?',
    back: '**Economic Value Added:**\n\nEVA = NOPAT - (WACC × Total Capital)\n\nWhere:\n• NOPAT = Net Operating Profit After Tax\n• WACC = Weighted Average Cost of Capital\n\n**Adjustments to GAAP:**\n• Capitalize R&D, marketing\n• Use economic depreciation\n• Convert LIFO to FIFO',
    formula: 'EVA = NOPAT - (WACC × Capital)',
    example: 'NOPAT: $3M, WACC: 10%, Capital: $20M\nEVA = $3M - (0.10 × $20M) = $1M',
    difficulty: 'hard',
    tags: ['EVA', 'value creation'],
  },

  // ============================================
  // D: Cost Management
  // ============================================
  {
    id: 'cma1-form-010',
    section: 'CMA1',
    type: 'formula',
    topic: 'Cost Management',
    subtopic: 'High-Low Method',
    blueprintArea: 'CMA1-D',
    front: 'How do you use the High-Low Method to separate mixed costs?',
    back: '**High-Low Method:**\n\n**Step 1:** Variable Cost per Unit\n= (Highest Cost - Lowest Cost) / (Highest Activity - Lowest Activity)\n\n**Step 2:** Fixed Cost\n= Total Cost at any point - (Variable Rate × Activity)\n\n**Formula:** Y = Fixed + (Variable × X)',
    formula: 'Variable Rate = ΔCost / ΔActivity\nFixed = Total Cost - (Variable × Activity)',
    example: 'High: 10,000 units, $45,000\nLow: 6,000 units, $33,000\nVariable = ($45K-$33K)/(10K-6K) = $3/unit\nFixed = $45K - ($3×10K) = $15,000',
    difficulty: 'medium',
    tags: ['high-low', 'cost estimation'],
  },
  {
    id: 'cma1-form-011',
    section: 'CMA1',
    type: 'formula',
    topic: 'Cost Management',
    subtopic: 'Standard Cost Variances',
    blueprintArea: 'CMA1-D',
    front: 'What are the formulas for Direct Materials Variances?',
    back: '**Materials Price Variance (MPV):**\n= (Actual Price - Standard Price) × Actual Qty Purchased\n\n**Materials Quantity Variance (MQV):**\n= (Actual Qty Used - Standard Qty Allowed) × Standard Price\n\n**Standard Qty Allowed** = Standard per unit × Actual units produced\n\n**Favorable:** Actual < Standard\n**Unfavorable:** Actual > Standard',
    formula: 'MPV = (AP - SP) × AQ\nMQV = (AQ - SQ) × SP',
    difficulty: 'medium',
    tags: ['variances', 'materials'],
  },
  {
    id: 'cma1-form-012',
    section: 'CMA1',
    type: 'formula',
    topic: 'Cost Management',
    subtopic: 'Standard Cost Variances',
    blueprintArea: 'CMA1-D',
    front: 'What are the formulas for Direct Labor Variances?',
    back: '**Labor Rate Variance (LRV):**\n= (Actual Rate - Standard Rate) × Actual Hours\n\n**Labor Efficiency Variance (LEV):**\n= (Actual Hours - Standard Hours Allowed) × Standard Rate\n\n**Standard Hours Allowed** = Standard hours per unit × Actual units produced\n\n**Remember:** Rate variance uses ACTUAL hours\nEfficiency variance uses STANDARD rate',
    formula: 'LRV = (AR - SR) × AH\nLEV = (AH - SH) × SR',
    difficulty: 'medium',
    tags: ['variances', 'labor'],
  },
  {
    id: 'cma1-form-013',
    section: 'CMA1',
    type: 'formula',
    topic: 'Cost Management',
    subtopic: 'Overhead Variances',
    blueprintArea: 'CMA1-D',
    front: 'What are the formulas for Variable Overhead Variances?',
    back: '**Variable OH Spending Variance:**\n= (Actual VOH Rate - Standard VOH Rate) × Actual Hours\n\n**Variable OH Efficiency Variance:**\n= (Actual Hours - Standard Hours Allowed) × Standard VOH Rate\n\n**Alternative (Total):**\nTotal VOH Variance = Actual VOH - Applied VOH\n= Actual VOH - (Standard Rate × Standard Hours Allowed)',
    formula: 'VOH Spending = (AVR - SVR) × AH\nVOH Efficiency = (AH - SH) × SVR',
    difficulty: 'hard',
    tags: ['variances', 'overhead'],
  },
  {
    id: 'cma1-form-014',
    section: 'CMA1',
    type: 'formula',
    topic: 'Cost Management',
    subtopic: 'Overhead Variances',
    blueprintArea: 'CMA1-D',
    front: 'What are the formulas for Fixed Overhead Variances?',
    back: '**Fixed OH Budget (Spending) Variance:**\n= Actual Fixed OH - Budgeted Fixed OH\n\n**Fixed OH Volume Variance:**\n= Budgeted Fixed OH - Applied Fixed OH\n= (Budgeted Hours - Standard Hours Allowed) × FOH Rate\n\n**Interpretation:**\n• Volume variance: Due to capacity utilization\n• Spending variance: Due to cost control',
    formula: 'FOH Budget Var = Actual FOH - Budgeted FOH\nFOH Volume Var = Budgeted FOH - Applied FOH',
    difficulty: 'hard',
    tags: ['variances', 'fixed overhead'],
  },
  {
    id: 'cma1-form-015',
    section: 'CMA1',
    type: 'formula',
    topic: 'Cost Management',
    subtopic: 'Job Order Costing',
    blueprintArea: 'CMA1-D',
    front: 'How do you calculate the Predetermined Overhead Rate (POHR)?',
    back: '**Predetermined Overhead Rate:**\n\nPOHR = Estimated Total Manufacturing Overhead / Estimated Total Allocation Base\n\n**Common Allocation Bases:**\n• Direct labor hours\n• Direct labor cost\n• Machine hours\n• Direct materials cost\n\n**Applied OH** = POHR × Actual allocation base used',
    formula: 'POHR = Estimated MOH / Estimated Base',
    example: 'Estimated OH: $600,000, Estimated DL Hours: 50,000\nPOHR = $600K / 50K = $12 per DL hour',
    difficulty: 'easy',
    tags: ['POHR', 'overhead allocation'],
  },

  // ============================================
  // F: Technology and Analytics
  // ============================================
  {
    id: 'cma1-form-016',
    section: 'CMA1',
    type: 'formula',
    topic: 'Analytics',
    subtopic: 'Learning Curve',
    blueprintArea: 'CMA1-F',
    front: 'What is the Learning Curve formula?',
    back: '**Learning Curve:**\n\nY = aXᵇ\n\nWhere:\n• Y = Cumulative average time per unit\n• a = Time for first unit\n• X = Cumulative number of units\n• b = Learning coefficient = ln(learning rate) / ln(2)\n\n**80% Learning Curve:** Each doubling of quantity reduces cumulative average time to 80% of previous',
    formula: 'Y = aXᵇ where b = ln(learning rate)/ln(2)',
    example: '80% learning curve, first unit = 100 hours\nUnit 1: 100 hrs\nUnit 2: 80 hrs (cumulative avg)\nUnit 4: 64 hrs (cumulative avg)',
    difficulty: 'hard',
    tags: ['learning curve', 'productivity'],
  },
  {
    id: 'cma1-form-017',
    section: 'CMA1',
    type: 'formula',
    topic: 'Analytics',
    subtopic: 'Correlation',
    blueprintArea: 'CMA1-F',
    front: 'What is the Coefficient of Determination (R²) and what does it tell us?',
    back: '**R² (Coefficient of Determination):**\n\nR² = Explained Variation / Total Variation\n\n**Interpretation:**\n• R² = 0.85 means 85% of the variation in the dependent variable is explained by the independent variable(s)\n\n**Range:** 0 to 1\n• Closer to 1 = Better fit\n• Closer to 0 = Poor fit\n\n**In regression:** Measures how well the line fits the data',
    formula: 'R² = SSR/SST = 1 - (SSE/SST)',
    difficulty: 'medium',
    tags: ['regression', 'statistics', 'R-squared'],
  },
  {
    id: 'cma1-form-018',
    section: 'CMA1',
    type: 'formula',
    topic: 'Cost Management',
    subtopic: 'Equivalent Units',
    blueprintArea: 'CMA1-D',
    front: 'How do you calculate Equivalent Units of Production?',
    back: '**Weighted Average Method:**\nEU = Units completed + (Ending WIP × % complete)\n\n**FIFO Method:**\nEU = \n(Beginning WIP × % to complete) +\nUnits started and completed +\n(Ending WIP × % complete)\n\n**Note:** Calculate separately for materials and conversion costs if added at different rates',
    formula: 'EU (WA) = Complete + (End WIP × %)\nEU (FIFO) = (Beg WIP × % left) + Started&Completed + (End WIP × %)',
    example: 'Completed: 10,000, Ending WIP: 2,000 at 50%\nEU = 10,000 + (2,000 × 50%) = 11,000',
    difficulty: 'hard',
    tags: ['process costing', 'equivalent units'],
  },
];
