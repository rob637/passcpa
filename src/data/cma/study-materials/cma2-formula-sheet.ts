/**
 * CMA Part 2: Strategic Financial Management
 * COMPREHENSIVE FORMULA SHEET
 * 
 * Organized by Blueprint Area for exam-day reference
 * All formulas verified against IMA Content Specification Outlines
 */

import { FormulaCategory } from './cma1-formula-sheet';

export const CMA2_FORMULA_SHEET: FormulaCategory[] = [
  // ==========================================
  // CMA2-A: FINANCIAL STATEMENT ANALYSIS (20%)
  // ==========================================
  {
    id: 'cma2a-formulas',
    name: 'Financial Statement Analysis',
    blueprintArea: 'CMA2-A',
    weight: '20%',
    formulas: [
      // LIQUIDITY RATIOS
      {
        id: 'cma2a-001',
        name: 'Current Ratio',
        formula: 'Current Ratio = Current Assets / Current Liabilities',
        variables: [],
        example: '$450,000 / $180,000 = 2.5',
        tips: ['Measures short-term liquidity', 'Above 1.0 generally acceptable'],
        category: 'Liquidity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-002',
        name: 'Quick Ratio (Acid Test)',
        formula: 'Quick Ratio = (Current Assets − Inventory − Prepaids) / Current Liabilities',
        variables: [],
        example: '($300,000 − $120,000) / $150,000 = 1.2',
        tips: ['Excludes illiquid current assets', 'More conservative than current ratio'],
        category: 'Liquidity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-003',
        name: 'Cash Ratio',
        formula: 'Cash Ratio = (Cash + Marketable Securities) / Current Liabilities',
        variables: [],
        tips: ['Most conservative liquidity measure', 'Rarely used in practice'],
        category: 'Liquidity Ratios',
        blueprintArea: 'CMA2-A',
      },
      // ACTIVITY RATIOS
      {
        id: 'cma2a-004',
        name: 'Inventory Turnover',
        formula: 'Inventory Turnover = Cost of Goods Sold / Average Inventory',
        variables: [
          { symbol: 'Avg Inventory', meaning: '(Beginning + Ending) / 2' },
        ],
        example: '$600,000 / $100,000 = 6 times',
        category: 'Activity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-005',
        name: 'Days Inventory Outstanding (DIO)',
        formula: 'DIO = 365 / Inventory Turnover',
        variables: [],
        example: '365 / 6 = 60.8 days',
        tips: ['Also called Days Sales in Inventory'],
        category: 'Activity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-006',
        name: 'Receivables Turnover',
        formula: 'Receivables Turnover = Net Credit Sales / Average Accounts Receivable',
        variables: [],
        example: '$900,000 / $75,000 = 12 times',
        category: 'Activity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-007',
        name: 'Days Sales Outstanding (DSO)',
        formula: 'DSO = 365 / Receivables Turnover',
        variables: [],
        example: '365 / 12 = 30.4 days',
        tips: ['Also called Average Collection Period', 'Compare to credit terms'],
        category: 'Activity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-008',
        name: 'Payables Turnover',
        formula: 'Payables Turnover = Purchases (or COGS) / Average Accounts Payable',
        variables: [],
        category: 'Activity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-009',
        name: 'Days Payables Outstanding (DPO)',
        formula: 'DPO = 365 / Payables Turnover',
        variables: [],
        tips: ['Longer DPO = using supplier financing longer'],
        category: 'Activity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-010',
        name: 'Cash Conversion Cycle',
        formula: 'CCC = DIO + DSO − DPO',
        variables: [
          { symbol: 'DIO', meaning: 'Days Inventory Outstanding' },
          { symbol: 'DSO', meaning: 'Days Sales Outstanding' },
          { symbol: 'DPO', meaning: 'Days Payables Outstanding' },
        ],
        example: '45 + 30 − 35 = 40 days',
        tips: ['Lower CCC = more efficient working capital', 'Negative CCC is possible (Amazon)'],
        category: 'Activity Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-011',
        name: 'Asset Turnover',
        formula: 'Asset Turnover = Net Sales / Average Total Assets',
        variables: [],
        example: '$2,000,000 / $1,000,000 = 2.0 times',
        tips: ['Measures asset efficiency', 'Component of DuPont analysis'],
        category: 'Activity Ratios',
        blueprintArea: 'CMA2-A',
      },
      // SOLVENCY RATIOS
      {
        id: 'cma2a-012',
        name: 'Debt-to-Equity Ratio',
        formula: 'D/E = Total Liabilities / Total Stockholders\' Equity',
        variables: [],
        example: '$800,000 / $400,000 = 2.0',
        category: 'Solvency Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-013',
        name: 'Debt Ratio',
        formula: 'Debt Ratio = Total Liabilities / Total Assets',
        variables: [],
        example: '$800,000 / $1,200,000 = 66.7%',
        category: 'Solvency Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-014',
        name: 'Times Interest Earned',
        formula: 'TIE = EBIT / Interest Expense',
        variables: [
          { symbol: 'EBIT', meaning: 'Earnings Before Interest and Taxes' },
        ],
        example: '$500,000 / $100,000 = 5.0 times',
        tips: ['Higher = better debt coverage', 'Also called Interest Coverage Ratio'],
        category: 'Solvency Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-015',
        name: 'Fixed Charge Coverage',
        formula: 'FCC = (EBIT + Lease Payments) / (Interest + Lease Payments)',
        variables: [],
        tips: ['More comprehensive than TIE', 'Includes lease obligations'],
        category: 'Solvency Ratios',
        blueprintArea: 'CMA2-A',
      },
      // PROFITABILITY RATIOS
      {
        id: 'cma2a-016',
        name: 'Gross Profit Margin',
        formula: 'Gross Margin = (Sales − COGS) / Sales',
        variables: [],
        example: '($1,000,000 − $650,000) / $1,000,000 = 35%',
        category: 'Profitability Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-017',
        name: 'Operating Profit Margin',
        formula: 'Operating Margin = Operating Income / Sales',
        variables: [],
        example: '$150,000 / $1,000,000 = 15%',
        category: 'Profitability Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-018',
        name: 'Net Profit Margin',
        formula: 'Net Margin = Net Income / Sales',
        variables: [],
        example: '$100,000 / $1,000,000 = 10%',
        category: 'Profitability Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-019',
        name: 'Return on Assets (ROA)',
        formula: 'ROA = Net Income / Average Total Assets',
        variables: [],
        example: '$150,000 / $1,500,000 = 10%',
        category: 'Profitability Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-020',
        name: 'Return on Equity (ROE)',
        formula: 'ROE = Net Income / Average Stockholders\' Equity',
        variables: [],
        example: '$200,000 / $1,000,000 = 20%',
        category: 'Profitability Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-021',
        name: 'DuPont Analysis (3-Factor)',
        formula: 'ROE = Net Profit Margin × Asset Turnover × Equity Multiplier',
        variables: [
          { symbol: 'Net Margin', meaning: 'NI / Sales' },
          { symbol: 'Asset Turnover', meaning: 'Sales / Assets' },
          { symbol: 'Equity Multiplier', meaning: 'Assets / Equity' },
        ],
        example: '10% × 1.5 × 2.0 = 30%',
        tips: ['Decomposes ROE into profitability, efficiency, leverage'],
        category: 'Profitability Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-022',
        name: 'DuPont Analysis (5-Factor)',
        formula: 'ROE = (NI/EBT) × (EBT/EBIT) × (EBIT/Sales) × (Sales/Assets) × (Assets/Equity)',
        variables: [
          { symbol: 'NI/EBT', meaning: 'Tax Burden' },
          { symbol: 'EBT/EBIT', meaning: 'Interest Burden' },
          { symbol: 'EBIT/Sales', meaning: 'Operating Margin' },
        ],
        tips: ['Separates tax and interest effects', 'More detailed analysis'],
        category: 'Profitability Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-023',
        name: 'Sustainable Growth Rate',
        formula: 'g = ROE × Retention Ratio = ROE × (1 − Dividend Payout Ratio)',
        variables: [
          { symbol: 'Retention Ratio', meaning: 'Portion of earnings retained' },
        ],
        example: '15% ROE × 60% retention = 9% sustainable growth',
        tips: ['Max growth without changing capital structure or issuing equity'],
        category: 'Growth Analysis',
        blueprintArea: 'CMA2-A',
      },
      // MARKET RATIOS
      {
        id: 'cma2a-024',
        name: 'Earnings Per Share',
        formula: 'EPS = (Net Income − Preferred Dividends) / Weighted Avg Common Shares',
        variables: [],
        category: 'Market Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-025',
        name: 'Price-to-Earnings Ratio',
        formula: 'P/E = Market Price per Share / EPS',
        variables: [],
        example: '$60 / $4.00 = 15x',
        tips: ['Higher P/E = higher growth expectations', 'Compare to industry average'],
        category: 'Market Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-026',
        name: 'Price-to-Book Ratio',
        formula: 'P/B = Market Price per Share / Book Value per Share',
        variables: [
          { symbol: 'BVPS', meaning: 'Total Equity / Shares Outstanding' },
        ],
        tips: ['P/B > 1 suggests market value exceeds book value'],
        category: 'Market Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-027',
        name: 'Dividend Yield',
        formula: 'Dividend Yield = Annual Dividend per Share / Market Price per Share',
        variables: [],
        example: '$2.00 / $50 = 4%',
        category: 'Market Ratios',
        blueprintArea: 'CMA2-A',
      },
      {
        id: 'cma2a-028',
        name: 'Dividend Payout Ratio',
        formula: 'Payout Ratio = Dividends per Share / EPS',
        variables: [],
        example: '$2.00 / $5.00 = 40%',
        tips: ['Retention = 1 − Payout'],
        category: 'Market Ratios',
        blueprintArea: 'CMA2-A',
      },
    ],
  },

  // ==========================================
  // CMA2-B: CORPORATE FINANCE (20%)
  // ==========================================
  {
    id: 'cma2b-formulas',
    name: 'Corporate Finance',
    blueprintArea: 'CMA2-B',
    weight: '20%',
    formulas: [
      // TIME VALUE OF MONEY
      {
        id: 'cma2b-001',
        name: 'Future Value (Single Sum)',
        formula: 'FV = PV × (1 + r)ⁿ',
        variables: [
          { symbol: 'PV', meaning: 'Present value' },
          { symbol: 'r', meaning: 'Interest rate per period' },
          { symbol: 'n', meaning: 'Number of periods' },
        ],
        example: '$10,000 × (1.08)⁵ = $14,693',
        category: 'Time Value of Money',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-002',
        name: 'Present Value (Single Sum)',
        formula: 'PV = FV / (1 + r)ⁿ = FV × (1 + r)⁻ⁿ',
        variables: [],
        example: '$10,000 / (1.10)³ = $7,513',
        category: 'Time Value of Money',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-003',
        name: 'Present Value of Annuity',
        formula: 'PVA = PMT × [(1 − (1 + r)⁻ⁿ) / r]',
        variables: [
          { symbol: 'PMT', meaning: 'Payment per period' },
        ],
        example: '$1,000 × PVIFA(10%, 5) = $1,000 × 3.791 = $3,791',
        tips: ['PVIFA = PV Interest Factor for Annuity'],
        category: 'Time Value of Money',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-004',
        name: 'Future Value of Annuity',
        formula: 'FVA = PMT × [((1 + r)ⁿ − 1) / r]',
        variables: [],
        category: 'Time Value of Money',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-005',
        name: 'Present Value of Perpetuity',
        formula: 'PV = PMT / r',
        variables: [],
        example: '$100 annual payment / 8% = $1,250',
        tips: ['Infinite stream of equal payments'],
        category: 'Time Value of Money',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-006',
        name: 'Growing Perpetuity',
        formula: 'PV = D₁ / (r − g)',
        variables: [
          { symbol: 'D₁', meaning: 'Dividend/payment next period' },
          { symbol: 'g', meaning: 'Growth rate (must be < r)' },
        ],
        example: '$3.00 / (10% − 4%) = $50',
        tips: ['Gordon Growth Model for stock valuation'],
        category: 'Time Value of Money',
        blueprintArea: 'CMA2-B',
      },
      // COST OF CAPITAL
      {
        id: 'cma2b-007',
        name: 'After-Tax Cost of Debt',
        formula: 'Kd(AT) = Kd × (1 − Tax Rate)',
        variables: [
          { symbol: 'Kd', meaning: 'Before-tax cost of debt' },
        ],
        example: '8% × (1 − 0.25) = 6%',
        tips: ['Interest is tax-deductible'],
        category: 'Cost of Capital',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-008',
        name: 'Cost of Preferred Stock',
        formula: 'Kp = Dp / P₀',
        variables: [
          { symbol: 'Dp', meaning: 'Annual preferred dividend' },
          { symbol: 'P₀', meaning: 'Current price of preferred' },
        ],
        example: '$7 / $95 = 7.37%',
        tips: ['No tax benefit for preferred dividends'],
        category: 'Cost of Capital',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-009',
        name: 'Cost of Equity - CAPM',
        formula: 'Ke = Rf + β(Rm − Rf)',
        variables: [
          { symbol: 'Rf', meaning: 'Risk-free rate' },
          { symbol: 'β', meaning: 'Beta (systematic risk)' },
          { symbol: 'Rm', meaning: 'Expected market return' },
          { symbol: 'Rm−Rf', meaning: 'Market risk premium' },
        ],
        example: '3% + 1.3(11% − 3%) = 3% + 10.4% = 13.4%',
        tips: ['Most common approach on exam'],
        category: 'Cost of Capital',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-010',
        name: 'Cost of Equity - Dividend Growth Model',
        formula: 'Ke = (D₁ / P₀) + g',
        variables: [
          { symbol: 'D₁', meaning: 'Next year\'s dividend = D₀(1+g)' },
          { symbol: 'P₀', meaning: 'Current stock price' },
          { symbol: 'g', meaning: 'Constant growth rate' },
        ],
        example: '$2.10 / $40 + 5% = 5.25% + 5% = 10.25%',
        category: 'Cost of Capital',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-011',
        name: 'Weighted Average Cost of Capital',
        formula: 'WACC = (E/V × Ke) + (D/V × Kd × (1−T)) + (P/V × Kp)',
        variables: [
          { symbol: 'E/V', meaning: 'Equity weight' },
          { symbol: 'D/V', meaning: 'Debt weight' },
          { symbol: 'P/V', meaning: 'Preferred weight' },
          { symbol: 'V', meaning: 'Total capital value (E + D + P)' },
        ],
        example: '(60% × 12%) + (40% × 5%) = 7.2% + 2% = 9.2%',
        tips: ['Use market values for weights', 'Discount rate for NPV'],
        category: 'Cost of Capital',
        blueprintArea: 'CMA2-B',
      },
      // VALUATION
      {
        id: 'cma2b-012',
        name: 'Bond Valuation',
        formula: 'Bond Value = PV of Coupon Payments + PV of Face Value',
        variables: [],
        example: 'C × PVIFA(YTM, n) + FV × PVIF(YTM, n)',
        tips: ['Discount at yield to maturity', 'Price > face = premium (coupon > YTM)'],
        category: 'Valuation',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-013',
        name: 'Stock Valuation - Constant Growth',
        formula: 'P₀ = D₁ / (Ke − g)',
        variables: [],
        example: '$3.00 × 1.04 / (10% − 4%) = $52',
        tips: ['Gordon Growth Model', 'Requires Ke > g'],
        category: 'Valuation',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-014',
        name: 'Enterprise Value',
        formula: 'EV = Market Cap + Debt − Cash',
        variables: [
          { symbol: 'Market Cap', meaning: 'Share price × Shares outstanding' },
        ],
        example: '$500M + $150M − $50M = $600M',
        tips: ['Value of entire business', 'Used in EV/EBITDA multiple'],
        category: 'Valuation',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-015',
        name: 'EV/EBITDA Multiple',
        formula: 'EV/EBITDA = Enterprise Value / EBITDA',
        variables: [],
        example: '$600M / $60M = 10x',
        tips: ['Commonly used in M&A', 'Capital structure neutral'],
        category: 'Valuation',
        blueprintArea: 'CMA2-B',
      },
      // LEVERAGE
      {
        id: 'cma2b-016',
        name: 'Degree of Operating Leverage',
        formula: 'DOL = Contribution Margin / EBIT',
        variables: [],
        example: '$300,000 / $100,000 = 3.0',
        tips: ['% change in EBIT for 1% change in sales'],
        category: 'Leverage',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-017',
        name: 'Degree of Financial Leverage',
        formula: 'DFL = EBIT / (EBIT − Interest)',
        variables: [],
        example: '$200,000 / $150,000 = 1.33',
        tips: ['% change in EPS for 1% change in EBIT'],
        category: 'Leverage',
        blueprintArea: 'CMA2-B',
      },
      {
        id: 'cma2b-018',
        name: 'Degree of Combined Leverage',
        formula: 'DCL = DOL × DFL = CM / (EBIT − Interest)',
        variables: [],
        example: '3.0 × 1.33 = 4.0',
        tips: ['% change in EPS for 1% change in sales'],
        category: 'Leverage',
        blueprintArea: 'CMA2-B',
      },
    ],
  },

  // ==========================================
  // CMA2-C: DECISION ANALYSIS (25%)
  // ==========================================
  {
    id: 'cma2c-formulas',
    name: 'Decision Analysis',
    blueprintArea: 'CMA2-C',
    weight: '25%',
    formulas: [
      // CAPITAL BUDGETING
      {
        id: 'cma2c-001',
        name: 'Net Present Value (NPV)',
        formula: 'NPV = Σ[CFₜ / (1 + r)ᵗ] − Initial Investment',
        variables: [
          { symbol: 'CFₜ', meaning: 'Cash flow in period t' },
          { symbol: 'r', meaning: 'Discount rate (WACC)' },
        ],
        example: 'PV of inflows − Initial outlay',
        tips: ['NPV > 0: Accept', 'NPV < 0: Reject', 'Preferred method'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-002',
        name: 'Internal Rate of Return (IRR)',
        formula: 'IRR = Rate where NPV = 0 (Σ[CFₜ / (1 + IRR)ᵗ] = Initial Investment)',
        variables: [],
        tips: ['IRR > WACC: Accept', 'May conflict with NPV for mutually exclusive projects'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-003',
        name: 'Payback Period',
        formula: 'Payback = Years until cumulative cash flows = Initial Investment',
        variables: [],
        example: 'If CF = $30K/year, Investment = $90K: Payback = 3 years',
        tips: ['Ignores time value', 'Ignores cash flows after payback', 'Simple but flawed'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-004',
        name: 'Discounted Payback',
        formula: 'Years until cumulative discounted cash flows = Initial Investment',
        variables: [],
        tips: ['Accounts for time value', 'Still ignores post-payback flows'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-005',
        name: 'Profitability Index',
        formula: 'PI = PV of Future Cash Flows / Initial Investment',
        variables: [],
        example: '$350,000 / $280,000 = 1.25',
        tips: ['PI > 1: Accept', 'Useful for capital rationing'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-006',
        name: 'Accounting Rate of Return',
        formula: 'ARR = Average Annual Accounting Profit / Average Investment',
        variables: [
          { symbol: 'Avg Investment', meaning: '(Initial + Salvage) / 2' },
        ],
        tips: ['Uses accounting income, not cash flow', 'Ignores time value'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-007',
        name: 'Operating Cash Flow',
        formula: 'OCF = (Revenue − Cash Expenses)(1 − T) + Depreciation × T',
        variables: [
          { symbol: 'T', meaning: 'Tax rate' },
          { symbol: 'Depreciation × T', meaning: 'Depreciation tax shield' },
        ],
        example: 'Also: OCF = Net Income + Depreciation (simplified)',
        tips: ['Add back depreciation (non-cash)', 'Tax shield = Dep × Tax Rate'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-008',
        name: 'Terminal Cash Flow',
        formula: 'Terminal CF = Salvage Value − Tax on Gain/Loss + NWC Recovery',
        variables: [
          { symbol: 'Tax on Gain', meaning: '(Salvage − Book Value) × Tax Rate' },
        ],
        example: '$30K salvage, $10K book, 40% tax: $30K − ($20K × 40%) = $22K',
        tips: ['Don\'t forget to recover working capital'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-009',
        name: 'Equivalent Annual Cost',
        formula: 'EAC = NPV of Costs / PVIFA(r, n)',
        variables: [],
        tips: ['Compares projects of different lives', 'Lower EAC preferred'],
        category: 'Capital Budgeting',
        blueprintArea: 'CMA2-C',
      },
      // COST OF TRADE CREDIT
      {
        id: 'cma2c-010',
        name: 'Cost of Trade Credit',
        formula: 'Cost = [Discount / (1 − Discount)] × [365 / (Net Period − Discount Period)]',
        variables: [],
        example: '2/10, net 30: [0.02/0.98] × [365/20] = 0.0204 × 18.25 = 37.2%',
        tips: ['Annualized cost of not taking discount', 'Compare to borrowing rate'],
        category: 'Working Capital',
        blueprintArea: 'CMA2-C',
      },
      // DECISION ANALYSIS
      {
        id: 'cma2c-011',
        name: 'Relevant Costs',
        formula: 'Relevant = Future + Differential (differ between alternatives)',
        variables: [],
        tips: ['Sunk costs are NOT relevant', 'Opportunity costs ARE relevant'],
        category: 'Decision Analysis',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-012',
        name: 'Make or Buy Decision',
        formula: 'Compare: Incremental cost to make vs. Purchase price',
        variables: [],
        tips: ['Include opportunity cost of capacity', 'Quality and reliability factors'],
        category: 'Decision Analysis',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-013',
        name: 'Special Order Decision',
        formula: 'Accept if: Special Order Price > Incremental Cost per Unit',
        variables: [],
        tips: ['Only if excess capacity exists', 'Consider effect on regular sales'],
        category: 'Decision Analysis',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-014',
        name: 'Sell or Process Further',
        formula: 'Process further if: Incremental Revenue > Incremental Costs',
        variables: [],
        tips: ['Joint costs are sunk (irrelevant)', 'Compare revenues at split-off vs. after processing'],
        category: 'Decision Analysis',
        blueprintArea: 'CMA2-C',
      },
      {
        id: 'cma2c-015',
        name: 'Constraint/Bottleneck Analysis',
        formula: 'Rank by: Contribution Margin per Unit of Constraint',
        variables: [],
        example: 'If machine hours limited: CM per machine hour',
        tips: ['Maximize CM per scarce resource', 'Theory of Constraints (TOC)'],
        category: 'Decision Analysis',
        blueprintArea: 'CMA2-C',
      },
    ],
  },

  // ==========================================
  // CMA2-D: RISK MANAGEMENT (10%)
  // ==========================================
  {
    id: 'cma2d-formulas',
    name: 'Risk Management',
    blueprintArea: 'CMA2-D',
    weight: '10%',
    formulas: [
      {
        id: 'cma2d-001',
        name: 'Expected Value',
        formula: 'EV = Σ(Probability × Outcome)',
        variables: [],
        example: '(0.3 × $100K) + (0.5 × $60K) + (0.2 × −$20K) = $56K',
        category: 'Risk Analysis',
        blueprintArea: 'CMA2-D',
      },
      {
        id: 'cma2d-002',
        name: 'Standard Deviation',
        formula: 'σ = √[Σ Pᵢ(Xᵢ − μ)²]',
        variables: [
          { symbol: 'Pᵢ', meaning: 'Probability of outcome i' },
          { symbol: 'Xᵢ', meaning: 'Outcome i' },
          { symbol: 'μ', meaning: 'Expected value (mean)' },
        ],
        tips: ['Measures total risk/volatility'],
        category: 'Risk Analysis',
        blueprintArea: 'CMA2-D',
      },
      {
        id: 'cma2d-003',
        name: 'Coefficient of Variation',
        formula: 'CV = σ / μ = Standard Deviation / Expected Value',
        variables: [],
        example: '$15,000 / $100,000 = 0.15 (15%)',
        tips: ['Relative risk measure', 'Lower CV = less relative risk'],
        category: 'Risk Analysis',
        blueprintArea: 'CMA2-D',
      },
      {
        id: 'cma2d-004',
        name: 'Beta (Systematic Risk)',
        formula: 'β = Covariance(Stock, Market) / Variance(Market)',
        variables: [],
        example: 'β = 1.2 means 20% more volatile than market',
        tips: ['β > 1: More volatile than market', 'β < 1: Less volatile'],
        category: 'Risk Analysis',
        blueprintArea: 'CMA2-D',
      },
      {
        id: 'cma2d-005',
        name: 'Portfolio Beta',
        formula: 'βp = Σ(wᵢ × βᵢ)',
        variables: [
          { symbol: 'wᵢ', meaning: 'Weight of asset i in portfolio' },
          { symbol: 'βᵢ', meaning: 'Beta of asset i' },
        ],
        example: '(60% × 1.2) + (40% × 0.8) = 1.04',
        category: 'Risk Analysis',
        blueprintArea: 'CMA2-D',
      },
      // DERIVATIVES
      {
        id: 'cma2d-006',
        name: 'Forward Contract Payoff',
        formula: 'Long Payoff = Spot Price − Forward Price\nShort Payoff = Forward Price − Spot Price',
        variables: [],
        example: 'Long at $50, spot at $55: Payoff = $5 gain',
        tips: ['No initial cost (premium)', 'Obligation to transact'],
        category: 'Derivatives',
        blueprintArea: 'CMA2-D',
      },
      {
        id: 'cma2d-007',
        name: 'Call Option Payoff',
        formula: 'Call Payoff = MAX(0, Stock Price − Strike Price) − Premium',
        variables: [],
        example: 'Strike $40, premium $5, stock $48: ($48−$40)−$5 = $3',
        tips: ['Right to buy', 'Max loss = premium paid'],
        category: 'Derivatives',
        blueprintArea: 'CMA2-D',
      },
      {
        id: 'cma2d-008',
        name: 'Put Option Payoff',
        formula: 'Put Payoff = MAX(0, Strike Price − Stock Price) − Premium',
        variables: [],
        example: 'Strike $60, premium $4, stock $52: ($60−$52)−$4 = $4',
        tips: ['Right to sell', 'Protective put hedges downside'],
        category: 'Derivatives',
        blueprintArea: 'CMA2-D',
      },
      {
        id: 'cma2d-009',
        name: 'Put-Call Parity',
        formula: 'Call + PV(Strike) = Put + Stock',
        variables: [],
        tips: ['Relates prices of puts and calls', 'Arbitrage if parity violated'],
        category: 'Derivatives',
        blueprintArea: 'CMA2-D',
      },
    ],
  },

  // ==========================================
  // CMA2-E: INVESTMENT DECISIONS (10%)
  // ==========================================
  {
    id: 'cma2e-formulas',
    name: 'Investment Decisions',
    blueprintArea: 'CMA2-E',
    weight: '10%',
    formulas: [
      {
        id: 'cma2e-001',
        name: 'Free Cash Flow to Firm (FCFF)',
        formula: 'FCFF = EBIT(1−T) + Depreciation − CapEx − ΔNWC',
        variables: [
          { symbol: 'ΔNWC', meaning: 'Change in Net Working Capital' },
        ],
        tips: ['Cash available to all capital providers', 'Discount at WACC'],
        category: 'Cash Flow Analysis',
        blueprintArea: 'CMA2-E',
      },
      {
        id: 'cma2e-002',
        name: 'Free Cash Flow to Equity (FCFE)',
        formula: 'FCFE = FCFF − Interest(1−T) + Net Borrowing',
        variables: [],
        tips: ['Cash available to equity holders', 'Discount at cost of equity'],
        category: 'Cash Flow Analysis',
        blueprintArea: 'CMA2-E',
      },
      {
        id: 'cma2e-003',
        name: 'Operating Cash Flow Ratio',
        formula: 'OCF Ratio = Operating Cash Flow / Current Liabilities',
        variables: [],
        example: '$180,000 / $120,000 = 1.5',
        tips: ['Measures ability to pay current obligations from operations'],
        category: 'Cash Flow Analysis',
        blueprintArea: 'CMA2-E',
      },
      {
        id: 'cma2e-004',
        name: 'Capital Allocation Rate',
        formula: 'Capital Allocation = Capital Expenditures / Operating Cash Flow',
        variables: [],
        tips: ['< 100% = generating free cash', '> 100% = consuming cash'],
        category: 'Cash Flow Analysis',
        blueprintArea: 'CMA2-E',
      },
    ],
  },

  // ==========================================
  // CMA2-F: PROFESSIONAL ETHICS (15%)
  // ==========================================
  {
    id: 'cma2f-formulas',
    name: 'Professional Ethics',
    blueprintArea: 'CMA2-F',
    weight: '15%',
    formulas: [
      {
        id: 'cma2f-001',
        name: 'IMA Statement of Ethical Professional Practice',
        formula: 'N/A - Four Principles: Honesty, Fairness, Objectivity, Responsibility',
        variables: [],
        tips: ['HFOR mnemonic', 'Foundation of CMA ethics'],
        category: 'IMA Ethics',
        blueprintArea: 'CMA2-F',
      },
      {
        id: 'cma2f-002',
        name: 'IMA Standards of Ethical Conduct',
        formula: 'N/A - Four Standards: Competence, Confidentiality, Integrity, Credibility',
        variables: [],
        tips: ['CCIC mnemonic', 'Specific behavioral requirements'],
        category: 'IMA Ethics',
        blueprintArea: 'CMA2-F',
      },
      {
        id: 'cma2f-003',
        name: 'Ethics Resolution Process',
        formula: 'N/A - Steps: 1) Discuss with supervisor, 2) Escalate to higher management, 3) Consult IMA Ethics Counselor, 4) Consider resignation if unresolved',
        variables: [],
        tips: ['Start internally before external', 'Document everything'],
        category: 'Ethics Guidance',
        blueprintArea: 'CMA2-F',
      },
    ],
  },
];

// ==========================================
// QUICK REFERENCE SUMMARY
// ==========================================

export const CMA2_QUICK_REFERENCE = {
  title: 'CMA Part 2 Quick Reference',
  keyFormulas: [
    'WACC = (E/V × Ke) + (D/V × Kd × (1−T))',
    'NPV = PV of inflows − Initial investment',
    'CAPM: Ke = Rf + β(Rm − Rf)',
    'Gordon Growth: P = D₁ / (Ke − g)',
    'ROE = Margin × Turnover × Leverage (DuPont)',
    'CCC = DIO + DSO − DPO',
  ],
  mnemonics: [
    { topic: 'Liquidity Ratios', mnemonic: 'Current → Quick → Cash (progressively stricter)' },
    { topic: 'Capital Budgeting', mnemonic: 'NPV is King (always prefer)' },
    { topic: 'IMA Ethics', mnemonic: 'HFOR: Honesty, Fairness, Objectivity, Responsibility' },
    { topic: 'DuPont ROE', mnemonic: 'Profit × Turnover × Leverage = ROE' },
    { topic: 'Trade Credit', mnemonic: '2/10 net 30 costs ~37% annually' },
  ],
  commonMistakes: [
    'Forgetting to use after-tax cost for debt in WACC',
    'Using ending balances instead of averages for ratios',
    'Not adjusting for tax shield on depreciation',
    'Confusing IRR decision rule when ranking mutually exclusive projects',
  ],
};
