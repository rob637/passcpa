// BAR - Business Analysis & Reporting Comprehensive Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Final batch

import { Question } from '../../../types';

export const BAR_QUESTIONS_COMPREHENSIVE: Question[] = [
  {
    id: 'bar-comp-001',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-analysis',
    topic: 'Financial Analysis',
    subtopic: 'Z-Score Model',
    difficulty: 'hard',
    blueprintArea: 'BAR-I',
    skillLevel: 'Analysis',
    question: 'The Altman Z-Score model is used to predict:',
    options: [
      'Bankruptcy risk using weighted ratios including working capital, retained earnings, EBIT, and sales to assets',
      'Interest rates',
      'Stock prices',
      'Credit ratings only',
    ],
    correctAnswer: 0,
    explanation: 'Altman Z-Score: Z = 1.2(WC/TA) + 1.4(RE/TA) + 3.3(EBIT/TA) + 0.6(MVE/TL) + 1.0(Sales/TA). Z < 1.81 = distress zone (high bankruptcy risk). Z > 2.99 = safe zone. Between = gray zone.',
    reference: 'Financial Analysis - Bankruptcy Prediction',
  },
  {
    id: 'bar-comp-002',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-analysis',
    topic: 'Financial Analysis',
    subtopic: 'Operating Leverage',
    difficulty: 'hard',
    blueprintArea: 'BAR-I',
    skillLevel: 'Analysis',
    question: 'Degree of operating leverage (DOL) measures:',
    options: [
      'Working capital',
      'The percentage change in EBIT for a given percentage change in sales',
      'Total debt',
      'Cash flow sensitivity',
    ],
    correctAnswer: 1,
    explanation: 'DOL = % change in EBIT / % change in sales = Contribution margin / EBIT. Higher fixed costs = higher DOL = greater earnings volatility. DOL varies at different sales levels (highest near breakeven).',
    reference: 'Financial Analysis - Leverage',
  },
  {
    id: 'bar-comp-003',
    courseId: 'cpa',
    section: 'BAR',
    blueprintArea: 'BAR-I',
    topic: 'Financial Analysis',
    subtopic: 'Economic Value Added',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Two divisions each have $10 million in invested capital and WACC of 9%. Division X earns NOPAT of $1.2 million; Division Y earns NOPAT of $850,000. Which statement about their EVA is correct?',
    options: [
      'Division X has positive EVA ($300K); Division Y has negative EVA (−$50K)',
      'Both divisions have positive EVA',
      'Both divisions have negative EVA',
      'Division X has positive EVA ($1.2M); Division Y has negative EVA ($850K)',
    ],
    correctAnswer: 0,
    explanation: 'EVA = NOPAT − (Capital × WACC). Division X: $1,200,000 − ($10M × 9%) = $1,200,000 − $900,000 = $300,000 (positive — creates value). Division Y: $850,000 − $900,000 = −$50,000 (negative — destroys value). Despite both divisions being profitable in accounting terms, Division Y\'s return (8.5%) falls below the 9% WACC hurdle rate.',
    reference: 'Financial Analysis - Value Metrics',
  },
  {
    id: 'bar-comp-004',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-valuation',
    topic: 'Business Valuation',
    subtopic: 'DCF Assumptions',
    difficulty: 'hard',
    blueprintArea: 'BAR-I',
    skillLevel: 'Analysis',
    question: 'The terminal value in a DCF model typically assumes:',
    options: [
      'Perpetual growth at a rate below long-term economic growth',
      'Zero growth',
      'Declining growth only',
      'Exponential growth',
    ],
    correctAnswer: 0,
    explanation: 'Terminal value: perpetuity formula = FCF(1+g)/(r-g). Growth rate (g) must be ≤ long-term GDP growth (2-3%). Terminal value often represents 60-80% of total value. Alternative: exit multiple approach.',
    reference: 'Business Valuation - DCF',
  },
  {
    id: 'bar-comp-005',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-adjustments',
    topic: 'Financial Statement Adjustments',
    subtopic: 'LIFO to FIFO',
    difficulty: 'hard',
    blueprintArea: 'BAR-I',
    skillLevel: 'Application',
    question: 'To convert a LIFO company to FIFO for comparison, the analyst should:',
    options: [
      'Adjust only cost of goods sold',
      'Ignore inventory differences',
      'Add LIFO reserve to inventory and retained earnings (net of tax)',
      'Reduce inventory',
    ],
    correctAnswer: 2,
    explanation: 'LIFO to FIFO: Inventory + LIFO reserve. Retained earnings + LIFO reserve × (1 - tax rate). COGS - change in LIFO reserve. Makes comparisons across methods valid.',
    reference: 'Financial Statement Analysis',
  },
  {
    id: 'bar-comp-006',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-revenue',
    topic: 'Revenue Recognition',
    subtopic: 'Licensing IP',
    difficulty: 'hard',
    blueprintArea: 'BAR-II',
    skillLevel: 'Analysis',
    question: 'Revenue from a license of intellectual property is recognized:',
    options: [
      'Always over time',
      'At contract signing',
      'When cash received',
      'At point in time for right to use; over time for right to access',
    ],
    correctAnswer: 3,
    explanation: 'Right to use (functional IP): point in time recognition (e.g., software). Right to access (symbolic IP): over time recognition (e.g., brand, franchise). Depends on nature of licensor\'s promise and IP type.',
    reference: 'ASC 606-10-55-58',
  },
  {
    id: 'bar-comp-007',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-revenue',
    topic: 'Revenue Recognition',
    subtopic: 'Principal vs Agent',
    difficulty: 'hard',
    blueprintArea: 'BAR-II',
    skillLevel: 'Analysis',
    question: 'An entity is a principal (not agent) when it:',
    options: [
      'Acts on behalf of another',
      'Has no inventory risk',
      'Controls the specified good or service before transfer to customer',
      'Earns a commission',
    ],
    correctAnswer: 2,
    explanation: 'Principal: controls goods/services before transfer. Indicators: primary responsibility, inventory risk, pricing discretion. Principal records gross revenue. Agent: arranges for another to provide goods/services, records net (commission).',
    reference: 'ASC 606-10-55-36',
  },
  {
    id: 'bar-comp-008',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-leases',
    topic: 'Lease Accounting',
    subtopic: 'Reassessment',
    difficulty: 'hard',
    blueprintArea: 'BAR-III',
    skillLevel: 'Analysis',
    question: 'A lessee must reassess lease classification when:',
    options: [
      'Annually',
      'Interest rates change',
      'There is a lease modification not accounted for as a separate contract',
      'Any market change occurs',
    ],
    correctAnswer: 2,
    explanation: 'Reassess classification when: (1) modification not a separate contract, (2) change in lease term, (3) change in probability of purchase option exercise. Also reassess if residual value guarantee changes.',
    reference: 'ASC 842-10-35-4',
  },
  {
    id: 'bar-comp-009',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-leases',
    topic: 'Lease Accounting',
    subtopic: 'Variable Lease Payments',
    difficulty: 'hard',
    blueprintArea: 'BAR-III',
    skillLevel: 'Analysis',
    question: 'Variable lease payments based on sales or performance are:',
    options: [
      'Not included in lease liability but expensed as incurred',
      'Capitalized at inception',
      'Included in lease liability',
      'Ignored entirely',
    ],
    correctAnswer: 0,
    explanation: 'Variable payments: Index/rate-based = included in liability (remeasure when index changes). Performance/sales-based = NOT in liability, expense as incurred. In-substance fixed payments = include in liability.',
    reference: 'ASC 842-10-30-5',
  },
  {
    id: 'bar-comp-010',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-taxes',
    topic: 'Income Taxes',
    subtopic: 'Tax Rate Reconciliation',
    difficulty: 'hard',
    blueprintArea: 'BAR-IV',
    skillLevel: 'Analysis',
    question: 'The tax rate reconciliation explains differences between:',
    options: [
      'Statutory tax rate and effective tax rate applied to pretax income',
      'Current and deferred taxes',
      'Cash taxes paid and tax expense',
      'Federal and state rates',
    ],
    correctAnswer: 0,
    explanation: 'Rate reconciliation: statutory rate (21% federal) to effective rate. Common items: state taxes, permanent differences (meals, DPAD, tax credits), foreign rate differences, valuation allowance changes.',
    reference: 'ASC 740-10-50-12',
  },
  {
    id: 'bar-comp-011',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-taxes',
    topic: 'Income Taxes',
    subtopic: 'Uncertain Tax Positions',
    difficulty: 'hard',
    blueprintArea: 'BAR-IV',
    skillLevel: 'Analysis',
    question: 'Under ASC 740, an uncertain tax position is recognized when:',
    options: [
      'IRS issues guidance',
      'Guaranteed to succeed',
      'Any uncertainty exists',
      'It is more likely than not (>50%) that the position will be sustained upon examination',
    ],
    correctAnswer: 3,
    explanation: 'Two-step process: (1) Recognition - MLTN (>50%) of being sustained. If not met, no benefit. (2) Measurement - largest amount with >50% cumulative probability. Include interest/penalties based on policy.',
    reference: 'ASC 740-10-25',
  },
  {
    id: 'bar-comp-012',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-combinations',
    topic: 'Business Combinations',
    subtopic: 'Pushdown Accounting',
    difficulty: 'hard',
    blueprintArea: 'BAR-V',
    skillLevel: 'Analysis',
    question: 'Pushdown accounting results in the acquired entity:',
    options: [
      'Restating its assets and liabilities to fair value in its own separate financial statements',
      'Keeping historical cost basis',
      'Eliminating retained earnings only',
      'Writing off goodwill',
    ],
    correctAnswer: 0,
    explanation: 'Pushdown: acquiree "pushes down" acquisition accounting to its separate F/S. Restate assets/liabilities to FV, record goodwill, reset retained earnings. Optional election per ASU 2014-17.',
    reference: 'ASC 805-50',
  },
  {
    id: 'bar-comp-013',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-combinations',
    topic: 'Business Combinations',
    subtopic: 'Step Acquisition',
    difficulty: 'hard',
    blueprintArea: 'BAR-V',
    skillLevel: 'Analysis',
    question: 'In a step acquisition achieving control, the acquirer:',
    options: [
      'Uses historical cost for prior interest',
      'Ignores prior investment',
      'Remeasures previously held equity interest at acquisition-date fair value, recognizing gain/loss',
      'Uses book value',
    ],
    correctAnswer: 2,
    explanation: 'Step acquisition: remeasure previously held equity at FV on acquisition date. Recognize gain/loss in income. Include at FV in calculating total consideration. Apply acquisition method from control date.',
    reference: 'ASC 805-10-25-10',
  },
  {
    id: 'bar-comp-014',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-consolidation',
    topic: 'Consolidation',
    subtopic: 'Intercompany Transactions',
    difficulty: 'hard',
    blueprintArea: 'BAR-V',
    skillLevel: 'Application',
    question: 'Unrealized profit on intercompany upstream inventory sales is eliminated against:',
    options: [
      'Parent only',
      'Subsidiary only',
      'Neither',
      'Noncontrolling interest (and parent) in proportion to ownership',
    ],
    correctAnswer: 3,
    explanation: 'Upstream (sub sells to parent): eliminate unrealized profit from NCI and controlling interest proportionately. Downstream (parent sells to sub): eliminate entirely from controlling interest. Affects NCI share of subsidiary income.',
    reference: 'ASC 810-10-45-18',
  },
  {
    id: 'bar-comp-015',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-cost',
    topic: 'Cost Accounting',
    subtopic: 'Activity-Based Costing',
    difficulty: 'hard',
    blueprintArea: 'BAR-VI',
    skillLevel: 'Analysis',
    question: 'Activity-based costing improves upon traditional costing by:',
    options: [
      'Allocating based on direct labor only',
      'Using a single overhead rate',
      'Ignoring indirect costs',
      'Assigning overhead based on activities that drive costs using multiple cost pools and drivers',
    ],
    correctAnswer: 3,
    explanation: 'ABC: identify activities → assign costs to cost pools → select cost drivers → allocate to products based on activity consumption. More accurate for complex operations with diverse products. Better for strategic decisions.',
    reference: 'Cost Accounting - ABC',
  },
  {
    id: 'bar-comp-016',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-cost',
    topic: 'Cost Accounting',
    subtopic: 'Transfer Pricing',
    difficulty: 'hard',
    blueprintArea: 'BAR-VI',
    skillLevel: 'Analysis',
    question: 'The minimum transfer price for a selling division with no excess capacity is:',
    options: [
      'Full cost',
      'Variable cost only',
      'Variable cost plus opportunity cost (contribution margin of external sales foregone)',
      'Market price always',
    ],
    correctAnswer: 2,
    explanation: 'Minimum TP: variable cost + opportunity cost. No excess capacity: opportunity cost = CM lost on external sales. Excess capacity: opportunity cost = $0, so TP = variable cost. Maximum TP typically = market price.',
    reference: 'Cost Accounting - Transfer Pricing',
  },
  {
    id: 'bar-comp-017',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-cost',
    topic: 'Cost Accounting',
    subtopic: 'Theory of Constraints',
    difficulty: 'hard',
    blueprintArea: 'BAR-VI',
    skillLevel: 'Analysis',
    question: 'Under Theory of Constraints, a bottleneck should be managed by:',
    options: [
      'Reducing quality',
      'Maximizing throughput contribution per unit of the constrained resource',
      'Adding more bottlenecks',
      'Ignoring non-bottleneck operations',
    ],
    correctAnswer: 1,
    explanation: 'TOC: throughput accounting. Maximize throughput contribution (revenue - direct materials) per constraint unit. Steps: identify constraint, exploit it, subordinate other processes, elevate constraint, repeat.',
    reference: 'TOC - Throughput Accounting',
  },
  {
    id: 'bar-comp-018',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-variance',
    topic: 'Variance Analysis',
    subtopic: 'Sales Mix Variance',
    difficulty: 'hard',
    blueprintArea: 'BAR-VI',
    skillLevel: 'Analysis',
    question: 'The sales mix variance measures the impact of:',
    options: [
      'Selling a different proportion of products than budgeted, at budgeted contribution margins',
      'Cost changes',
      'Price changes',
      'Volume changes',
    ],
    correctAnswer: 0,
    explanation: 'Sales mix variance: (Actual mix % - Budget mix %) × Actual total units × Budget CM per unit. Favorable when higher-margin products exceed budgeted proportion. Part of total sales volume variance analysis.',
    reference: 'Variance Analysis - Sales',
  },
  {
    id: 'bar-comp-019',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-budgeting',
    topic: 'Budgeting',
    subtopic: 'Beyond Budgeting',
    difficulty: 'hard',
    blueprintArea: 'BAR-VI',
    skillLevel: 'Evaluation',
    question: 'The Beyond Budgeting model advocates:',
    options: [
      'Strict variance analysis',
      'Eliminating all planning',
      'Replacing fixed budgets with adaptive processes, rolling forecasts, and relative performance measures',
      'More detailed budgets',
    ],
    correctAnswer: 2,
    explanation: 'Beyond Budgeting: replace annual fixed budgets with adaptive management. Uses: rolling forecasts, relative targets (vs. peers/benchmarks), decentralized decision-making, continuous planning. Responds to criticism of traditional budgeting.',
    reference: 'Budgeting - Beyond Budgeting',
  },
  {
    id: 'bar-comp-020',
    courseId: 'cpa',
    section: 'BAR',
    blueprintArea: 'BAR-I',
    topic: 'Risk Management',
    subtopic: 'Value at Risk',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A portfolio has a daily mean return of 0.05% and daily standard deviation of 1.2%. Using the parametric method, what is the approximate 1-day VaR at the 99% confidence level (z = 2.33)?',
    options: [
    '2.75% potential loss',
    '2.85% potential loss',
    '2.75% potential gain',
    '1.20% potential loss',
    ],
    correctAnswer: 0,
    explanation: '1-day VaR at 99% = Mean − z × σ = 0.05% − 2.33 × 1.2% = 0.05% − 2.796% = −2.746%, approximately a 2.75% potential loss. VaR estimates the maximum expected loss over a given time horizon at a specified confidence level. The 99% level means there is only a 1% chance the actual loss will exceed this amount.',
    reference: 'Risk Management - VaR',
  },
  {
    id: 'bar-comp-021',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-forex',
    topic: 'Foreign Currency',
    subtopic: 'Remeasurement vs Translation',
    difficulty: 'hard',
    blueprintArea: 'BAR-II',
    skillLevel: 'Analysis',
    question: 'The key difference between remeasurement and translation is:',
    options: [
      'Remeasurement uses temporal method with gain/loss in income; translation uses current rate with adjustment in OCI',
      'Currency used',
      'Timing only',
      'No difference',
    ],
    correctAnswer: 0,
    explanation: 'Remeasurement: temporal method, functional currency ≠ local. Gain/loss to income. Translation: current rate method, functional = local ≠ reporting. CTA to OCI. Based on functional currency determination.',
    reference: 'ASC 830',
  },
  {
    id: 'bar-comp-022',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-derivatives',
    topic: 'Derivatives',
    subtopic: 'Cash Flow Hedge Effectiveness',
    difficulty: 'hard',
    blueprintArea: 'BAR-II',
    skillLevel: 'Analysis',
    question: 'For cash flow hedge accounting, the effective portion of the hedge:',
    options: [
      'Goes directly to income',
      'Is ignored',
      'Is reported in OCI and reclassified to earnings when the hedged transaction affects earnings',
      'Reduces the derivative\'s value',
    ],
    correctAnswer: 2,
    explanation: 'Cash flow hedge: effective portion to OCI (AOCI). Reclassify to earnings when hedged item affects earnings. Ineffective portion to earnings immediately. Document hedge relationship at inception.',
    reference: 'ASC 815-30',
  },
  {
    id: 'bar-comp-023',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-analytics',
    topic: 'Data Analytics',
    subtopic: 'Regression Analysis',
    difficulty: 'hard',
    blueprintArea: 'BAR-I',
    skillLevel: 'Analysis',
    question: 'In regression analysis, R-squared indicates:',
    options: [
      'The slope of the line',
      'The proportion of variance in the dependent variable explained by independent variable(s)',
      'Statistical significance',
      'The correlation coefficient',
    ],
    correctAnswer: 1,
    explanation: 'R² (coefficient of determination): proportion of dependent variable variance explained by model. Range 0-1. R² = 0.75 means 75% of variation explained. Adjusted R² accounts for number of predictors. High R² doesn\'t guarantee causation.',
    reference: 'Data Analytics - Regression',
  },
  {
    id: 'bar-comp-024',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-segment',
    topic: 'Segment Reporting',
    subtopic: 'Quantitative Thresholds',
    difficulty: 'hard',
    blueprintArea: 'BAR-II',
    skillLevel: 'Application',
    question: 'An operating segment is separately reportable if it meets any of the following thresholds:',
    options: [
      '100% of revenue',
      '10% of combined revenue, reported profit/loss, or combined assets of all operating segments',
      '50% of total assets',
      '5% of any measure',
    ],
    correctAnswer: 1,
    explanation: 'Reportable segment: meets any 10% test: (1) combined internal/external revenue, (2) reported profit or loss (compared to greater of combined profit or combined loss), (3) assets. 75% of external revenue must be in reportable segments.',
    reference: 'ASC 280-10-50-12',
  },
  {
    id: 'bar-comp-025',
    section: 'BAR',
    courseId: 'cpa',
    topicId: 'bar-accounting',
    topic: 'Special Accounting',
    subtopic: 'Asset Retirement Obligations',
    difficulty: 'hard',
    blueprintArea: 'BAR-III',
    skillLevel: 'Analysis',
    question: 'An asset retirement obligation is recognized when:',
    options: [
      'The asset is retired',
      'Costs are incurred',
      'Retirement is planned',
      'A legal obligation exists and fair value can be reasonably estimated',
    ],
    correctAnswer: 3,
    explanation: 'ARO: recognize when legal obligation exists (statute, contract, promissory estoppel) and FV can be estimated. Dr. Asset, Cr. Liability (PV). Accrete liability over time. Depreciate asset component. Adjust for estimate changes.',
    reference: 'ASC 410-20',
  },
];
