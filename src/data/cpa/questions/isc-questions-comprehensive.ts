// ISC - Information Systems & Controls Comprehensive Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Final batch

import { Question } from '../../../types';

export const ISC_QUESTIONS_COMPREHENSIVE: Question[] = [
  {
    id: 'isc-adv-001',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'Database Normalization',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'Third normal form (3NF) eliminates:',
    options: [
      'Repeating groups',
      'Transitive dependencies where non-key attributes depend on other non-key attributes',
      'All redundancy',
      'Primary keys',
    ],
    correctAnswer: 1,
    explanation: '3NF: no transitive dependencies. Non-key attributes must depend ONLY on the primary key, not on other non-key attributes. 1NF = no repeating groups. 2NF = no partial dependencies. 3NF reduces update anomalies.',
    reference: 'Database Design - Normalization',
  },
  {
    id: 'isc-adv-002',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'ERP Implementation',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Evaluation',
    question: 'The "big bang" approach to ERP implementation:',
    options: [
      'Avoids customization',
      'Implements modules gradually',
      'Uses parallel processing indefinitely',
      'Replaces all legacy systems simultaneously across the organization',
    ],
    correctAnswer: 3,
    explanation: 'Big bang: full implementation at once. Higher risk but faster realization of benefits. Alternative approaches: phased (by module/location), parallel (run both systems), pilot (test site first). Risk factors: complexity, change management.',
    reference: 'ERP Implementation Strategies',
  },
  {
    id: 'isc-adv-003',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'DevOps',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'DevOps practices integrate:',
    options: [
      'End user support only',
      'Hardware only',
      'Only development activities',
      'Development and operations teams for continuous integration, delivery, and deployment',
    ],
    correctAnswer: 3,
    explanation: 'DevOps: culture/practice merging development and operations. Continuous integration (CI), continuous delivery (CD), automated testing, infrastructure as code, monitoring. Faster delivery, improved collaboration, reduced silos.',
    reference: 'DevOps Practices',
  },
  {
    id: 'isc-comp-004',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Change Management',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'Effective IT change management should include:',
    options: [
      'Immediate implementation without approval',
      'Request, impact assessment, approval, testing, implementation, and documentation',
      'Only programmer changes',
      'Monthly reviews only',
    ],
    correctAnswer: 1,
    explanation: 'Change management: (1) formal request, (2) impact/risk assessment, (3) appropriate approval, (4) testing, (5) scheduled implementation, (6) back-out plan, (7) documentation, (8) post-implementation review. Prevents unauthorized changes.',
    reference: 'ITIL Change Management',
  },
  {
    id: 'isc-comp-005',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Cybersecurity',
    subtopic: 'Zero Trust Architecture',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Zero Trust security architecture operates on the principle:',
    options: [
      'Trust internal networks',
      'Never trust, always verify - assume breach and verify explicitly regardless of location',
      'Trust verified users',
      'Perimeter security is sufficient',
    ],
    correctAnswer: 1,
    explanation: 'Zero Trust: "never trust, always verify." No implicit trust based on network location. Principles: verify explicitly, least privilege access, assume breach. Micro-segmentation, MFA, continuous validation, encrypt everything.',
    reference: 'Zero Trust Architecture - NIST SP 800-207',
  },
  {
    id: 'isc-comp-006',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Cybersecurity',
    subtopic: 'Penetration Testing',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Black box penetration testing means:',
    options: [
      'Tester has full system knowledge',
      'Tester has no prior knowledge of the target system, simulating external attacker',
      'Testing is automated only',
      'Testing internal threats only',
    ],
    correctAnswer: 1,
    explanation: 'Black box: no prior knowledge (external attacker simulation). White box: full knowledge (source code, architecture). Gray box: partial knowledge (user-level access). Each has different use cases and cost/time implications.',
    reference: 'Penetration Testing Methodologies',
  },
  {
    id: 'isc-comp-007',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Cryptography',
    subtopic: 'Digital Certificates',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'A digital certificate binds:',
    options: [
      'A public key to an identity, verified by a trusted certificate authority',
      'Private keys to users',
      'Two passwords together',
      'Encryption algorithms',
    ],
    correctAnswer: 0,
    explanation: 'Digital certificate: contains public key + identity information, signed by CA. X.509 standard format. Chain of trust: root CA → intermediate CA → end entity. Certificate contains: public key, subject name, issuer, validity period, signature.',
    reference: 'PKI - Digital Certificates',
  },
  {
    id: 'isc-comp-008',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topic: 'Network Security',
    subtopic: 'SIEM',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An auditor reviews the organization\'s vulnerability management program and discovers that critical vulnerabilities in the financial reporting system\'s web server have a mean time to remediate (MTTR) of 180 days. Industry benchmarks for critical vulnerabilities recommend remediation within 15 days. During the 180-day window, the vulnerabilities were publicly known and exploit code was available. What risk does this present?',
    options: [
      '180 days is a reasonable remediation timeline for a busy IT department',
      'A 180-day MTTR for critical vulnerabilities with available exploits means the financial reporting system is exposed to known attacks for an extended period — attackers can exploit publicly documented vulnerabilities during the remediation gap, potentially compromising financial data integrity',
      'Vulnerability remediation timelines are not relevant to financial audits',
      'The web server firewall compensates for unpatched vulnerabilities',
    ],
    correctAnswer: 1,
    explanation: 'The gap between vulnerability disclosure and remediation is the window of exposure. When critical vulnerabilities have publicly available exploit code, the risk escalates dramatically. 180 days vs. the 15-day benchmark means the organization is exposed 12x longer than recommended. The auditor should assess: (1) whether any exploitation occurred, (2) the financial data at risk, (3) compensating controls, and (4) whether the vulnerability management program is adequately resourced.',
    reference: 'SIEM Solutions',
  },
  {
    id: 'isc-comp-009',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-controls',
    topic: 'IT Controls',
    subtopic: 'Segregation of Duties',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'IT segregation of duties should separate:',
    options: [
      'Programming languages only',
      'Development, operations, and security administration to prevent unauthorized changes or fraud',
      'All IT functions',
      'Hardware and software',
    ],
    correctAnswer: 1,
    explanation: 'IT SoD: separate conflicting duties. Key separations: development vs. production, operations vs. security admin, DBA vs. users, change approval vs. implementation. Compensating controls if separation impractical (small IT shops).',
    reference: 'IT Controls - SoD',
  },
  {
    id: 'isc-comp-010',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-controls',
    topic: 'IT General Controls',
    subtopic: 'Access Reviews',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Application',
    question: 'Periodic access reviews should:',
    options: [
      'Occur only at year-end',
      'Be performed by IT only',
      'Have data owners verify appropriateness of user access rights on a regular basis',
      'Focus on new employees only',
    ],
    correctAnswer: 2,
    explanation: 'Access reviews: data owners review and certify appropriateness of access. Frequency based on risk. Review terminated employees, transfers, privilege changes. Detect access creep. Document reviews and remediation.',
    reference: 'Access Control - User Access Reviews',
  },
  {
    id: 'isc-comp-011',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-IV',
    topic: 'Data Privacy',
    subtopic: 'Data Subject Rights',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An organization collects and processes customer credit card data as part of its e-commerce operations. The auditor discovers that full credit card numbers are stored unencrypted in the sales transaction table of the financial reporting database. What are the implications?',
    options: [
      'This is acceptable practice for sales reconciliation purposes',
      'Storing unencrypted credit card data violates PCI DSS requirements, creates significant data breach liability, and may result in regulatory penalties, legal liability, and reputational damage that could affect the entity\'s financial position',
      'Encryption is only required for data in transit, not data at rest',
      'The auditor has no responsibility to evaluate data protection controls',
    ],
    correctAnswer: 1,
    explanation: 'PCI DSS strictly prohibits storing full credit card numbers in unencrypted form. Violations can result in: (1) significant fines from card brands, (2) loss of ability to process card payments, (3) breach notification obligations, (4) legal liability to affected cardholders, and (5) remediation costs. The auditor should evaluate the potential financial exposure, assess whether a contingent liability disclosure is needed, and recommend immediate remediation including encryption or tokenization.',
    reference: 'GDPR Articles 15-22',
  },
  {
    id: 'isc-comp-012',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Minimization',
    difficulty: 'medium',
    blueprintArea: 'ISC-IV',
    skillLevel: 'Application',
    question: 'Data minimization requires organizations to:',
    options: [
      'Delete all data immediately',
      'Collect all available data',
      'Collect only data that is adequate, relevant, and limited to what is necessary',
      'Encrypt everything',
    ],
    correctAnswer: 2,
    explanation: 'Data minimization: core privacy principle. Collect minimum necessary for stated purpose. Also implies retention limits - don\'t keep longer than necessary. Reduces risk from breaches. GDPR Article 5(1)(c).',
    reference: 'Privacy Principles - Data Minimization',
  },
  {
    id: 'isc-comp-013',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'SOC 2 Trust Services Criteria',
    difficulty: 'hard',
    blueprintArea: 'ISC-V',
    skillLevel: 'Analysis',
    question: 'The SOC 2 Trust Services Criteria include:',
    options: [
      'Marketing effectiveness',
      'Security, availability, processing integrity, confidentiality, and privacy',
      'Financial reporting controls only',
      'Employee satisfaction',
    ],
    correctAnswer: 1,
    explanation: 'SOC 2 TSC: (1) Security (mandatory), (2) Availability, (3) Processing integrity, (4) Confidentiality, (5) Privacy. Organization selects criteria. Security (common criteria) required. Focus on operational controls.',
    reference: 'AICPA SOC 2 - Trust Services Criteria',
  },
  {
    id: 'isc-comp-014',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'SOC 3',
    difficulty: 'medium',
    blueprintArea: 'ISC-V',
    skillLevel: 'Application',
    question: 'A SOC 3 report differs from SOC 2 by:',
    options: [
      'Being more detailed',
      'Covering financial reporting',
      'Being a general use report suitable for public distribution without detailed control descriptions',
      'Being restricted use'
    ],
    correctAnswer: 2,
    explanation: 'SOC 3: general use, publicly distributable, same scope as SOC 2 but without detailed control descriptions or test results. Used for marketing, website display. SOC 2 is restricted use (specified parties).',
    reference: 'AICPA SOC 3 Reports',
  },
  {
    id: 'isc-comp-015',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Smart Contracts',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Analysis',
    question: 'Smart contracts on blockchain:',
    options: [
      'Self-execute when predefined conditions are met, with terms directly written into code',
      'Replace legal contracts entirely',
      'Require manual approval',
      'Are easily modified'
    ],
    correctAnswer: 0,
    explanation: 'Smart contracts: code that auto-executes when conditions met. Stored on blockchain (immutable). Benefits: automation, trust, transparency, efficiency. Risks: bugs are permanent, oracle dependency, legal enforceability questions.',
    reference: 'Blockchain - Smart Contracts',
  },
  {
    id: 'isc-comp-016',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Machine Learning Governance',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Evaluation',
    question: 'AI/ML governance should address:',
    options: [
      'Cost only',
      'Bias, explainability, data quality, model risk, ethics, and regulatory compliance',
      'Technical performance only',
      'Speed of processing',
    ],
    correctAnswer: 1,
    explanation: 'ML governance: model validation, bias detection/mitigation, explainability (black box concern), data quality, drift monitoring, ethical use, regulatory compliance (fair lending, etc.), documentation, accountability.',
    reference: 'AI/ML Governance',
  },
  {
    id: 'isc-comp-017',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-emerging',
    topic: 'Cloud Computing',
    subtopic: 'Cloud Security',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Analysis',
    question: 'In the cloud shared responsibility model, the customer is always responsible for:',
    options: [
      'Network infrastructure',
      'Data classification, access management, and configuration of customer-controlled resources',
      'Physical security',
      'Hypervisor security',
    ],
    correctAnswer: 1,
    explanation: 'Shared responsibility: cloud provider secures infrastructure. Customer always responsible for: data classification, IAM, application security, OS patching (IaaS), configuration. Varies by service model (IaaS/PaaS/SaaS).',
    reference: 'Cloud Security - Shared Responsibility',
  },
  {    id: 'isc-comp-018',    courseId: 'cpa',    section: 'ISC',    blueprintArea: 'ISC-III',    topic: 'Business Continuity',    subtopic: 'RTO and RPO',    difficulty: 'hard',    skillLevel: 'Analysis',    question: 'An organization tests its disaster recovery plan and discovers that while the financial application was restored successfully, the data recovered was 72 hours old due to the backup schedule. Transactions from the 72-hour gap (approximately $15 million in sales) would need to be manually re-entered. What should the auditor evaluate?',    options: [    '72-hour data loss is acceptable for all organizations',    'The recovery point objective (RPO) gap — whether the 72-hour data loss is within the organization\'s stated RPO, whether the manual re-entry process for $15 million in transactions introduces accuracy and completeness risks, and whether a more frequent backup schedule is warranted',    'Data loss is an IT operations issue not relevant to financial auditing',    'Manual re-entry ensures data accuracy because humans verify each transaction',    ],    correctAnswer: 1,    explanation: 'The 72-hour gap between backup and disaster represents the recovery point objective (RPO). The auditor should assess: (1) whether 72 hours exceeds the organization\'s stated RPO, (2) the risk of errors during manual re-entry of $15M in transactions, (3) whether source documents exist to support re-entry, (4) the time required for re-entry and its impact on financial reporting deadlines, and (5) whether real-time replication or more frequent backups could reduce the RPO.',    reference: 'Business Continuity - RPO/RTO',  },
  {
    id: 'isc-comp-019',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-bcp',
    topic: 'Disaster Recovery',
    subtopic: 'DR Site Types',
    difficulty: 'medium',
    blueprintArea: 'ISC-III',
    skillLevel: 'Application',
    question: 'A warm site provides:',
    options: [
      'No equipment',
      'Full real-time data replication',
      'Pre-installed hardware and connectivity but requires data restoration from backups',
      'Empty building only',
    ],
    correctAnswer: 2,
    explanation: 'DR sites: Cold = building/power, no equipment. Warm = hardware installed, needs data. Hot = fully operational, real-time replication. Trade-off: cost vs. recovery time. Hot site most expensive, fastest recovery.',
    reference: 'Disaster Recovery Sites',
  },
  {
    id: 'isc-comp-020',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-frameworks',
    topic: 'Control Frameworks',
    subtopic: 'COBIT',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'COBIT 2019 governance objectives include:',
    options: [
      'Programming standards',
      'Technical specifications only',
      'Hardware requirements',
      'Evaluate, Direct, and Monitor (EDM) covering IT governance alignment with enterprise goals',
    ],
    correctAnswer: 3,
    explanation: 'COBIT 2019: IT governance framework. Governance objectives: Evaluate, Direct, Monitor. Management objectives: APO (Align, Plan, Organize), BAI (Build, Acquire, Implement), DSS (Deliver, Service, Support), MEA (Monitor, Evaluate, Assess).',
    reference: 'COBIT 2019 Framework',
  },
  {
    id: 'isc-comp-021',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-frameworks',
    topic: 'Control Frameworks',
    subtopic: 'NIST CSF',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'The NIST Cybersecurity Framework core functions are:',
    options: [
      'Security, Availability, Integrity',
      'Identify, Protect, Detect, Respond, Recover',
      'Plan, Do, Check, Act',
      'Design, Implement, Test',
    ],
    correctAnswer: 1,
    explanation: 'NIST CSF core: Identify (asset management, risk), Protect (access, training, maintenance), Detect (monitoring, anomalies), Respond (planning, communications, mitigation), Recover (planning, improvements). Widely adopted.',
    reference: 'NIST Cybersecurity Framework',
  },
  {
    id: 'isc-comp-022',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-audit',
    topic: 'IT Audit',
    subtopic: 'CAATs',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Computer-assisted audit techniques (CAATs) include:',
    options: [
      'Manual testing only',
      'Interviewing users',
      'Observation only',
      'Test data, integrated test facility, parallel simulation, and data analytics',
    ],
    correctAnswer: 3,
    explanation: 'CAATs: test data (dummy transactions), ITF (embed test in live system), parallel simulation (auditor program processes live data), generalized audit software, embedded audit modules, data analytics. Efficient for large volumes.',
    reference: 'IT Audit - CAATs',
  },
  {    id: 'isc-comp-023',    courseId: 'cpa',    section: 'ISC',    blueprintArea: 'ISC-II',    topic: 'Incident Response',    subtopic: 'IR Phases',    difficulty: 'hard',    skillLevel: 'Analysis',    question: 'During incident response to a data breach, the security team discovers that the attacker gained access to the financial reporting system through a compromised vendor VPN account 6 months ago. The attacker had read-write access to the general ledger during this period. What is the most critical audit consideration?',    options: [    'The breach is only an IT concern and does not affect the financial audit',    'The 6-month unauthorized access period means all financial data processed during that time period may be compromised — the auditor must evaluate data integrity for the entire compromised period, determine whether financial statements require restatement, and assess whether the entity\'s internal controls were effective',    'The auditor should only test transactions from the day the breach was discovered',    'Vendor-related breaches are the vendor\'s responsibility, not the entity\'s',    ],    correctAnswer: 1,    explanation: 'A 6-month breach with read-write access to the general ledger represents a potential integrity compromise of the entire financial reporting system during that period. The auditor must: (1) evaluate which data could have been modified, (2) perform data integrity testing comparing financial records to independent sources, (3) assess whether the breach constitutes a material weakness, (4) consider restatement implications, and (5) evaluate management\'s breach disclosure obligations.',    reference: 'NIST SP 800-61 - Incident Response',  },
  {
    id: 'isc-comp-024',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-data',
    topic: 'Data Management',
    subtopic: 'Data Lake vs Warehouse',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'A data lake differs from a data warehouse by:',
    options: [
      'Requiring less storage',
      'Being smaller',
      'Having faster queries',
      'Storing raw data in native format (schema-on-read) rather than structured, transformed data (schema-on-write)',
    ],
    correctAnswer: 3,
    explanation: 'Data lake: raw data, multiple formats, schema-on-read, flexible, good for data science/exploration. Data warehouse: structured, cleaned, schema-on-write, optimized for BI/reporting. Often used together (lakehouse architecture).',
    reference: 'Data Architecture - Lake vs Warehouse',
  },
  {
    id: 'isc-comp-025',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-automation',
    topic: 'Process Automation',
    subtopic: 'RPA Controls',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Analysis',
    question: 'Robotic Process Automation (RPA) introduces risks including:',
    options: [
      'Bot credentials management, change control, error handling, and process dependency',
      'Increased manual errors',
      'Lower efficiency',
      'Physical security only',
    ],
    correctAnswer: 0,
    explanation: 'RPA risks: credential/access management for bots, change control (process changes break bots), exception handling, governance, dependency on underlying systems, audit trail, segregation of duties around bot management.',
    reference: 'RPA Governance and Controls',
  },
];

