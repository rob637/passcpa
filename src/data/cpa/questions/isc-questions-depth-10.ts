/**
 * CPA ISC Section - Questions Depth Batch 10
 * Blueprint Area: ISC-I (Information Systems)
 * Topics: IT Operations, Physical Security, Capacity, Monitoring, Infrastructure
 */

import { Question } from '../../../types';

export const ISC_QUESTIONS_DEPTH_10: Question[] = [
  {
    id: 'isc-d10-001',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-physical',
    topic: 'Physical Security',
    subtopic: 'Data Center Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Physical security controls for a data center should include:',
    options: [
      'Only surveillance cameras',
      'Multiple layers of defense — perimeter barriers, biometric access controls, mantrap entries, visitor logs, environmental controls (fire suppression, HVAC, UPS, generators), and 24/7 monitoring',
      'A single locked door',
      'Employee self-service badge systems only',
    ],
    correctAnswer: 1,
    explanation: 'Data center physical security layers: (1) Perimeter — fencing, barriers, vehicle bollards, security guards, CCTV, (2) Building access — card access, visitor management, reception, (3) Data center floor — biometric access (fingerprint, retina), dual-factor authentication, mantrap/airlock entries, (4) Cabinet/rack level — locked cabinets, individual key management. Environmental controls: (1) Fire detection — smoke detectors, VESDA (Very Early Smoke Detection), (2) Fire suppression — clean agent (FM-200, Novec 1230), NOT water sprinklers for equipment areas, (3) HVAC — hot aisle/cold aisle containment, redundant cooling (N+1 or 2N), (4) Power — UPS (short-term battery backup), diesel generators (long-term), redundant power feeds, automatic transfer switches, (5) Water detection — leak sensors under raised floors. Monitoring: 24/7 NOC (Network Operations Center), environmental monitoring dashboards. CPA relevance: physical security controls protect financial data at rest; auditors inspect data centers during IT control assessments.',
    reference: 'NIST SP 800-53 PE; TIA-942',
  },
  {
    id: 'isc-d10-002',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-monitoring',
    topic: 'IT Monitoring',
    subtopic: 'SIEM Systems',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A Security Information and Event Management (SIEM) system supports financial reporting controls by:',
    options: [
      'Processing financial transactions',
      'Aggregating and correlating security event logs from across the IT environment — detecting threats, policy violations, and control failures in real-time, and providing centralized audit trails for compliance and forensic investigations',
      'Drafting financial statements',
      'Replacing firewall controls',
    ],
    correctAnswer: 1,
    explanation: 'SIEM capabilities: (1) Log aggregation — collects logs from servers, firewalls, applications, databases, endpoints, cloud services into a central repository, (2) Correlation — analyzes events across multiple sources to detect complex attack patterns (e.g., failed login on VPN followed by successful login from unusual location followed by database access), (3) Alerting — real-time notifications when security events match predefined rules or behavioral thresholds, (4) Dashboards — visual display of security posture, trends, incidents, (5) Forensics — searchable historical logs for incident investigation and root cause analysis, (6) Compliance reporting — pre-built reports for SOX, PCI DSS, HIPAA, GDPR. CPA/audit relevance: (1) SIEM provides evidence of monitoring controls (3rd line of defense), (2) Logs demonstrate access control enforcement, (3) SIEM alerts can detect unauthorized access to financial systems, (4) Incident response documentation supports control effectiveness assessment.',
    reference: 'NIST SP 800-92; SANS SIEM',
  },
  {
    id: 'isc-d10-003',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-itgc',
    topic: 'IT General Controls',
    subtopic: 'Logical Access — Privileged Accounts',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Privileged Access Management (PAM) controls are critical because:',
    options: [
      'Privileged accounts have limited system access',
      'Privileged accounts (admin, root, DBA, service accounts) have elevated access that can bypass normal controls — if compromised or misused, they can modify financial data, disable security controls, or access any information in the system',
      'Only developers need privileged access',
      'Privileged accounts are automatically monitored',
    ],
    correctAnswer: 1,
    explanation: 'PAM controls: (1) Least privilege — grant only the minimum privileges needed; avoid permanent admin rights, (2) Just-in-time (JIT) access — elevate privileges temporarily when needed, automatically revoke after use, (3) Privileged Session Management — record and monitor all privileged user sessions (screen recording, keystroke logging for admin sessions), (4) Password vaulting — store privileged credentials in an encrypted vault; users check out credentials for time-limited use, (5) Multi-factor authentication — require MFA for all privileged access, (6) Service account management — inventory, rotate passwords, and monitor all service/application accounts, (7) Periodic access review — regular recertification of who has privileged access and whether it\'s still justified. Key risks: (1) Insider threat — privileged users can bypass controls, (2) Credential theft — attackers target admin credentials, (3) Shadow IT — unknown service accounts. Audit: review PAM tool configuration, test JIT access, verify session recording, recertification evidence.',
    reference: 'CIS Controls; NIST 800-53 AC',
  },
  {
    id: 'isc-d10-004',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-controls',
    topic: 'Application Controls',
    subtopic: 'Configurable Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Configurable controls in a financial application (such as approval thresholds, tolerance limits, and system parameters) should be:',
    options: [
      'Set once and never reviewed',
      'Documented, restricted to authorized administrators, subject to change management procedures, and periodically reviewed to ensure they remain appropriate for current business requirements',
      'Available for all users to modify',
      'Set to the most permissive values possible',
    ],
    correctAnswer: 1,
    explanation: 'Configurable controls: system settings that define how the application enforces business rules. Examples: (1) Approval thresholds — dollar amount requiring manager, director, VP approval, (2) Tolerance limits — acceptable variances for automated matching (e.g., 3-way match within $5), (3) Account assignment rules — automatic GL posting rules, (4) Security parameters — password complexity, lockout settings, session timeout, (5) Report parameters — aging buckets, fiscal period definitions. Controls over configurations: (1) Documentation — maintain a register of all configurable settings and their authorized values, (2) Access restriction — only authorized administrators can modify settings (not end users), (3) Change management — changes follow formal procedures (request, approval, testing, documentation), (4) Audit trail — log all configuration changes (who, what, when, before/after values), (5) Periodic review — at least annually, verify settings remain appropriate. Audit approach: obtain configuration report, compare to authorized baseline, investigate any unauthorized changes.',
    reference: 'PCAOB AS 2201; ISACA',
  },
  {
    id: 'isc-d10-005',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Source Code Management',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Version control systems (e.g., Git) are important for financial application development because they:',
    options: [
      'Automatically fix bugs in code',
      'Provide a complete history of all code changes — who changed what, when, and why — enabling traceability, code review, rollback capability, and accountability for changes to financial reporting applications',
      'Eliminate the need for testing',
      'Generate financial reports automatically',
    ],
    correctAnswer: 1,
    explanation: 'Version control (source code management) controls: (1) Complete change history — every code change is recorded with: who made the change (attribution), when it was made (timestamp), what was changed (diff), why it was changed (commit message referencing a change request), (2) Branch management — developers work on feature branches; changes are merged to main/production branches through controlled processes, (3) Code review — pull request/merge request process requires peer review before code is merged, (4) Rollback — ability to revert to any previous version if a change causes issues, (5) Conflict resolution — manages concurrent changes by multiple developers, (6) Access controls — restrict who can merge to production branches. Security considerations: (1) Protect repository access (credentials, SSH keys), (2) Scan code for secrets (API keys, passwords accidentally committed), (3) Signed commits for non-repudiation, (4) Branch protection rules (prevent force pushes, require reviews). Audit evidence: commit logs support traceability of changes to financial applications.',
    reference: 'PCAOB AS 2201; ISACA',
  },
  {
    id: 'isc-d10-006',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-data-management',
    topic: 'Data Management',
    subtopic: 'ETL Processes',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'In ETL (Extract, Transform, Load) processes that feed financial reporting systems, the primary audit concern is:',
    options: [
      'The color of the ETL dashboard',
      'Data integrity throughout the pipeline — ensuring that data extracted from source systems is completely and accurately transformed and loaded into the target system, with reconciliation controls and error handling at each stage',
      'The brand of the ETL tool',
      'The speed of the network connection',
    ],
    correctAnswer: 1,
    explanation: 'ETL audit focus areas: Extract: (1) Source data completeness — verify all required data is extracted (date ranges, filters), (2) Timing — extraction occurs at the correct point (after source system close, before target needs data). Transform: (3) Business rules — transformation logic (calculations, mappings, conversions) matches business requirements, (4) Data quality checks — validation during transformation (format, reasonableness, referential integrity). Load: (5) Completeness — all transformed records loaded (record counts, control totals), (6) Accuracy — target data matches expected values, (7) Idempotency — re-running ETL doesn\'t create duplicates. Cross-cutting: (8) Error handling — rejected records logged, exception reports generated, resolution procedures defined, (9) Reconciliation — automated comparison of source and target totals, (10) Change management — ETL logic changes follow SDLC controls, (11) Scheduling and monitoring — automated monitoring with alerting for failures. Audit approach: trace transactions from source through transformation to target, verify reconciliation controls.',
    reference: 'ISACA Data Management; AICPA',
  },
  {
    id: 'isc-d10-007',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-it-governance',
    topic: 'IT Governance',
    subtopic: 'IT Regulatory Compliance',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'IT compliance frameworks relevant to organizations processing financial data include:',
    options: [
      'Only FDA regulations',
      'SOX (financial reporting controls), PCI DSS (payment card data), GDPR/CCPA (privacy), HIPAA (healthcare data), and SOC reporting standards — each imposing specific IT control requirements',
      'Only building fire codes',
      'Only environmental regulations',
    ],
    correctAnswer: 1,
    explanation: 'Key IT compliance frameworks: (1) SOX — Section 404: IT controls over financial reporting (ITGCs + application controls), (2) PCI DSS — 12 requirements for protecting payment card data, (3) GDPR — EU data protection: consent, data minimization, right to erasure, breach notification (72 hours), DPO requirement, fines up to 4% of global revenue, (4) CCPA/CPRA — California privacy: consumer rights over personal information, (5) HIPAA — healthcare: security rule (administrative, physical, technical safeguards), breach notification, (6) GLBA — financial services: Safeguards Rule for customer financial information, (7) SOC 1/2/3 — service organizations: control attestation reports, (8) FISMA — federal government systems. Overlap: many controls address multiple frameworks (access controls, encryption, logging, change management). GRC tools: automate compliance management across multiple frameworks. CPA relevance: CPAs must understand IT compliance requirements to assess control environments properly.',
    reference: 'SOX; PCI DSS; GDPR; HIPAA',
  },
  {
    id: 'isc-d10-008',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-network',
    topic: 'Network Architecture',
    subtopic: 'Intrusion Detection and Prevention',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An Intrusion Prevention System (IPS) differs from an Intrusion Detection System (IDS) in that the IPS:',
    options: [
      'Only generates alerts',
      'Actively blocks malicious traffic in real-time (inline with network traffic) rather than just detecting and alerting — the IPS can drop malicious packets, reset connections, or block offending IP addresses automatically',
      'Only works on wireless networks',
      'Only monitors email traffic',
    ],
    correctAnswer: 1,
    explanation: 'IDS vs IPS: IDS (Intrusion Detection System): passive — monitors network traffic or system events, generates alerts when suspicious activity is detected, but does NOT block traffic. Deployed as a tap/span port (sees copy of traffic). IPS (Intrusion Prevention System): active — deployed inline (traffic flows through it), inspects and can block/modify malicious traffic in real-time. Types: (1) Network-based (NIDS/NIPS): monitors network traffic at strategic points, (2) Host-based (HIDS/HIPS): monitors individual host activity (file changes, process activity, registry changes). Detection methods: (1) Signature-based: matches known attack patterns (effective for known threats, misses zero-days), (2) Anomaly-based: establishes baseline of normal behavior, alerts on deviations (catches unknown threats, higher false positives), (3) Behavioral/heuristic: analyzes behavior patterns to identify malicious intent. CPA relevance: IDS/IPS are detective/preventive controls supporting security monitoring, often required by PCI DSS, NIST.',
    reference: 'NIST SP 800-94; CIS Controls',
  },
  {
    id: 'isc-d10-009',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-continuity',
    topic: 'Business Continuity',
    subtopic: 'BCP Testing Methods',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'The MOST rigorous method of testing a business continuity plan (BCP) is:',
    options: [
      'A checklist review',
      'A full interruption test — where the organization actually switches operations to the recovery site, simulating a real disaster to verify that the recovery procedures and alternative facilities can fully support operations',
      'A tabletop exercise',
      'A structured walkthrough',
    ],
    correctAnswer: 1,
    explanation: 'BCP/DRP testing types (least to most rigorous): (1) Checklist review — team reviews the plan document for completeness and accuracy (desk review), (2) Structured walkthrough/tabletop — team discusses the plan step by step in a meeting setting, identifies gaps through discussion, (3) Simulation — team practices response to a simulated scenario without actually activating recovery procedures, (4) Parallel test — recovery site is activated and processes are run, but the primary site continues operations simultaneously (no actual switchover), (5) Full interruption test — primary site is actually shut down, all operations switch to recovery site (most realistic, most risky). Best practices: (1) Test at least annually, (2) Use a mix of testing methods (tabletop quarterly, parallel annually), (3) Include key personnel and vendors, (4) Document results and remediate gaps, (5) Update the plan based on test findings. CPA relevance: auditors assess whether BCP/DRP has been tested and whether financial systems can be recovered within RTO/RPO.',
    reference: 'ISO 22301; NIST SP 800-34',
  },
  {
    id: 'isc-d10-010',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-systems',
    topic: 'Enterprise Systems',
    subtopic: 'E-Commerce Systems',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'E-commerce systems processing online transactions require specific controls including:',
    options: [
      'No security controls since transactions are automated',
      'TLS encryption for data in transit, PCI DSS compliance for payment processing, authentication controls, session management, input validation, and real-time fraud detection mechanisms',
      'Only physical security controls',
      'Only antivirus software',
    ],
    correctAnswer: 1,
    explanation: 'E-commerce security controls: (1) Encryption — TLS 1.2+ for all data in transit (HTTPS), encrypt sensitive data at rest (customer PII, payment data), (2) Authentication — secure login (MFA for customer accounts, strong password policies), OAuth/OIDC for third-party integrations, (3) Session management — secure session tokens, timeout, CSRF protection, (4) Input validation — prevent SQL injection, XSS, command injection on all user inputs, (5) Payment security — PCI DSS compliance, tokenization, 3D Secure authentication, (6) Fraud detection — real-time transaction monitoring (velocity checks, geolocation, device fingerprinting, ML-based fraud scoring), (7) Privacy — cookie consent, GDPR/CCPA compliance for customer data, (8) Availability — DDoS protection, CDN, load balancing, (9) Non-repudiation — digital signatures, audit trails for orders and payments. CPA relevance: revenue recognition for online sales, proper recording of refunds/chargebacks, completeness of transaction capture.',
    reference: 'PCI DSS; OWASP; NIST',
  },
  {
    id: 'isc-d10-011',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-data-analytics',
    topic: 'Data Analytics',
    subtopic: 'Data Visualization Best Practices',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Effective data visualization for financial reporting should:',
    options: [
      'Use as many colors and chart types as possible',
      'Present data clearly and accurately — using appropriate chart types for the data being shown, avoiding misleading scales or truncated axes, and highlighting key takeaways that support decision-making',
      'Only use text-based tables',
      'Be created without considering the audience',
    ],
    correctAnswer: 1,
    explanation: 'Data visualization principles: (1) Choose appropriate chart types: Bar charts — comparing categories, Line charts — trends over time, Pie charts — composition/proportion (use sparingly, max 5-6 slices), Scatter plots — relationships between variables, Heat maps — density/intensity, Waterfall charts — cumulative effect of positive/negative values. (2) Avoid misleading practices: Don\'t truncate Y-axis (makes small differences look large), Use consistent scales, Avoid 3D charts (distort perception), Label axes and include units. (3) Design principles: Minimize chart junk (unnecessary decoration), Use color purposefully (highlight important data), Ensure accessibility (color-blind-friendly palettes), Keep it simple — "data-ink ratio" (maximize data, minimize ink). (4) Context: Include titles, subtitles, annotations, Provide comparison benchmarks, Include source and date references. CPA relevance: financial dashboards, variance analysis reports, audit findings presentations must communicate accurately to stakeholders.',
    reference: 'AICPA; Tufte Data Visualization',
  },
  {
    id: 'isc-d10-012',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-itgc',
    topic: 'IT General Controls',
    subtopic: 'Patch Management',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An effective patch management program requires:',
    options: [
      'Installing all patches immediately without testing',
      'A systematic process of identifying, evaluating, testing, and deploying patches in a timely manner — prioritized by risk (critical vulnerabilities patched first), tested in non-production before deployment, with rollback procedures and documentation',
      'Ignoring patches until a breach occurs',
      'Only patching servers once per year',
    ],
    correctAnswer: 1,
    explanation: 'Patch management process: (1) Inventory — maintain accurate inventory of all IT assets (servers, endpoints, applications, OS versions), (2) Monitoring — subscribe to vendor advisories, CVE databases, threat intelligence feeds for new vulnerabilities, (3) Assessment — evaluate each patch: severity (CVSS score), applicability, business impact, (4) Prioritization — critical/high vulnerabilities exploited in the wild → immediate action; low severity → standard cycle, (5) Testing — deploy to test/staging environment first; verify no compatibility issues with business applications, (6) Deployment — staged rollout (pilot group → broader deployment), (7) Verification — confirm patches were successfully applied (scan for missing patches), (8) Documentation — record what was patched, when, and testing results, (9) Exceptions — document any systems that cannot be patched (with compensating controls), (10) Emergency patching — expedited process for critical zero-day vulnerabilities. Compliance: PCI DSS requires critical patches within 30 days of release.',
    reference: 'NIST SP 800-40; CIS Controls',
  },
  {
    id: 'isc-d10-013',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-audit',
    topic: 'IT Audit Techniques',
    subtopic: 'Vulnerability Assessment vs Penetration Testing',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A penetration test differs from a vulnerability assessment in that:',
    options: [
      'A vulnerability assessment is more invasive',
      'A penetration test actively attempts to exploit identified vulnerabilities to determine the real-world impact — simulating an actual attack, while a vulnerability assessment only identifies and classifies vulnerabilities without exploitation',
      'They are exactly the same thing',
      'A vulnerability assessment requires no tools',
    ],
    correctAnswer: 1,
    explanation: 'Vulnerability Assessment (VA): (1) Identifies known vulnerabilities (scanning), (2) Classifies severity (CVSS scores), (3) Produces a prioritized list of vulnerabilities, (4) Does NOT attempt exploitation, (5) Lower risk to operations, (6) Broader coverage (scans everything). Penetration Testing (PT): (1) Actively exploits vulnerabilities (with permission), (2) Determines actual impact (can an attacker access sensitive data, gain admin access?), (3) Tests defense-in-depth (can exploitation of one vulnerability lead to further compromise?), (4) Types: black box (no prior knowledge), gray box (some knowledge), white box (full knowledge), (5) Scope: external (internet-facing), internal (inside the network), application-level. Compliance requirements: PCI DSS requires both annual PT and quarterly VA scans. SOX — vulnerability management supports ITGC assessment. PT methodology: OWASP Testing Guide, PTES, NIST SP 800-115. Key: PT requires written authorization (rules of engagement), skilled testers, defined scope to avoid disruption.',
    reference: 'NIST SP 800-115; PCI DSS; OWASP',
  },
  {
    id: 'isc-d10-014',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-controls',
    topic: 'Application Controls',
    subtopic: 'Exception Reporting',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Exception reports in a financial system are designed to:',
    options: [
      'List all transactions processed during the day',
      'Identify and flag transactions or conditions that deviate from normal parameters or predefined rules — such as unusual amounts, duplicate entries, missing approvals, or SoD violations — for management investigation and resolution',
      'Replace all other controls',
      'Automatically correct all errors',
    ],
    correctAnswer: 1,
    explanation: 'Exception reports (detective controls): Types: (1) Threshold exceptions — transactions exceeding dollar thresholds (e.g., journal entries > $100K), (2) Duplicate detection — potential duplicate invoices, payments, or transactions, (3) Missing controls — transactions without required approvals, unsigned documents, (4) SoD violations — transactions where the same person performed conflicting duties, (5) Dormant account activity — transactions on inactive accounts, (6) Aging exceptions — past-due items, stale reconciling items, (7) Negative or zero balances — unexpected balance conditions, (8) Manual journal entry reports — all manual entries for management review. Effectiveness depends on: (1) Appropriate thresholds and criteria (not too broad or narrow), (2) Timely generation and distribution, (3) Management review and follow-up (documented investigation and resolution), (4) Root cause analysis for recurring exceptions. Audit approach: verify exception reports are generated, review evidence of management investigation and resolution, assess whether criteria are appropriate.',
    reference: 'COSO; PCAOB AS 2201',
  },
  {
    id: 'isc-d10-015',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Quantum Computing Impact',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Quantum computing poses a significant risk to current information security because:',
    options: [
      'Quantum computers are already widely deployed',
      'Sufficiently powerful quantum computers could break widely used encryption algorithms (RSA, ECC, Diffie-Hellman) that protect financial data, communications, and digital signatures — requiring organizations to plan for post-quantum cryptography migration',
      'Quantum computers will make all software obsolete',
      'Quantum computers only affect gaming applications',
    ],
    correctAnswer: 1,
    explanation: 'Quantum computing security impact: Current encryption at risk: (1) RSA — public-key cryptography; Shor\'s algorithm on a quantum computer could factor large numbers efficiently, breaking RSA, (2) ECC (Elliptic Curve Cryptography) — similarly vulnerable to Shor\'s algorithm, (3) Diffie-Hellman key exchange — also based on problems quantum computers could solve. NOT at risk (reduced but not broken): symmetric encryption (AES) — Grover\'s algorithm provides quadratic speedup (AES-256 → effective 128-bit security), so doubling key sizes is sufficient. Post-quantum cryptography (PQC): NIST has standardized PQC algorithms: (1) CRYSTALS-Kyber (ML-KEM) for key encapsulation, (2) CRYSTALS-Dilithium, FALCON, SPHINCS+ for digital signatures. "Harvest now, decrypt later" threat: adversaries may collect encrypted data today, planning to decrypt when quantum computers are available. Organizations should: (1) Inventory cryptographic assets, (2) Assess quantum risk, (3) Plan migration to PQC algorithms, (4) Implement crypto-agility (ability to swap algorithms). CPA relevance: encryption protects financial data — quantum risks must be considered in long-term security planning.',
    reference: 'NIST PQC; CISA Quantum Guidance',
  },
  {
    id: 'isc-d10-016',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-it-governance',
    topic: 'IT Governance',
    subtopic: 'Technology Refresh Planning',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Technology refresh planning ensures that:',
    options: [
      'The organization never upgrades technology',
      'Hardware and software are replaced or upgraded before they reach end of life — preventing security vulnerabilities from unpatched systems, ensuring vendor support availability, and maintaining compatibility with business requirements',
      'All technology is replaced every month',
      'Only the cheapest technology is purchased',
    ],
    correctAnswer: 1,
    explanation: 'Technology refresh planning: (1) Asset lifecycle management — track when hardware and software reach end-of-sale, end-of-support, and end-of-life dates, (2) Risk assessment — unsupported systems are high-risk (no security patches, no vendor support for issues), (3) Budget planning — multi-year capital expenditure planning for replacements, (4) Prioritization — critical financial systems first, based on risk and business impact, (5) Migration planning — including data migration, testing, training, and rollback procedures, (6) Vendor management — evaluate new products, negotiate contracts, assess vendor stability. Key milestones: (1) End of Sale — vendor stops selling the product (may still support existing installations), (2) End of Support (EOS) — vendor stops providing patches and support (CRITICAL — security risk begins), (3) End of Extended Support — premium support expires, no patches at any cost. CPA relevance: running financial systems on unsupported technology is a control deficiency; auditors should evaluate technology refresh plans.',
    reference: 'COBIT BAI; ITIL',
  },
  {
    id: 'isc-d10-017',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-systems',
    topic: 'Enterprise Systems',
    subtopic: 'General Ledger System Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Key controls in a General Ledger (GL) system include:',
    options: [
      'Only password protection',
      'Automated journal entry validation (balanced debits/credits), restricted access to the chart of accounts, period-end closing procedures, trial balance reconciliation, and management review of manual journal entries',
      'Printing all journal entries daily',
      'Only quarterly reviews',
    ],
    correctAnswer: 1,
    explanation: 'GL system controls: Preventive: (1) Journal entry validation — system enforces balanced debits and credits (reject unbalanced entries), (2) Chart of accounts controls — restrict ability to create/modify GL accounts to authorized personnel, (3) Access controls — segregate who can create, post, and approve journal entries, (4) Automated posting — subledger-to-GL posting is automated (AP, AR, payroll → GL reducing manual entry risk), (5) Period management — restrict posting to correct periods; close completed periods. Detective: (6) Manual journal entry review — management reviews all manual entries (especially large, unusual, adjusting, and year-end entries), (7) Trial balance — automated generation and review, (8) Account reconciliation — periodic reconciliation of GL accounts to supporting detail, (9) Variance analysis — compare actual to budget, investigate significant variances. Monitoring: (10) Audit trail — complete log of all entries, modifications, and deletions. CPA relevance: GL is the foundation of financial statements — GL controls directly affect financial reporting assertions.',
    reference: 'PCAOB AS 2201; COSO',
  },
  {
    id: 'isc-d10-018',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-data-management',
    topic: 'Data Management',
    subtopic: 'Data Lineage and Provenance',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Data lineage in financial systems refers to:',
    options: [
      'The age of the data',
      'The ability to trace data from its origin through all transformations and movements to its final destination — providing transparency into how financial data is collected, processed, aggregated, and reported',
      'The size of the database',
      'The number of database users',
    ],
    correctAnswer: 1,
    explanation: 'Data lineage: tracking data flow from source to destination. Components: (1) Source — where data originates (transaction systems, external feeds, manual entry), (2) Transformations — how data is modified (calculations, aggregations, mappings, currency conversion), (3) Movements — where data passes through (ETL, interfaces, staging databases), (4) Destination — final resting place (data warehouse, reports, financial statements). Benefits: (1) Audit trail — auditors can trace a financial statement number back to source transactions, (2) Impact analysis — understand which downstream reports are affected by a data change, (3) Root cause analysis — when data issues occur, trace back to find the source of error, (4) Regulatory compliance — demonstrate data flow for SOX, GDPR (data subject rights require knowing where personal data flows). Tools: metadata management platforms, data cataloges, ETL tool documentation. CPA relevance: data lineage supports audit procedures (tracing amounts from financial statements to source documents and vice versa) and is critical for evaluating data reliability.',
    reference: 'DAMA DMBOK; AICPA',
  },
  {
    id: 'isc-d10-019',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-network',
    topic: 'Network Architecture',
    subtopic: 'Content Delivery Networks',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'A Content Delivery Network (CDN) improves application performance by:',
    options: [
      'Deleting old content automatically',
      'Distributing content across geographically dispersed edge servers — serving users from the nearest server to reduce latency, improve load times, and provide protection against DDoS attacks through traffic distribution',
      'Compressing all files to the smallest possible size',
      'Limiting the number of users who can access an application',
    ],
    correctAnswer: 1,
    explanation: 'CDN benefits: (1) Performance — serve static content (images, CSS, JavaScript, videos) from edge servers closest to users, reducing latency and improving page load times, (2) Scalability — handle traffic spikes without overloading origin servers, (3) Availability — if one edge server fails, traffic is automatically routed to the next closest server, (4) DDoS protection — large CDN networks can absorb volumetric DDoS attacks by distributing traffic across many edge servers, (5) SSL/TLS termination — CDN handles encryption/decryption at the edge, reducing origin server load. Major CDN providers: Cloudflare, Akamai, AWS CloudFront, Azure CDN. Security considerations: (1) SSL/TLS certificate management, (2) Cache poisoning prevention, (3) Origin server protection (restrict direct access), (4) DDoS mitigation features. CPA relevance: CDN reliability affects availability of web-based financial applications (customer portals, investor relations, online banking).',
    reference: 'NIST; CDN Architecture',
  },
  {
    id: 'isc-d10-020',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-controls',
    topic: 'Application Controls',
    subtopic: 'Reconciliation Automation',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Automated account reconciliation tools improve internal controls by:',
    options: [
      'Eliminating the need for any reconciliation',
      'Systematically matching transactions between systems, identifying discrepancies, aging unresolved items, providing workflow for investigation, and creating a complete audit trail — reducing manual effort and improving timeliness of reconciliation completion',
      'Only generating PDF reports',
      'Automatically hiding discrepancies',
    ],
    correctAnswer: 1,
    explanation: 'Automated reconciliation: (1) Transaction matching — automatically match transactions between: GL and bank statements, subledgers and GL, intercompany accounts, AP/AR and third-party confirmations. (2) Rule-based matching — configure matching rules: exact match, tolerance-based, many-to-one, one-to-many, (3) Exception management — unmatched items are routed to appropriate personnel for investigation via workflow, (4) Aging — track how long reconciling items remain open (escalate aging items), (5) Certification — reconciliation sign-off by preparers and reviewers, (6) Audit trail — complete history of matching, exceptions, investigation notes, and resolution, (7) Dashboards — management visibility into reconciliation status across all accounts. Benefits: (1) Faster close — reconciliations completed sooner, (2) Better coverage — more accounts reconciled (not just high-risk), (3) Earlier issue identification, (4) Consistent process. Tools: BlackLine, Trintech, OneStream. CPA relevance: reconciliation is a key detective control — automation improves both efficiency and effectiveness.',
    reference: 'COSO; AICPA',
  },
  {
    id: 'isc-d10-021',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-itgc',
    topic: 'IT General Controls',
    subtopic: 'User Access Provisioning',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'User access provisioning controls should include:',
    options: [
      'Granting all new employees full system access',
      'A formal request and approval process — access is granted based on job role (RBAC), approved by the user\'s manager and system owner, documented, and subject to periodic recertification to ensure continued appropriateness',
      'Only revoking access when employees retire',
      'Allowing users to self-provision access',
    ],
    correctAnswer: 1,
    explanation: 'Access provisioning lifecycle: (1) Onboarding — formal request: new employee\'s manager requests access based on job role, system owner approves, IT provisions per approved request. RBAC — Role-Based Access Control: access rights assigned to roles, users assigned to roles (not individual permissions). (2) Transfers — when employee changes roles: old role\'s access is promptly removed, new role\'s access is provisioned. Risk: "role creep" — accumulation of access rights from multiple roles without removing old ones. (3) Termination — immediate revocation of all access (same day for involuntary terminations, planned date for voluntary). Integrate with HR process. Disable accounts, don\'t just remove from groups. (4) Periodic recertification — managers and system owners review access lists (quarterly or semiannually), confirm continued need, revoke unnecessary access. (5) Documentation — maintain records of all access requests, approvals, and changes. Audit approach: test new hires (proper approval), test terminations (timely revocation), test access recertification (evidence of review and action).',
    reference: 'PCAOB AS 2201; NIST 800-53 AC',
  },
  {
    id: 'isc-d10-022',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Low-Code/No-Code Platforms',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Low-code/no-code development platforms present governance challenges because:',
    options: [
      'They are too expensive for organizations to use',
      'Business users can create applications without IT oversight — potentially creating "shadow IT" applications that may lack proper security controls, change management, data governance, and integration with enterprise systems',
      'They cannot create functional applications',
      'They only work on mobile devices',
    ],
    correctAnswer: 1,
    explanation: 'Low-code/no-code risks: (1) Shadow IT — business users build applications without IT knowledge, creating ungoverned systems, (2) Security gaps — citizen-developed apps may lack proper authentication, authorization, encryption, and input validation, (3) Data governance — apps may access sensitive data without proper controls, create unauthorized data stores, or violate data privacy regulations, (4) Change management — no formal SDLC process for changes to these applications, (5) Integration risks — apps connecting to enterprise systems via unsecured APIs, (6) Scalability — apps built for small use cases may be adopted more broadly without adequate architecture, (7) Vendor dependency — strong lock-in with platform vendors. Governance approach: (1) Acceptable use policy for low-code/no-code platforms, (2) Register all citizen-developed apps, (3) Risk classification — determine which apps handle sensitive data or support financial processes, (4) IT oversight for higher-risk applications, (5) Security standards that platform-built apps must meet, (6) Training for citizen developers on security basics.',
    reference: 'Gartner; ISACA',
  },
  {
    id: 'isc-d10-023',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-audit',
    topic: 'IT Audit Techniques',
    subtopic: 'Audit of Automated Controls',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'When auditing automated (programmed) application controls, the auditor should:',
    options: [
      'Test only at year-end',
      'First evaluate the effectiveness of related ITGCs (access, change management) — if ITGCs are effective, the automated control can be tested once ("benchmark testing") and relied upon for the entire period; if ITGCs are weak, the auditor cannot rely on the automated control operating consistently',
      'Never test automated controls',
      'Accept the control without testing',
    ],
    correctAnswer: 1,
    explanation: 'Auditing automated controls (PCAOB AS 2201): (1) ITGC dependency — automated controls depend on ITGCs for their continued effectiveness. If someone could change the program code or access data without authorization, the automated control may not be reliable. (2) Benchmark testing (if ITGCs effective): test the control once, confirm it produces expected results; since the program hasn\'t changed (change management ITGCs are effective) and unauthorized access is prevented (access ITGCs are effective), the control is presumed to have operated consistently all period. (3) One-time testing: verify the control logic produces the correct result (e.g., test that the three-way matching tolerance is properly configured, test that journals must balance before posting). (4) If ITGCs are NOT effective: auditor must either (a) test the automated control throughout the period (quarterly, monthly) to verify it hasn\'t been altered, or (b) cannot rely on the control and must perform additional substantive procedures. Key insight: ITGCs are the foundation — they must be evaluated BEFORE relying on any automated control.',
    reference: 'PCAOB AS 2201; AICPA',
  },
  {
    id: 'isc-d10-024',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-it-governance',
    topic: 'IT Governance',
    subtopic: 'Three Lines Model',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'The Three Lines Model (formerly Three Lines of Defense) assigns IT risk management responsibilities as follows:',
    options: [
      'Only external auditors manage all three lines',
      'First Line: operational management owns and manages risks (IT operations, developers); Second Line: risk management and compliance functions provide oversight, frameworks, and monitoring; Third Line: internal audit provides independent assurance',
      'All three lines are performed by the same team',
      'The board of directors performs all three lines',
    ],
    correctAnswer: 1,
    explanation: 'Three Lines Model (IIA 2020 update): First Line — Management: (1) Owns and manages risk, (2) Implements controls, (3) Executes processes, (4) In IT: IT operations, development teams, system administrators, security operations. Second Line — Risk Management/Compliance: (1) Provides frameworks, standards, and policies, (2) Monitors and reports on risk, (3) Provides expertise and guidance, (4) In IT: CISO office, IT risk management, compliance, quality assurance. Third Line — Internal Audit: (1) Independent and objective assurance, (2) Reports to the board/audit committee, (3) Evaluates effectiveness of first and second lines, (4) In IT: IT audit, third-party assessments. Governing body (board): sets direction, maintains accountability, oversees all three lines. Key principle: first line must own risk — second and third lines cannot substitute for first-line responsibility. CPA relevance: understanding the three lines helps auditors assess the adequacy of the overall IT control environment.',
    reference: 'IIA Three Lines Model 2020',
  },
  {
    id: 'isc-d10-025',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-databases',
    topic: 'Database Management',
    subtopic: 'Database Backup and Recovery',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'For financial databases, the most appropriate backup and recovery strategy is:',
    options: [
      'Weekly full backups only',
      'Transaction log backups combined with regular full and differential backups — enabling point-in-time recovery to restore the database to any moment before a failure or data corruption occurred',
      'No backups, since data is in the cloud',
      'Manual data re-entry from paper records',
    ],
    correctAnswer: 1,
    explanation: 'Database backup strategy for financial systems: (1) Full database backups — complete copy of the entire database (weekly or daily depending on size), (2) Differential backups — changes since last full backup (daily), (3) Transaction log backups — capture all transactions since last log backup (every 15-60 minutes for financial systems). Why transaction log backups matter: (1) Point-in-time recovery — can restore to any specific moment (e.g., right before accidental data deletion at 2:47 PM), (2) Minimal data loss — RPO of minutes rather than hours/days, (3) Recovery process: Restore last full → Apply latest differential → Apply transaction logs up to desired point in time. Additional practices: (1) Test restores regularly (at least quarterly), (2) Store backups offsite/in different region, (3) Encrypt backups (financial data protection), (4) Retention — keep backups according to retention policy, (5) Backup monitoring — automated alerts for backup failures. CPA relevance: backup integrity directly affects ability to recover financial data after incidents; auditors test backup procedures and verify successful test restores.',
    reference: 'NIST SP 800-34; SQL Server/Oracle Backup Best Practices',
  },
];
