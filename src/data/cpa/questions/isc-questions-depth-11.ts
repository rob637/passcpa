/**
 * CPA ISC Section - Questions Depth Batch 11
 * Blueprint Area: ISC-II (Security, Confidentiality, and Privacy)
 * Topics: Cybersecurity Frameworks, Access Controls, Encryption, Authentication
 */

import { Question } from '../../../types';

export const ISC_QUESTIONS_DEPTH_11: Question[] = [
  {
    id: 'isc-d11-001',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Cybersecurity Frameworks',
    subtopic: 'NIST Cybersecurity Framework',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'The NIST Cybersecurity Framework (CSF) 2.0 organizes cybersecurity activities into six core functions. Which answer correctly identifies all six?',
    options: [
      'Plan, Build, Test, Deploy, Monitor, Retire',
      'Govern, Identify, Protect, Detect, Respond, Recover',
      'Prevent, Detect, Correct, Compensate, Monitor, Report',
      'Assess, Authorize, Implement, Verify, Maintain, Decommission',
    ],
    correctAnswer: 1,
    explanation: 'NIST CSF 2.0 (2024 update, added Govern) six core functions: (1) Govern (GV) — establish and monitor the organization\'s cybersecurity risk management strategy, expectations, and policy, (2) Identify (ID) — understand the organization\'s assets, business environment, risks, and vulnerabilities, (3) Protect (PR) — implement safeguards to ensure delivery of critical services, (4) Detect (DE) — develop and implement activities to identify cybersecurity events, (5) Respond (RS) — take action regarding a detected cybersecurity event, (6) Recover (RC) — maintain plans for resilience and restore capabilities impaired during an event. Each function has categories and subcategories with informative references. CPA relevance: understanding cybersecurity frameworks helps CPAs assess IT control environments and evaluate management\'s cybersecurity risk management program; AICPA SOC for Cybersecurity uses similar constructs.',
    reference: 'NIST CSF 2.0, 2024',
  },
  {
    id: 'isc-d11-002',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Cybersecurity Frameworks',
    subtopic: 'ISO 27001 ISMS',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An organization implementing ISO 27001 must establish an Information Security Management System (ISMS) that includes:',
    options: [
      'Only technical security controls',
      'A risk assessment process, Statement of Applicability (SoA) mapping controls to identified risks, documented policies and procedures, management commitment, internal audits, and a continuous improvement cycle (Plan-Do-Check-Act)',
      'Only purchasing security software',
      'Only training employees on passwords',
    ],
    correctAnswer: 1,
    explanation: 'ISO 27001 ISMS requirements: (1) Context — understand the organization\'s context, interested parties, and scope of the ISMS, (2) Leadership — top management commitment, security policy, roles and responsibilities, (3) Planning — risk assessment and risk treatment methodology, Statement of Applicability (SoA) — maps which of the 93 Annex A controls (ISO 27001:2022) are applicable and justified, (4) Support — resources, competence, awareness, communication, documented information, (5) Operation — implement risk treatment plans and controls, (6) Performance evaluation — monitoring, internal audit, management review, (7) Improvement — nonconformity management, corrective actions, continual improvement. PDCA cycle: Plan (establish ISMS), Do (implement), Check (monitor/audit), Act (improve). ISO 27001 is certifiable — organizations can obtain third-party certification. CPA relevance: ISO 27001 certification demonstrates a mature security program; evaluating ISMS scope and certification is relevant for assessing control environments of service organizations.',
    reference: 'ISO/IEC 27001:2022',
  },
  {
    id: 'isc-d11-003',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-crypto',
    topic: 'Encryption and Cryptography',
    subtopic: 'Symmetric vs Asymmetric Encryption',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'The key difference between symmetric and asymmetric encryption is:',
    options: [
      'Symmetric encryption uses more keys',
      'Symmetric encryption uses a single shared key for both encryption and decryption (fast, used for bulk data), while asymmetric encryption uses a key pair (public and private) where data encrypted with one key can only be decrypted by the other (slower, used for key exchange and digital signatures)',
      'Asymmetric encryption is always faster',
      'They are identical in functionality',
    ],
    correctAnswer: 1,
    explanation: 'Symmetric encryption: (1) Single key — same key encrypts and decrypts, (2) Fast — efficient for large data volumes, (3) Algorithms: AES (128/192/256-bit — current standard), 3DES (legacy, deprecated), ChaCha20, (4) Challenge: key distribution — how to securely share the key with the recipient, (5) Use: data-at-rest encryption, database encryption, VPN tunnel encryption. Asymmetric encryption: (1) Key pair — public key (shared openly) + private key (kept secret), (2) Data encrypted with public key → only private key can decrypt, (3) Slower than symmetric (1000x), not practical for bulk data, (4) Algorithms: RSA (2048/4096-bit), ECC (Elliptic Curve), (5) Uses: key exchange (safely share symmetric keys), digital signatures (sign with private key, verify with public key), TLS handshake, PKI certificates. In practice (hybrid): TLS/HTTPS uses asymmetric encryption to exchange a symmetric session key, then symmetric encryption for the actual data transfer (best of both worlds).',
    reference: 'NIST SP 800-175B; NIST FIPS 197',
  },
  {
    id: 'isc-d11-004',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-crypto',
    topic: 'Encryption and Cryptography',
    subtopic: 'Hashing and Digital Signatures',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A digital signature provides assurance of:',
    options: [
      'Only confidentiality',
      'Authentication (confirms the signer\'s identity), integrity (proves the message has not been altered), and non-repudiation (the signer cannot deny having signed) — achieved by hashing the message and encrypting the hash with the signer\'s private key',
      'Only availability',
      'Only performance',
    ],
    correctAnswer: 1,
    explanation: 'Digital signature process: Signing: (1) Hash the document/message using a cryptographic hash function (SHA-256, SHA-384, SHA-512) — produces a fixed-size digest, (2) Encrypt the hash with the signer\'s private key — this is the digital signature, (3) Send the document + digital signature to the recipient. Verification: (4) Recipient decrypts the signature using the signer\'s public key — obtains the original hash, (5) Recipient independently hashes the received document, (6) Compare the two hashes — if they match: authentication confirmed (only the private key holder could have created the signature), integrity confirmed (document hasn\'t been altered), non-repudiation (signer cannot deny signing). PKI infrastructure: (1) Certificate Authority (CA) issues digital certificates binding public keys to identities, (2) Certificate chain of trust: Root CA → Intermediate CA → End entity certificate, (3) Certificate revocation: CRL (Certificate Revocation List) or OCSP (Online Certificate Status Protocol). CPA relevance: digital signatures on financial documents, e-filing with IRS, SOC reports.',
    reference: 'NIST SP 800-89; FIPS 186-5',
  },
  {
    id: 'isc-d11-005',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-access',
    topic: 'Access Control Models',
    subtopic: 'RBAC vs ABAC vs MAC vs DAC',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Role-Based Access Control (RBAC) is preferred for financial systems because:',
    options: [
      'It gives all users the same access',
      'Access permissions are assigned to defined roles (e.g., AP Clerk, Controller, Auditor) rather than individual users — simplifying administration, supporting least privilege, facilitating segregation of duties enforcement, and making access reviews more manageable',
      'It is the least secure model',
      'It requires no administration',
    ],
    correctAnswer: 1,
    explanation: 'Access control models: (1) DAC (Discretionary) — owners control access to their resources; flexible but risky (users can share access), (2) MAC (Mandatory) — system enforces access based on security labels/classifications; government/military use (Top Secret, Secret, Confidential), (3) RBAC (Role-Based) — access assigned to roles, users assigned to roles; most common in enterprise environments. RBAC benefits: simplified administration (manage roles not individuals), supports SoD (define conflicting roles), scalable (new employees assigned to existing roles), audit-friendly (review roles and role assignments). RBAC implementation: define roles based on job functions, assign minimum necessary permissions to each role, assign users to roles, review role definitions and assignments periodically. (4) ABAC (Attribute-Based) — decisions based on attributes of user, resource, and environment (location, time, device, classification). More granular but more complex. Example RBAC in AP: AP Clerk role (create invoices, enter data), AP Supervisor role (approve invoices > $5K), AP Manager role (approve invoices > $50K, modify vendor master). Conflicting role: AP Clerk cannot also have Vendor Master maintenance role (SoD).',
    reference: 'NIST SP 800-162; NIST RBAC',
  },
  {
    id: 'isc-d11-006',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-access',
    topic: 'Access Controls',
    subtopic: 'Multi-Factor Authentication',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Multi-factor authentication (MFA) requires authentication from at least two of which categories?',
    options: [
      'Two different passwords',
      'Something you know (password/PIN), something you have (token/phone/smart card), and something you are (biometrics — fingerprint, face, retina)',
      'Two different usernames',
      'A password and a security question',
    ],
    correctAnswer: 1,
    explanation: 'Authentication factors: (1) Something you know — passwords, PINs, security questions (knowledge factor), (2) Something you have — hardware tokens (RSA SecurID), software tokens (Google Authenticator, Microsoft Authenticator), smart cards, mobile phone (SMS, push notification), FIDO2 security keys (YubiKey), (3) Something you are — biometrics: fingerprint, facial recognition, retinal/iris scan, voice recognition, (4) Somewhere you are — geolocation, IP address (sometimes considered a factor). MFA requires at least 2 different categories (not 2 of the same). Two passwords = single factor (both "know"). A password + SMS code = two factors (know + have). Modern MFA trends: (1) Passwordless — FIDO2/WebAuthn eliminates passwords entirely, (2) Phishing-resistant MFA — hardware keys or device-bound passkeys (FIDO2) prevent phishing attacks, (3) Adaptive/risk-based MFA — require additional factors based on risk signals (new device, unusual location, unusual time). Mandates: PCI DSS requires MFA for admin access; NIST 800-63 recommends phishing-resistant authenticators.',
    reference: 'NIST SP 800-63B; FIDO Alliance',
  },
  {
    id: 'isc-d11-007',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Incident Response Phases',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'According to NIST SP 800-61, the four phases of the incident response lifecycle are:',
    options: [
      'Buy, Install, Ignore, Replace',
      'Preparation; Detection and Analysis; Containment, Eradication, and Recovery; and Post-Incident Activity (lessons learned)',
      'Plan, Execute, Report, Archive',
      'Alert, Block, Delete, Forget',
    ],
    correctAnswer: 1,
    explanation: 'NIST SP 800-61 Rev 2 incident response phases: (1) Preparation — establish IR capability: IR team (CSIRT), policies, procedures, communication plans, tools, training, exercises, (2) Detection and Analysis — detect incidents through: monitoring (SIEM, IDS/IPS, antivirus alerts, log analysis), external notifications (law enforcement, vendors, customers). Analyze: determine if event is an incident, assess scope and impact, prioritize based on business impact, (3) Containment, Eradication, Recovery — Containment: limit the damage (isolate affected systems, block malicious IPs), short-term (immediate response) and long-term (rebuild/reimage). Eradication: remove the threat (malware removal, patch vulnerabilities, reset credentials). Recovery: restore systems to normal operation, validate system integrity, monitor for recurrence, (4) Post-Incident Activity — lessons learned meeting (within 2 weeks), incident report, update IR procedures based on findings, share IOCs (Indicators of Compromise). CPA relevance: data breaches affecting financial data, fraud incidents, regulatory reporting requirements.',
    reference: 'NIST SP 800-61 Rev 2',
  },
  {
    id: 'isc-d11-008',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-threats',
    topic: 'Cyber Threats',
    subtopic: 'Social Engineering Attacks',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Social engineering attacks targeting financial personnel are particularly dangerous because:',
    options: [
      'They only target IT staff',
      'They exploit human psychology — manipulating employees through deception (phishing emails, pretexting calls, BEC fraud) to bypass technical controls by tricking authorized users into transferring funds, sharing credentials, or disclosing sensitive financial information',
      'They can only occur in person',
      'They are easily detected by firewalls',
    ],
    correctAnswer: 1,
    explanation: 'Social engineering types: (1) Phishing — fraudulent emails designed to trick recipients into clicking malicious links or providing credentials. Variants: spear phishing (targeted at individuals), whaling (targeting executives), vishing (voice/phone), smishing (SMS), (2) Business Email Compromise (BEC) — attacker impersonates a trusted party (CEO, vendor, attorney) to trick employees into making wire transfers or changing payment details. FBI reports billions in losses annually, (3) Pretexting — creating a fabricated scenario to obtain information (e.g., calling IT helpdesk pretending to be an employee needing a password reset), (4) Baiting — offering something enticing (USB drive in parking lot, free download), (5) Quid pro quo — offering a service in exchange for information. Defenses: (1) Security awareness training (regular, with simulated phishing), (2) Email filtering and anti-phishing technology, (3) Out-of-band verification for financial transactions (callback to known number), (4) DMARC/SPF/DKIM email authentication, (5) Dual authorization for wire transfers and vendor master changes.',
    reference: 'NIST SP 800-61; FBI IC3; SANS',
  },
  {
    id: 'isc-d11-009',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-threats',
    topic: 'Cyber Threats',
    subtopic: 'Ransomware',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A ransomware attack on an organization\'s financial systems has the MOST significant impact on which financial reporting assertion?',
    options: [
      'Classification',
      'Availability — ransomware encrypts data and systems, making financial records, accounting applications, and reporting systems inaccessible until ransom is paid or systems are restored from backups',
      'Presentation',
      'Understandability',
    ],
    correctAnswer: 1,
    explanation: 'Ransomware impacts: (1) Availability (primary) — financial systems encrypted and inaccessible, cannot process transactions, cannot close books, cannot generate financial reports, (2) Integrity — modern ransomware ("double extortion") also exfiltrates data before encryption; risk that data was modified, (3) Confidentiality — exfiltrated data may include sensitive financial information, customer data, employee records. Financial reporting impact: (1) Inability to close books on time, (2) Potential loss of financial data (if backups inadequate), (3) Material uncertainty about data integrity, (4) Significant remediation costs, (5) Potential SEC disclosure requirements, (6) Going concern considerations for severe attacks. Prevention: (1) Offline/immutable backups (3-2-1 rule: 3 copies, 2 media types, 1 offsite), (2) Endpoint Detection and Response (EDR), (3) Network segmentation, (4) Privileged access management, (5) Email filtering (primary delivery vector), (6) Patch management, (7) Security awareness training. Recovery: restore from clean backups, verify data integrity, forensic investigation. CPA relevance: ransomware can create material uncertainties about financial data reliability.',
    reference: 'CISA; NIST; SEC Disclosure',
  },
  {
    id: 'isc-d11-010',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-soc',
    topic: 'SOC Reports',
    subtopic: 'SOC 1 vs SOC 2 vs SOC 3',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'A SOC 1 report differs from a SOC 2 report in that SOC 1:',
    options: [
      'Covers cybersecurity only',
      'Focuses on controls at a service organization relevant to user entities\' internal control over financial reporting (ICFR) — based on SSAE 18/ISAE 3402, while SOC 2 addresses controls relevant to security, availability, processing integrity, confidentiality, and privacy (Trust Services Criteria)',
      'Is less detailed than SOC 3',
      'Is publicly available',
    ],
    correctAnswer: 1,
    explanation: 'SOC report types: SOC 1 (SSAE 18 / ISAE 3402): (1) Purpose: evaluate controls relevant to user entities\' financial reporting, (2) Audience: user entity management and auditors (restricted use), (3) When needed: service organization processes transactions or hosts data affecting user financial statements (payroll processor, SaaS accounting system, cloud hosting financial apps), (4) Criteria: controls are tested against control objectives related to financial reporting. SOC 2 (AT-C 205): (1) Purpose: evaluate controls related to Trust Services Criteria (TSC): Security (required), plus optional: Availability, Processing Integrity, Confidentiality, Privacy, (2) Audience: stakeholders who need assurance about security controls (restricted use), (3) When needed: evaluating security posture of cloud providers, SaaS vendors. SOC 3 (AT-C 205): (1) Same criteria as SOC 2, but general-use report (public), (2) Summary without detailed control descriptions or test results, (3) Used for marketing purposes. Type I: design of controls at a point in time. Type II: design AND operating effectiveness over a period (typically 12 months). CPAs should understand which report to request based on audit objectives.',
    reference: 'AICPA SSAE 18; AT-C 205; AT-C 320',
  },
  {
    id: 'isc-d11-011',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Endpoint Detection and Response',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Endpoint Detection and Response (EDR) solutions provide security beyond traditional antivirus by:',
    options: [
      'Only scanning for known viruses',
      'Continuously monitoring endpoint activity (processes, file changes, network connections, registry modifications), using behavioral analysis and machine learning to detect advanced threats, and providing automated response capabilities including isolation, remediation, and forensic investigation tools',
      'Only blocking USB devices',
      'Only generating compliance reports',
    ],
    correctAnswer: 1,
    explanation: 'EDR vs traditional antivirus: Traditional AV: (1) Signature-based detection (known malware patterns), (2) Scans files at rest or on access, (3) Limited visibility into endpoint behavior, (4) Misses zero-day, fileless malware, and advanced persistent threats (APTs). EDR: (1) Continuous monitoring — records all endpoint activity (process creation, file modifications, network connections, registry changes, command-line activity), (2) Behavioral analysis — detects suspicious behavior patterns even without known signatures (e.g., PowerShell downloading and executing code, lateral movement patterns), (3) Machine learning — AI models identify anomalous activity, (4) Automated response — isolate infected endpoints from network, kill malicious processes, roll back changes, (5) Threat hunting — security analysts can proactively search for indicators of compromise across all endpoints, (6) Forensics — detailed timeline of endpoint activity for investigation. XDR (Extended Detection and Response): extends EDR by correlating data across endpoints, network, cloud, email, and identity. CPA relevance: EDR is increasingly expected as a security control; auditors should verify endpoint protection adequacy.',
    reference: 'NIST; Gartner EDR Market Guide',
  },
  {
    id: 'isc-d11-012',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-crypto',
    topic: 'Encryption',
    subtopic: 'Data Encryption at Rest and in Transit',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Encryption of financial data should be applied:',
    options: [
      'Only when data is stored on USB drives',
      'Both at rest (stored data — databases, file systems, backups, removable media) and in transit (data moving across networks — TLS for web traffic, encrypted email, VPN tunnels) to protect confidentiality throughout the data lifecycle',
      'Only during business hours',
      'Only to non-financial data',
    ],
    correctAnswer: 1,
    explanation: 'Encryption categories: At rest: (1) Full disk encryption (FDE) — BitLocker (Windows), FileVault (Mac) — protects if device is lost/stolen, (2) Database encryption — Transparent Data Encryption (TDE) encrypts database files, column-level encryption for sensitive fields, (3) File-level encryption — encrypt specific files or folders, (4) Backup encryption — ALL backups containing financial data must be encrypted, (5) Removable media — USB drives, external hard drives. In transit: (1) TLS 1.2/1.3 — mandatory for all web (HTTPS), email (SMTPS, IMAPS), API communications, (2) VPN — encrypted tunnels for remote access and site-to-site connections, (3) SSH — encrypted terminal access for system administration, (4) Email encryption — S/MIME, PGP for sensitive communications. In use: emerging technology — data processed in encrypted form: (1) Homomorphic encryption, (2) Secure enclaves (TEE — Trusted Execution Environment), (3) Confidential computing. Key management: (1) Key generation — use cryptographically secure random number generators, (2) Key storage — Hardware Security Modules (HSMs), key vaults, (3) Key rotation — periodic key changes, (4) Key destruction — securely destroy keys when no longer needed.',
    reference: 'NIST SP 800-111; NIST SP 800-52',
  },
  {
    id: 'isc-d11-013',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Network Security',
    subtopic: 'Firewall Types and Configuration',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A next-generation firewall (NGFW) provides security beyond a traditional firewall by:',
    options: [
      'Only filtering based on IP addresses and ports',
      'Inspecting traffic at the application layer (Layer 7) — performing deep packet inspection, application awareness, SSL/TLS decryption, intrusion prevention, URL filtering, and malware detection in a single integrated platform',
      'Only blocking email',
      'Only logging traffic',
    ],
    correctAnswer: 1,
    explanation: 'Firewall evolution: (1) Packet filter — earliest type; filters based on source/destination IP, port, protocol (Layer 3/4). Simple, fast, but limited visibility. (2) Stateful inspection — tracks connection state; allows return traffic for established connections. Improvement over stateless packet filtering. (3) Application proxy/gateway — intermediary for specific applications (HTTP, FTP). Deep inspection but performance impact. (4) Next-Generation Firewall (NGFW): combines traditional firewall with advanced features: (a) Application awareness — identifies applications regardless of port (e.g., detect Facebook even on port 443), (b) Deep packet inspection (DPI) — inspects packet contents, not just headers, (c) SSL/TLS inspection — decrypts, inspects, and re-encrypts HTTPS traffic, (d) Integrated IPS — intrusion prevention within the firewall, (e) URL filtering — block access to malicious or policy-violating websites, (f) Malware detection — sandboxing suspicious files, (g) User identity-based policies — rules based on user identity (AD integration), not just IP address. Firewall placement: perimeter, internal segmentation, cloud virtual firewalls. CPA relevance: firewalls are a fundamental control protecting financial systems from external threats.',
    reference: 'NIST SP 800-41; CIS Controls',
  },
  {
    id: 'isc-d11-014',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-compliance',
    topic: 'Data Privacy',
    subtopic: 'GDPR Key Requirements',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Under GDPR, an organization processing EU personal data must comply with data protection principles including:',
    options: [
      'Retaining data indefinitely',
      'Lawfulness, fairness, and transparency; purpose limitation; data minimization; accuracy; storage limitation; integrity and confidentiality; and accountability — with individual rights including access, erasure (right to be forgotten), and data portability',
      'Sharing data freely with any third party',
      'Only protecting financial data',
    ],
    correctAnswer: 1,
    explanation: 'GDPR (General Data Protection Regulation) — effective May 2018: Data processing principles (Article 5): (1) Lawfulness, fairness, transparency (2) Purpose limitation — collected for specific, legitimate purposes (3) Data minimization — only what\'s necessary (4) Accuracy — kept up to date (5) Storage limitation — not kept longer than necessary (6) Integrity and confidentiality — appropriate security (7) Accountability — controller must demonstrate compliance. Data subject rights: (1) Right of access (2) Right to rectification (3) Right to erasure (right to be forgotten) (4) Right to restriction of processing (5) Right to data portability (6) Right to object (7) Rights related to automated decision-making. Legal bases for processing: consent, contract, legal obligation, vital interests, public task, legitimate interests. Breach notification: 72 hours to supervisory authority. Penalties: up to €20 million or 4% of global annual turnover (whichever is higher). CPA relevance: organizations with EU customers or employees must comply; GDPR impacts data retention policies, IT controls, and may affect financial system design.',
    reference: 'EU GDPR; EDPB Guidelines',
  },
  {
    id: 'isc-d11-015',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Controls',
    subtopic: 'Data Loss Prevention',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Data Loss Prevention (DLP) technology protects an organization by:',
    options: [
      'Backing up all data automatically',
      'Monitoring, detecting, and blocking unauthorized transmission of sensitive data — inspecting content in email, web uploads, file transfers, USB devices, and cloud storage to prevent exfiltration of financial data, PII, intellectual property, or confidential information',
      'Compressing data to save storage',
      'Encrypting all network traffic',
    ],
    correctAnswer: 1,
    explanation: 'DLP deployment points: (1) Network DLP — monitors data in transit across the network (email, web, FTP, cloud uploads). Inspects outbound traffic for sensitive content, (2) Endpoint DLP — monitors data on endpoints (copy to USB, print, screen capture, clipboard). Prevents unauthorized data movement from workstations, (3) Cloud DLP — monitors data in cloud services (SaaS, IaaS). Integrates with CASB (Cloud Access Security Broker). Detection methods: (1) Content inspection — regex patterns (SSN, credit card numbers, account numbers), (2) Keywords and dictionaries — financial terms, confidential markings, (3) Document fingerprinting — match against known sensitive documents, (4) Machine learning — classify documents based on training data, (5) Exact data matching — compare against databases of sensitive records. Actions: (1) Monitor and log — visibility without blocking, (2) Alert — notify security team, (3) Block — prevent the transmission, (4) Quarantine — hold for review, (5) Encrypt — automatically encrypt sensitive data in transit. CPA relevance: DLP protects financial data (tax returns, financial statements, PII) from unauthorized disclosure.',
    reference: 'NIST SP 800-53 SC; Gartner DLP',
  },
  {
    id: 'isc-d11-016',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-threats',
    topic: 'Cyber Threats',
    subtopic: 'Insider Threat Program',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An insider threat program should address threats from:',
    options: [
      'Only external hackers',
      'Current and former employees, contractors, and business partners who have authorized access — whether acting maliciously (intentional theft, fraud, sabotage) or negligently (accidental data exposure, policy violations, falling for social engineering)',
      'Only terminated employees',
      'Only senior management',
    ],
    correctAnswer: 1,
    explanation: 'Insider threat types: (1) Malicious insider — intentional: data theft (selling data, taking data to competitor), fraud (manipulating financial records), sabotage (disrupting systems), espionage. (2) Negligent insider — unintentional: falling for phishing, misconfiguring systems, sending sensitive data to wrong recipients, losing devices, using weak passwords, violating policies unknowingly. (3) Compromised insider — external attacker gains control of insider\'s credentials. Insider threat program components: (1) Detection — User and Entity Behavior Analytics (UEBA): baseline normal behavior, detect anomalies (unusual data access, unusual hours, large downloads, access to unrelated data), (2) Monitoring — DLP, SIEM, access logging, privileged user monitoring, (3) Prevention — least privilege, SoD, access reviews, background checks, security awareness training, (4) Policies — acceptable use policy, data handling policy, exit interviews, (5) Response — investigation procedures, legal/HR coordination, evidence preservation, (6) Culture — reporting mechanisms (anonymous hotline), non-punitive for good-faith reports. Key indicators: financial stress, job dissatisfaction, after-hours access to sensitive systems, large data downloads. CPA relevance: insider threats are a leading cause of financial fraud and data breaches.',
    reference: 'CISA Insider Threat; NIST',
  },
  {
    id: 'isc-d11-017',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-awareness',
    topic: 'Security Awareness',
    subtopic: 'Security Training Programs',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'An effective security awareness training program should include:',
    options: [
      'A single email to all employees once per year',
      'Regular, role-based training covering current threats (phishing, BEC, ransomware), organizational policies, data handling procedures, incident reporting — complemented by simulated phishing exercises and measured for effectiveness through metrics',
      'Only training for IT staff',
      'Only posting security posters in break rooms',
    ],
    correctAnswer: 1,
    explanation: 'Security awareness best practices: (1) Frequency — ongoing, not just annual. Monthly micro-training (5-10 min modules), annual comprehensive training, just-in-time training for role changes, (2) Role-based — different content for different roles: executives (BEC, board responsibilities), finance (wire fraud, invoice fraud), developers (secure coding, OWASP), all staff (phishing, passwords, physical security), (3) Current content — updated for evolving threats (AI-generated phishing, deepfakes, QR code phishing), (4) Engaging format — interactive modules, videos, gamification, real-world examples, (5) Simulated phishing — regular phishing simulations. Track click rates, report rates. Provide immediate feedback when users click. Target additional training for repeat clickers, (6) Metrics — phishing simulation results (click rate trend), training completion rates, incident reporting rates, security helpdesk inquiries, (7) Culture — security champions program, positive reinforcement (not punitive), celebrate reporting. Compliance: SOX, PCI DSS, HIPAA, NIST all require security awareness training. CPA relevance: human element is the weakest link — awareness programs are a critical control.',
    reference: 'NIST SP 800-50; SANS Security Awareness',
  },
  {
    id: 'isc-d11-018',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Architecture',
    subtopic: 'Defense in Depth',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Defense in depth (layered security) means:',
    options: [
      'Relying on a single strong firewall',
      'Implementing multiple overlapping security controls at different layers (network perimeter, internal network, host, application, data) — so that if one control fails, other controls continue to provide protection',
      'Only using encryption',
      'Having one very strong password policy',
    ],
    correctAnswer: 1,
    explanation: 'Defense in depth layers: (1) Physical — data center security, badges, cameras, environmental controls, (2) Perimeter — firewalls (NGFW), DMZ, email gateway, web application firewall (WAF), DDoS protection, (3) Network — network segmentation, IDS/IPS, network access control (NAC), network monitoring, (4) Host/Endpoint — EDR/antimalware, host-based firewall, patch management, hardening (CIS Benchmarks), full disk encryption, (5) Application — secure coding, input validation, authentication, authorization, session management, application logging, (6) Data — encryption (at rest and in transit), DLP, access controls, data classification, data masking, (7) People — security awareness training, policies, procedures, background checks. Principle: no single control is perfect. If the firewall is bypassed, the IDS should detect the intrusion. If the IDS misses it, the endpoint EDR should catch the malware. If the malware evades EDR, encryption protects the data. This approach assumes breach and plans accordingly. CPA relevance: auditors should evaluate whether the organization has a layered security approach, not relying on any single control.',
    reference: 'NIST SP 800-53; CIS Controls',
  },
  {
    id: 'isc-d11-019',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-compliance',
    topic: 'Regulatory Compliance',
    subtopic: 'PCI DSS Requirements',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'PCI DSS compliance is required for organizations that:',
    options: [
      'Only large retail companies',
      'Accept, process, store, or transmit payment card data — regardless of size or transaction volume; compliance requirements are organized into 12 requirements covering network security, data protection, vulnerability management, access control, monitoring, and policy',
      'Only organizations with over 1 million transactions',
      'Only banks and financial institutions',
    ],
    correctAnswer: 1,
    explanation: 'PCI DSS v4.0 (effective March 2024) — 12 requirements: Build/Maintain Secure Network: (1) Install and maintain network security controls, (2) Apply secure configurations to all system components. Protect Account Data: (3) Protect stored account data, (4) Protect cardholder data with strong cryptography during transmission. Maintain Vulnerability Mgmt: (5) Protect systems against malicious software, (6) Develop and maintain secure systems and software. Strong Access Control: (7) Restrict access to system components by business need-to-know, (8) Identify users and authenticate access, (9) Restrict physical access. Monitor/Test: (10) Log and monitor all access to system components and cardholder data, (11) Test security of systems and networks regularly. Information Security Policy: (12) Support information security with organizational policies and programs. Compliance levels (by transaction volume): Level 1 (>6M transactions): annual on-site assessment by QSA, Level 2-4: Self-Assessment Questionnaire (SAQ). Non-compliance: fines from card brands, increased transaction fees, potential loss of ability to process cards. CPA relevance: merchants and service providers handling payment data must maintain PCI DSS compliance.',
    reference: 'PCI DSS v4.0; PCI SSC',
  },
  {
    id: 'isc-d11-020',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Vulnerability Management Lifecycle',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An effective vulnerability management program includes:',
    options: [
      'Only running antivirus software',
      'Continuous discovery of assets, regular vulnerability scanning (network, application, cloud), risk-based prioritization of findings, timely remediation, verification of fixes, and metrics tracking to measure program effectiveness over time',
      'Only annual external scans',
      'Only reviewing vendor patch releases',
    ],
    correctAnswer: 1,
    explanation: 'Vulnerability management lifecycle: (1) Asset discovery — maintain accurate, up-to-date inventory of all IT assets (you can\'t protect what you don\'t know about), (2) Vulnerability scanning — automated scanning: network vulnerability scanners (Nessus, Qualys, Rapid7), web application scanners (Burp Suite, OWASP ZAP), cloud configuration scanners (AWS Inspector, Azure Defender), container image scanners, (3) Prioritization — not all vulnerabilities are equal. Consider: CVSS score (severity), exploitability (is there a known exploit?), asset criticality (financial system vs. development server), exposure (internet-facing vs. internal), compensating controls, (4) Remediation — patch, reconfigure, compensating control, or accept risk (documented). SLA: critical = 48 hours, high = 7 days, medium = 30 days, low = 90 days (varies by organization), (5) Verification — rescan to confirm remediation was effective, (6) Reporting and metrics — mean time to remediate (MTTR), vulnerability aging, coverage metrics, trend analysis. CPA relevance: vulnerability management is a key ITGC; weaknesses may indicate control deficiencies affecting financial reporting systems.',
    reference: 'NIST SP 800-40; CIS Controls 7',
  },
  {
    id: 'isc-d11-021',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-access',
    topic: 'Identity Management',
    subtopic: 'Identity and Access Management Architecture',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A comprehensive Identity and Access Management (IAM) architecture includes:',
    options: [
      'Only a password database',
      'Identity governance (lifecycle management, access certification, SoD), identity administration (provisioning, deprovisioning, directory services), authentication services (MFA, SSO, federation), and authorization services (RBAC, fine-grained access control, policy enforcement) — integrated across on-premises and cloud environments',
      'Only single sign-on',
      'Only biometric scanners',
    ],
    correctAnswer: 1,
    explanation: 'IAM architecture components: Identity Governance and Administration (IGA): (1) Identity lifecycle — joiner (provision access), mover (modify access on role change), leaver (deprovision access), (2) Access certification — periodic review and recertification of access rights by managers/owners, (3) SoD enforcement — prevent conflicting access combinations, (4) Access request workflow — self-service requests with approval workflows. Directory Services: (5) Central identity store — Active Directory, Azure AD/Entra ID, LDAP, (6) Single source of truth for user identities, (7) Group/role management. Authentication: (8) Single Sign-On (SSO) — one login for multiple applications, (9) Multi-Factor Authentication (MFA), (10) Federation — cross-organization authentication (SAML, OIDC), (11) Passwordless — FIDO2, passkeys. Authorization: (12) RBAC/ABAC — role-based or attribute-based access decisions, (13) Policy enforcement points — API gateways, application-level authorization, (14) Privileged Access Management (PAM) — additional controls for admin accounts. Cloud IAM: (15) Cloud Identity Providers (Okta, Azure AD, AWS IAM), (16) SCIM — automated user provisioning to cloud applications.',
    reference: 'NIST SP 800-63; Gartner IAM',
  },
  {
    id: 'isc-d11-022',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Cloud Security',
    subtopic: 'Cloud Access Security Broker',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A Cloud Access Security Broker (CASB) provides:',
    options: [
      'Only cloud storage',
      'Visibility into cloud service usage (shadow IT discovery), data security (DLP in cloud), threat protection (malware detection, anomalous behavior), and compliance enforcement — acting as a security policy enforcement point between users and cloud service providers',
      'Only cloud email',
      'Only cost management',
    ],
    correctAnswer: 1,
    explanation: 'CASB four pillars: (1) Visibility — discover all cloud services in use (sanctioned and unsanctioned/shadow IT), user activity monitoring, data exposure identification. Organizations typically use 10x more cloud services than IT is aware of, (2) Compliance — enforce regulatory requirements (GDPR, HIPAA, PCI DSS) across cloud services, data residency enforcement, audit logging, (3) Data security — DLP for cloud (prevent sensitive data upload/sharing), encryption and tokenization, rights management (control sharing, restrict download), (4) Threat protection — detect compromised accounts (unusual login patterns, impossible travel), malware detection in cloud storage, insider threat detection, integration with SIEM. Deployment modes: (1) API-based — connects to cloud services via APIs (post-event analysis), (2) Proxy-based — forward proxy (inline, intercepts traffic), reverse proxy (agentless), (3) Log-based — analyzes firewall/proxy logs for cloud usage. Integration: CASBs typically integrate with SSO/IdP, DLP, SIEM, and endpoint security. CPA relevance: as organizations move financial data to cloud, CASB provides security visibility and control that traditional perimeter security cannot.',
    reference: 'Gartner CASB; NIST Cloud',
  },
  {
    id: 'isc-d11-023',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Privacy Impact Assessments',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A Privacy Impact Assessment (PIA) should be conducted:',
    options: [
      'Only after a data breach occurs',
      'Before implementing new systems, processes, or technologies that involve personal data collection or processing — to identify privacy risks, evaluate necessity and proportionality, and implement appropriate safeguards and controls',
      'Only for marketing databases',
      'Only for government organizations',
    ],
    correctAnswer: 1,
    explanation: 'PIA process (also called DPIA under GDPR): When required: (1) New systems processing personal data, (2) Changes to existing data processing, (3) New technology deployment (AI, biometrics, IoT), (4) GDPR Article 35: mandatory DPIA when processing is "likely to result in a high risk" — including: large-scale processing of sensitive data, systematic monitoring of public areas, automated decision-making with significant effects. PIA components: (1) Description of processing — what data, why, how, by whom, for how long, (2) Necessity and proportionality — is the data collection necessary for the stated purpose? Is there a less invasive alternative? (3) Risk assessment — risks to individuals (identity theft, discrimination, financial loss, reputational harm), (4) Risk mitigation — controls to address identified risks (encryption, access controls, anonymization, consent management, retention limits), (5) Stakeholder consultation — input from data protection officer (DPO), affected individuals, (6) Documentation — record the assessment, decisions, and residual risks. CPA relevance: PIAs demonstrate privacy compliance; CPAs advising on new financial systems should ensure PIAs are completed.',
    reference: 'GDPR Article 35; NIST Privacy',
  },
  {
    id: 'isc-d11-024',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Security Operations Center',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'A Security Operations Center (SOC) is responsible for:',
    options: [
      'Only physical building security',
      'Continuous real-time monitoring, detection, investigation, and response to cybersecurity threats — staffed by security analysts who operate SIEM, EDR, and other security tools 24/7 to protect the organization\'s IT infrastructure and data',
      'Only software development',
      'Only help desk support',
    ],
    correctAnswer: 1,
    explanation: 'SOC functions: (1) Continuous monitoring — 24/7/365 monitoring of security events from all sources (SIEM, EDR, firewalls, IDS/IPS, cloud, email), (2) Alert triage — investigate security alerts (Tier 1: initial triage and categorization, Tier 2: deeper analysis and investigation, Tier 3: advanced threat hunting and incident response), (3) Incident management — coordinate response to confirmed incidents per IR procedures, (4) Threat intelligence — consume and apply threat intelligence feeds (IOCs, TTPs), (5) Threat hunting — proactively search for threats that may have evaded automated detection, (6) Vulnerability coordination — work with IT to address critical vulnerabilities. SOC models: (1) In-house SOC — organization operates its own (expensive, 7+ FTEs for 24/7), (2) Managed SOC (MSSP) — outsourced to a managed security service provider, (3) Hybrid — in-house during business hours, MSSP after hours, (4) Virtual SOC — distributed team, cloud-based tools. SOC metrics: Mean Time to Detect (MTTD), Mean Time to Respond (MTTR), alert volume, false positive rate, incidents per severity. CPA relevance: SOC capabilities indicate the organization\'s security monitoring maturity.',
    reference: 'NIST SP 800-61; SANS SOC',
  },
  {
    id: 'isc-d11-025',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Application Security',
    subtopic: 'OWASP Top 10',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'The OWASP Top 10 represents the most critical web application security risks. Which of the following is the MOST relevant risk to financial web applications?',
    options: [
      'Using outdated HTML tags',
      'Injection attacks (SQL injection, cross-site scripting) — where attackers insert malicious code into application inputs that the application executes, potentially accessing, modifying, or deleting financial data in the database',
      'Using the wrong font size',
      'Having too many images on a page',
    ],
    correctAnswer: 1,
    explanation: 'OWASP Top 10 (2021): (1) A01: Broken Access Control — users acting beyond their intended permissions, (2) A02: Cryptographic Failures — inadequate encryption of sensitive data, (3) A03: Injection — SQL injection, XSS (Cross-Site Scripting), command injection, LDAP injection. Attacker inserts malicious code through input fields, URLs, or API parameters. SQL injection can: read entire databases, modify or delete data, bypass authentication, execute system commands. (4) A04: Insecure Design — missing security controls in architecture, (5) A05: Security Misconfiguration — default configs, unnecessary features, (6) A06: Vulnerable and Outdated Components — known vulnerabilities in libraries/frameworks, (7) A07: Identification and Authentication Failures — weak authentication, (8) A08: Software and Data Integrity Failures — code and infrastructure without integrity verification, (9) A09: Security Logging and Monitoring Failures — insufficient logging, (10) A10: Server-Side Request Forgery (SSRF). Prevention: input validation, parameterized queries (prepared statements), output encoding, WAF (Web Application Firewall), secure coding practices, regular security testing. CPA relevance: financial web applications processing sensitive data must address OWASP risks.',
    reference: 'OWASP Top 10 2021; NIST',
  },
];
