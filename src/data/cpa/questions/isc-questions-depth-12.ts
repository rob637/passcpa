/**
 * CPA ISC Section - Questions Depth Batch 12
 * Blueprint Area: ISC-II (Security, Confidentiality, and Privacy)
 * Topics: Data Privacy, Incident Response, Business Continuity, Cloud Security
 */

import { Question } from '../../../types';

export const ISC_QUESTIONS_DEPTH_12: Question[] = [
  {
    id: 'isc-d12-001',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'GDPR Core Principles',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'Under the General Data Protection Regulation (GDPR), the principle of "data minimization" requires that personal data be:',
    options: [
      'Collected in the largest possible quantities for future use',
      'Adequate, relevant, and limited to what is necessary in relation to the purposes for which it is processed',
      'Stored indefinitely for compliance purposes',
      'Shared freely across all business units',
    ],
    correctAnswer: 1,
    explanation: 'GDPR Article 5(1)(c) establishes data minimization as a core principle: personal data shall be adequate, relevant, and limited to what is necessary in relation to the purposes for which they are processed. The seven GDPR principles are: (1) Lawfulness, fairness, and transparency, (2) Purpose limitation — collected for specified, explicit, and legitimate purposes, (3) Data minimization, (4) Accuracy — kept up to date, inaccurate data erased or rectified, (5) Storage limitation — kept no longer than necessary, (6) Integrity and confidentiality — appropriate security measures, (7) Accountability — the data controller is responsible for demonstrating compliance. CPA relevance: organizations handling EU personal data must implement privacy-by-design controls; CPAs assessing data management controls must understand these principles.',
    reference: 'GDPR Article 5',
  },
  {
    id: 'isc-d12-002',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'CCPA Consumer Rights',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Under the California Consumer Privacy Act (CCPA) as amended by the CPRA, a consumer has the right to:',
    options: [
      'Only request deletion of their data',
      'Know what personal information is collected, request deletion, opt out of the sale or sharing of their personal information, and not be discriminated against for exercising these rights',
      'Demand payment for their personal data',
      'Prevent any company from collecting data in California',
    ],
    correctAnswer: 1,
    explanation: 'CCPA/CPRA consumer rights: (1) Right to Know — what personal information is collected, used, disclosed, and sold, (2) Right to Delete — request deletion of personal information, (3) Right to Opt-Out — opt out of the sale or sharing of personal information ("Do Not Sell or Share My Personal Information"), (4) Right to Non-Discrimination — businesses cannot discriminate for exercising privacy rights, (5) Right to Correct — correct inaccurate personal information (added by CPRA), (6) Right to Limit Use of Sensitive Personal Information (added by CPRA). Applies to businesses meeting thresholds: $25M+ revenue, 100K+ consumers/households, or 50%+ revenue from selling personal information. CPA relevance: compliance assessments, privacy impact assessments, and SOC 2 Trust Services Criteria for Privacy.',
    reference: 'CCPA §1798.100-199; CPRA',
  },
  {
    id: 'isc-d12-003',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Incident Response',
    subtopic: 'NIST Incident Response Phases',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'According to NIST SP 800-61 (Computer Security Incident Handling Guide), the four phases of the incident response lifecycle are:',
    options: [
      'Plan, Execute, Report, Archive',
      'Preparation; Detection and Analysis; Containment, Eradication, and Recovery; Post-Incident Activity',
      'Identify, Prevent, Monitor, Review',
      'Alert, Investigate, Remediate, Close',
    ],
    correctAnswer: 1,
    explanation: 'NIST SP 800-61 Rev. 2 Incident Response Lifecycle: (1) Preparation — develop IR plan, establish IR team (CSIRT), acquire tools, conduct training and exercises, define communication procedures, (2) Detection and Analysis — monitor for indicators of compromise (IoCs), analyze alerts, determine scope and impact, triage and prioritize, document findings, (3) Containment, Eradication, and Recovery — short-term containment (isolate affected systems), evidence preservation (forensic imaging), long-term containment, eradication (remove root cause), recovery (restore systems from clean backups, validate), (4) Post-Incident Activity — lessons learned meeting, update IR plan, identify improvements, report to stakeholders, retain evidence per policy. Key concepts: IR plan should be tested annually through tabletop exercises and simulations. CPA relevance: evaluating an organization\'s incident response capability is critical for assessing IT general controls and cybersecurity risk management.',
    reference: 'NIST SP 800-61 Rev. 2',
  },
  {
    id: 'isc-d12-004',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Incident Response',
    subtopic: 'Data Breach Notification',
    difficulty: 'hard',
    skillLevel: 'Application',
    question: 'When a data breach involving personally identifiable information (PII) occurs, organizations are generally required to:',
    options: [
      'Wait until all facts are known before any notification',
      'Notify affected individuals and relevant regulatory authorities within prescribed timeframes (e.g., 72 hours under GDPR), document the breach, and implement remediation measures',
      'Only notify law enforcement',
      'Issue a press release but no individual notification',
    ],
    correctAnswer: 1,
    explanation: 'Data breach notification requirements: GDPR: notify supervisory authority within 72 hours of becoming aware of a breach involving personal data, notify affected individuals "without undue delay" if the breach poses a high risk to rights and freedoms. U.S. state laws: all 50 states have breach notification laws with varying timeframes (ranging from 30 to 90 days), definitions of covered information, and notification requirements. SEC: public companies must disclose material cybersecurity incidents in Form 8-K within 4 business days. HIPAA: covered entities must notify affected individuals within 60 days, HHS if 500+ records, media if 500+ in a state. Key steps: (1) contain the breach, (2) assess scope and severity, (3) document findings, (4) notify as required by applicable laws, (5) remediate vulnerabilities, (6) conduct post-incident review. CPA relevance: evaluating breach response procedures, documenting internal controls around incident management, HIPAA compliance attestation.',
    reference: 'GDPR Article 33-34; State breach notification laws',
  },
  {
    id: 'isc-d12-005',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Business Continuity',
    subtopic: 'BCP vs DRP',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'The primary difference between a Business Continuity Plan (BCP) and a Disaster Recovery Plan (DRP) is:',
    options: [
      'They are identical — the terms are interchangeable',
      'A BCP addresses the continuity of all critical business operations during and after a disruption, while a DRP focuses specifically on restoring IT infrastructure and technology systems',
      'A DRP is broader in scope than a BCP',
      'A BCP only addresses natural disasters',
    ],
    correctAnswer: 1,
    explanation: 'Business Continuity Plan (BCP): comprehensive plan addressing continuity of ALL critical business functions — including people, processes, facilities, and technology — during and after a disruption. Includes communication plans, alternate work locations, succession planning, and supply chain continuity. Disaster Recovery Plan (DRP): subset of the BCP focused specifically on restoring IT systems, infrastructure, and data after a disruption. Includes recovery procedures, backup strategies, alternate processing sites, and technology restoration priorities. Key concepts: Business Impact Analysis (BIA) — identifies critical business functions and their maximum tolerable downtime (MTD), Recovery Time Objective (RTO) — maximum acceptable time to restore a system, Recovery Point Objective (RPO) — maximum acceptable data loss (in time). Both plans require regular testing: tabletop exercises, structured walkthroughs, simulation tests, and full-scale tests.',
    reference: 'NIST SP 800-34; ISO 22301',
  },
  {
    id: 'isc-d12-006',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Business Continuity',
    subtopic: 'Recovery Site Types',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An organization needs to recover critical financial systems within 4 hours of a disaster. Which recovery site is most appropriate?',
    options: [
      'Cold site — empty facility with basic utilities only',
      'Hot site — fully equipped with current hardware, software, data replication, and ready for immediate failover',
      'Warm site — partially equipped facility requiring hours to days for equipment setup',
      'Mobile site',
    ],
    correctAnswer: 1,
    explanation: 'Recovery site types by readiness level: (1) Hot site — fully operational duplicate of the primary site with real-time or near-real-time data replication, all hardware/software pre-configured, can be operational within minutes to hours. Most expensive but lowest RTO. (2) Warm site — partially equipped with some hardware and connectivity, requires installation/configuration of remaining equipment and data restoration from backups. Recovery time: hours to days. Moderate cost. (3) Cold site — basic facility with utilities (power, HVAC, connectivity) but no pre-installed equipment. Requires full hardware procurement, installation, and data restoration. Recovery time: days to weeks. Least expensive. (4) Cloud-based recovery (DRaaS) — increasingly common, provides scalable hot/warm site capabilities using cloud infrastructure. With a 4-hour RTO, a hot site is required because warm and cold sites cannot consistently meet that aggressive timeline.',
    reference: 'NIST SP 800-34; ISACA CISA Review Manual',
  },
  {
    id: 'isc-d12-007',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Cloud Security',
    subtopic: 'Shared Responsibility Model',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'In an Infrastructure as a Service (IaaS) cloud model, the shared responsibility model dictates that the cloud customer is responsible for:',
    options: [
      'Nothing — the cloud provider handles all security',
      'Security of the operating system, applications, data, identity and access management, and network configuration deployed on the cloud infrastructure, while the provider secures the underlying physical infrastructure',
      'Only the physical data center',
      'Only billing and payment',
    ],
    correctAnswer: 1,
    explanation: 'Cloud shared responsibility model (varies by service model): IaaS (e.g., AWS EC2, Azure VMs): Customer responsible for: OS patching and hardening, application security, data encryption and classification, IAM (users, roles, permissions), network security groups/firewall rules, logging and monitoring of customer-deployed resources. Provider responsible for: physical security (data centers), hypervisor/virtualization layer, network infrastructure, storage infrastructure, hardware maintenance. PaaS: provider takes on MORE responsibility (OS, middleware, runtime). Customer responsible for: application code, data, IAM. SaaS: provider handles MOST responsibilities. Customer responsible for: data, user access, configuration settings. Key principle: "Security OF the cloud" (provider) vs. "Security IN the cloud" (customer). CPA relevance: understanding the shared responsibility model is critical for evaluating controls at service organizations and issuing SOC reports.',
    reference: 'CSA Cloud Controls Matrix; NIST SP 800-145',
  },
  {
    id: 'isc-d12-008',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Cloud Security',
    subtopic: 'Cloud Deployment Models',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Which cloud deployment model provides dedicated infrastructure for a single organization, offering the most control over security and compliance?',
    options: [
      'Public cloud',
      'Private cloud',
      'Community cloud',
      'Hybrid cloud',
    ],
    correctAnswer: 1,
    explanation: 'NIST SP 800-145 defines four cloud deployment models: (1) Private cloud — infrastructure provisioned for exclusive use by a single organization. May be on-premises or hosted by a third party. Offers maximum control over security, compliance, and customization. Higher cost but preferred for sensitive data (e.g., financial data, PII, healthcare). (2) Public cloud — infrastructure available to the general public, owned and managed by a cloud service provider (e.g., AWS, Azure, GCP). Economies of scale, pay-per-use, but less control. (3) Community cloud — shared by organizations with common concerns (e.g., government agencies, healthcare organizations). Shared costs, tailored to community requirements. (4) Hybrid cloud — composition of two or more distinct cloud infrastructures (private, community, or public) that remain unique entities but are bound together by technology enabling data and application portability. CPA relevance: the deployment model affects risk assessment, control evaluation, and the type of SOC report needed.',
    reference: 'NIST SP 800-145',
  },
  {
    id: 'isc-d12-009',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Privacy Impact Assessment',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A company is implementing a new customer analytics platform that will process large volumes of personal data. A Privacy Impact Assessment (PIA) should:',
    options: [
      'Only be performed after the system is fully deployed',
      'Be conducted before implementation to identify privacy risks, evaluate necessity and proportionality, assess data flows, determine legal bases for processing, and define mitigation controls — with results documented and reviewed by the Data Protection Officer',
      'Only review the technology without considering data flows',
      'Be performed solely by the IT department',
    ],
    correctAnswer: 1,
    explanation: 'Privacy Impact Assessment (PIA) / Data Protection Impact Assessment (DPIA under GDPR Article 35): Purpose: systematically evaluate privacy risks of a project, system, or process BEFORE implementation. Required elements: (1) Description of processing operations and purposes, (2) Assessment of necessity and proportionality — is the data collection justified? (3) Data flow mapping — what data is collected, where stored, who has access, cross-border transfers? (4) Legal basis identification — consent, contract, legitimate interest, legal obligation? (5) Risk identification — unauthorized access, excessive collection, purpose creep, re-identification, (6) Mitigation measures — encryption, access controls, data minimization, retention limits, pseudonymization, (7) DPO review and sign-off. GDPR requires DPIAs for high-risk processing: systematic monitoring, large-scale processing of special categories, automated decision-making. CPA relevance: CPAs providing advisory services on privacy compliance, SOC 2 privacy criteria, and GRC frameworks.',
    reference: 'GDPR Article 35; NIST Privacy Framework',
  },
  {
    id: 'isc-d12-010',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Encryption',
    subtopic: 'Encryption at Rest vs in Transit',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An organization stores sensitive financial data in a cloud database. Which encryption strategy addresses both data at rest and data in transit?',
    options: [
      'Encrypting the database using AES-256 for data at rest, but leaving network traffic unencrypted',
      'Implementing AES-256 encryption for data stored in the database (at rest) AND TLS 1.2/1.3 for all data transmitted between the application and the database (in transit)',
      'Using only MD5 hashing on all data',
      'Encrypting only email communications',
    ],
    correctAnswer: 1,
    explanation: 'Comprehensive encryption strategy: Data at rest: encrypt stored data using strong symmetric encryption (AES-256 is the standard). Methods: full-disk encryption (FDE), file-level encryption, database-level encryption (Transparent Data Encryption — TDE), column-level encryption for sensitive fields. Key management: secure key storage using HSM (Hardware Security Module) or cloud KMS (Key Management Service). Data in transit: encrypt data moving between systems using TLS 1.2 or 1.3. HTTPS for web traffic, encrypted VPN for site-to-site connections, SFTP/SCP for file transfers. Data in use: emerging technology — homomorphic encryption, secure enclaves (Intel SGX, AMD SEV), confidential computing. CPA relevance: encryption controls are part of IT general controls evaluation; SOC 2 Common Criteria CC6.1 (logical and physical access), CC6.7 (restriction of data transmission). AES-256 is NIST-approved and FIPS 140-2/3 validated.',
    reference: 'NIST SP 800-111; NIST SP 800-52; FIPS 197',
  },
  {
    id: 'isc-d12-011',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Encryption',
    subtopic: 'Key Management Lifecycle',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Effective cryptographic key management requires:',
    options: [
      'Storing encryption keys alongside the encrypted data for convenience',
      'A complete key lifecycle including generation using cryptographically secure methods, secure distribution, storage in hardware security modules (HSMs), rotation on a defined schedule, revocation procedures, and secure destruction when no longer needed',
      'Using the same encryption key for all systems indefinitely',
      'Sharing encryption keys via unencrypted email',
    ],
    correctAnswer: 1,
    explanation: 'NIST SP 800-57 Key Management Lifecycle: (1) Key Generation — use cryptographically secure random number generators (CSPRNG), appropriate key lengths (AES-256, RSA-2048+, ECC-256+), (2) Key Distribution — secure channels (TLS, out-of-band), key exchange protocols (Diffie-Hellman, ECDH), (3) Key Storage — hardware security modules (HSMs) providing tamper-resistant storage, cloud KMS services, never store keys with encrypted data, separation of duties for key administrators, (4) Key Use — enforce authorized use through access controls and policies, (5) Key Rotation — regular rotation schedule (annually minimum, more frequently for sensitive data), automated rotation where possible, (6) Key Revocation/Suspension — certificate revocation lists (CRLs), Online Certificate Status Protocol (OCSP), (7) Key Destruction — cryptographic erasure, secure deletion ensuring keys cannot be recovered. Dual control and split knowledge: no single person should have complete knowledge of or access to a cryptographic key. CPA relevance: key management is a critical IT control; SOC 2 CC6.1 addresses encryption key management.',
    reference: 'NIST SP 800-57',
  },
  {
    id: 'isc-d12-012',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Network Security',
    subtopic: 'Zero Trust Architecture',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A Zero Trust Architecture (ZTA) differs from traditional perimeter-based security because:',
    options: [
      'It eliminates the need for any security controls',
      'It assumes no implicit trust based on network location — every access request is authenticated, authorized, and encrypted regardless of whether the user is inside or outside the corporate network, following the principle of "never trust, always verify"',
      'It only applies to external users',
      'It relies solely on firewalls',
    ],
    correctAnswer: 1,
    explanation: 'Zero Trust Architecture (NIST SP 800-207): Core principles: (1) Never trust, always verify — no implicit trust based on network location, IP address, or prior authentication, (2) Least privilege access — grant minimum permissions needed, time-limited where possible, (3) Assume breach — design systems assuming the network is already compromised, minimize blast radius, (4) Micro-segmentation — divide network into small, isolated segments with individual access controls, (5) Continuous verification — re-authenticate and re-authorize throughout a session, not just at initial login, (6) Strong identity — multi-factor authentication, device health verification, context-aware access decisions (user identity + device + location + time + behavior). Implementation pillars: identity, devices, networks, applications/workloads, data. Technologies: identity-aware proxy, software-defined perimeter (SDP), SASE (Secure Access Service Edge), ZTNA (Zero Trust Network Access). CPA relevance: evaluating Zero Trust controls in IT environments, assessing adequacy of access controls for financial systems.',
    reference: 'NIST SP 800-207',
  },
  {
    id: 'isc-d12-013',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Network Security',
    subtopic: 'Intrusion Detection and Prevention',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'The key difference between an Intrusion Detection System (IDS) and an Intrusion Prevention System (IPS) is:',
    options: [
      'IDS and IPS are identical systems',
      'An IDS monitors and alerts on suspicious activity but does not block it, while an IPS actively blocks or prevents detected threats in real-time',
      'An IDS is hardware and an IPS is software',
      'An IDS only monitors external traffic',
    ],
    correctAnswer: 1,
    explanation: 'Intrusion Detection System (IDS): passive monitoring — analyzes network traffic or host activity, identifies suspicious patterns, generates alerts for security personnel, does NOT automatically block traffic. Types: Network-based IDS (NIDS) monitors network traffic at strategic points, Host-based IDS (HIDS) monitors activity on individual hosts. Intrusion Prevention System (IPS): active protection — sits inline in the network path, analyzes traffic, AND automatically blocks/drops malicious packets in real-time. Same detection methods as IDS but with active response capability. Detection methods (both IDS/IPS): (1) Signature-based — compares against known attack patterns (fast, accurate for known threats, cannot detect zero-day attacks), (2) Anomaly-based — establishes baseline of normal behavior, alerts on deviations (can detect unknown threats, higher false positive rate), (3) Stateful protocol analysis — compares observed traffic against expected protocol behavior. CPA relevance: IDS/IPS are detective/preventive controls in the IT control environment.',
    reference: 'NIST SP 800-94',
  },
  {
    id: 'isc-d12-014',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Identity and Access Management',
    subtopic: 'Privileged Access Management',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Privileged Access Management (PAM) controls are critical because:',
    options: [
      'Every user needs administrator access',
      'Privileged accounts (administrators, database admins, service accounts) have elevated permissions that, if compromised, can lead to unauthorized access to critical systems and data — PAM implements controls including credential vaulting, session recording, just-in-time access, and principle of least privilege',
      'PAM is only needed for external contractors',
      'Privileged access does not pose additional risk',
    ],
    correctAnswer: 1,
    explanation: 'Privileged Access Management (PAM): Privileged accounts include: system administrators (root, admin), database administrators (DBA), service accounts, application accounts, emergency/break-glass accounts. PAM controls: (1) Credential vaulting — store privileged credentials in an encrypted vault with automated password rotation, (2) Session monitoring and recording — record all privileged sessions for audit trail and forensic review, (3) Just-in-Time (JIT) access — grant elevated privileges only when needed and for a limited time, (4) Least privilege — default to minimal permissions, elevate only as approved, (5) Multi-factor authentication — require MFA for all privileged access, (6) Access request and approval workflow — formal approval process before granting privileged access, (7) Separation of duties — prevent single individuals from having conflicting privileged roles. Why critical: privileged accounts are the primary target for advanced persistent threats (APTs) and insider threats. CPA relevance: SOC 2 CC6.1-CC6.3 address logical access controls; PCAOB standards require evaluation of IT privileged access controls.',
    reference: 'NIST SP 800-53 AC-6; AICPA TSC CC6',
  },
  {
    id: 'isc-d12-015',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Vulnerability Management',
    subtopic: 'Vulnerability Scanning vs Penetration Testing',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'The primary difference between vulnerability scanning and penetration testing is:',
    options: [
      'They serve the same purpose',
      'Vulnerability scanning uses automated tools to identify known vulnerabilities across systems, while penetration testing involves authorized human testers actively attempting to exploit vulnerabilities to assess real-world risk and the effectiveness of security controls',
      'Penetration testing is automated and scanning is manual',
      'Vulnerability scanning is more thorough than penetration testing',
    ],
    correctAnswer: 1,
    explanation: 'Vulnerability Scanning: automated, broad coverage, identifies known vulnerabilities against a database (CVE — Common Vulnerabilities and Exposures), produces reports with severity ratings (CVSS scores), fast and repeatable, performed frequently (weekly/monthly), low risk of disruption, limited depth — identifies vulnerabilities but does not exploit them. Penetration Testing: human-driven (with automated tools), targeted and deep, actively exploits vulnerabilities to demonstrate real-world impact, tests defense-in-depth and incident response, performed periodically (annually/semi-annually), requires rules of engagement and authorization, higher risk (controlled), provides proof-of-concept exploits. Types of pen tests: black box (no prior knowledge), white box (full access), gray box (partial knowledge). CPA relevance: both are part of IT risk assessment; SOC 2 CC7.1 addresses vulnerability management; PCAOB and AICPA standards reference penetration testing as part of IT control evaluation.',
    reference: 'NIST SP 800-115; OWASP Testing Guide',
  },
  {
    id: 'isc-d12-016',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Classification',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Data classification is important because it:',
    options: [
      'Only applies to government organizations',
      'Enables organizations to apply appropriate security controls based on the sensitivity and value of data — ensuring the most sensitive data (e.g., PII, financial records, trade secrets) receives the strongest protections',
      'Eliminates the need for encryption',
      'Is only required for marketing data',
    ],
    correctAnswer: 1,
    explanation: 'Data classification assigns categories to data based on sensitivity, regulatory requirements, and business value. Common classification levels: (1) Public — no restrictions, freely available, (2) Internal/Private — for internal use, not publicly available, (3) Confidential — sensitive data requiring access controls (e.g., financial records, employee data), (4) Restricted/Highly Confidential — most sensitive data requiring the strongest controls (e.g., PII, PHI, payment card data, trade secrets). Benefits: (1) Risk-based security — stronger controls for more sensitive data, (2) Regulatory compliance — GDPR, HIPAA, PCI-DSS, SOX all require appropriate data protection, (3) Cost efficiency — avoid over-protecting low-sensitivity data, (4) Access control alignment — classification drives who can access what data, (5) Incident response — classification helps prioritize breach response. CPA relevance: data classification is foundational to SOC 2 Trust Services Criteria, particularly CC6.1 (logical access) and P1 (privacy).',
    reference: 'NIST SP 800-60; ISO 27001 Annex A.8',
  },
  {
    id: 'isc-d12-017',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'SIEM Systems',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A Security Information and Event Management (SIEM) system provides value by:',
    options: [
      'Replacing all other security controls',
      'Aggregating and correlating log data from multiple sources across the IT environment, enabling real-time threat detection, incident investigation, compliance reporting, and centralized security monitoring',
      'Only storing logs for backup purposes',
      'Only monitoring email traffic',
    ],
    correctAnswer: 1,
    explanation: 'SIEM capabilities: (1) Log aggregation — collect logs from firewalls, IDS/IPS, servers, applications, databases, endpoints, cloud services, and identity systems into a centralized platform, (2) Event correlation — analyze events across multiple sources to identify patterns indicating security incidents (e.g., failed login followed by successful login from different location), (3) Real-time alerting — generate alerts when predefined rules or anomaly thresholds are triggered, (4) Dashboards and visualization — provide security operations center (SOC) analysts with real-time visibility, (5) Incident investigation — enable forensic analysis by searching historical log data, (6) Compliance reporting — generate reports for SOX, HIPAA, PCI-DSS, SOC 2, and other regulatory requirements, (7) Threat intelligence integration — correlate events with known threat indicators. Modern SIEM includes SOAR (Security Orchestration, Automation, and Response) for automated response playbooks and UEBA (User and Entity Behavior Analytics). CPA relevance: SIEM logs provide audit evidence for IT controls testing.',
    reference: 'NIST SP 800-92',
  },
  {
    id: 'isc-d12-018',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Security Awareness Training',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'An effective security awareness training program should include:',
    options: [
      'A one-time training during onboarding only',
      'Regular training for all employees covering phishing recognition, password hygiene, social engineering tactics, data handling procedures, incident reporting, and role-specific security responsibilities — with regular simulated phishing exercises to measure effectiveness',
      'Only technical training for IT staff',
      'Written policies without any training sessions',
    ],
    correctAnswer: 1,
    explanation: 'Security awareness training best practices (NIST SP 800-50): (1) Frequency — regular and recurring (at least annually, preferably quarterly or monthly micro-trainings), (2) Audience — ALL employees, contractors, and third-party users, not just IT staff, (3) Content — phishing and social engineering recognition, password management, data classification and handling, physical security, mobile device security, incident reporting procedures, acceptable use policies, role-specific security responsibilities, (4) Simulated phishing — periodic simulated phishing campaigns to measure employee susceptibility and provide just-in-time training for those who click, (5) Metrics — track training completion rates, phishing simulation click rates, incident reporting rates, (6) Updates — reflect current threat landscape and recent incidents. Human factor: employees are often the weakest link in security; social engineering is the most common initial attack vector. CPA relevance: security awareness is part of the control environment; SOC 2 CC1.4 requires commitment to competence and security awareness.',
    reference: 'NIST SP 800-50; AICPA TSC CC1.4',
  },
  {
    id: 'isc-d12-019',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Retention and Disposal',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A data retention policy should specify:',
    options: [
      'That all data should be kept forever',
      'The types of data covered, retention periods based on legal, regulatory, and business requirements, storage locations and security controls, and procedures for secure disposal when retention periods expire',
      'Only the backup schedule',
      'Only the data format requirements',
    ],
    correctAnswer: 1,
    explanation: 'Data retention policy components: (1) Scope — identify all data types (financial records, employee data, customer data, email, contracts), (2) Retention periods — based on legal requirements (tax records: 7 years, SOX: 7 years for audit workpapers, HIPAA: 6 years, employment records: varies by type), regulatory requirements, litigation holds, and business needs, (3) Storage requirements — secure storage with appropriate access controls, encryption, and backup, (4) Disposal procedures — secure destruction methods: physical destruction (shredding, degaussing, incineration), cryptographic erasure, secure overwriting (DoD 5220.22-M standard or NIST SP 800-88 guidelines), certificates of destruction for sensitive data, (5) Exceptions — litigation holds, regulatory investigations, (6) Responsibilities — data owners, IT, legal, compliance. NIST SP 800-88: media sanitization guidelines — Clear, Purge, Destroy methods. CPA relevance: retention policies affect audit evidence availability; SOC 2 privacy criteria P4 (use, retention, and disposal).',
    reference: 'NIST SP 800-88; SOX §802; AICPA TSC P4',
  },
  {
    id: 'isc-d12-020',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Cloud Security',
    subtopic: 'Cloud Security Controls',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'When evaluating the security of a cloud service provider for processing sensitive financial data, a CPA should assess:',
    options: [
      'Only the provider\'s marketing materials',
      'The provider\'s SOC 2 Type II report (covering trust services criteria), data residency and jurisdiction controls, encryption practices (at rest and in transit), access control mechanisms, incident response capabilities, business continuity provisions, and contractual terms including data processing agreements',
      'Only the price of the cloud service',
      'Only whether the provider has a website',
    ],
    correctAnswer: 1,
    explanation: 'Cloud provider security evaluation framework: (1) SOC Reports — SOC 2 Type II (most relevant) covering Security, Availability, Processing Integrity, Confidentiality, Privacy criteria; SOC 1 for financial reporting controls, (2) Certifications — ISO 27001, ISO 27017 (cloud security), ISO 27018 (cloud privacy), CSA STAR, FedRAMP, (3) Data residency — where data is physically stored (jurisdiction affects regulatory requirements — GDPR, data localization laws), (4) Encryption — at rest (AES-256), in transit (TLS 1.2+), key management (customer-managed keys vs. provider-managed), (5) Access controls — IAM, MFA, RBAC, privileged access management, segregation of customer environments, (6) Incident response — notification SLAs, breach response procedures, communication protocols, (7) Business continuity — SLAs for availability, RTO/RPO commitments, geographic redundancy, (8) Contractual terms — data processing agreements, right to audit, data portability, exit strategy, liability and indemnification. CPA relevance: AICPA standards require understanding of the service organization\'s controls.',
    reference: 'AICPA SOC 2; CSA CCM; ISO 27017',
  },
  {
    id: 'isc-d12-021',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Identity and Access Management',
    subtopic: 'Multi-Factor Authentication',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Multi-factor authentication (MFA) requires users to provide at least two of which categories of authentication factors?',
    options: [
      'Two different passwords',
      'Something you know (password/PIN), something you have (token/phone/smart card), and/or something you are (biometric — fingerprint, face recognition, iris scan)',
      'Two forms of photo ID',
      'A username and email address',
    ],
    correctAnswer: 1,
    explanation: 'Authentication factor categories: (1) Something you know (knowledge factor) — passwords, PINs, security questions (weakest factor — subject to phishing, brute force, credential stuffing), (2) Something you have (possession factor) — hardware tokens, mobile phones (authenticator apps, SMS codes), smart cards, FIDO2 security keys (stronger — requires physical possession), (3) Something you are (inherence factor) — biometrics: fingerprints, facial recognition, iris scan, voice recognition, retinal scan (strongest individual factor — unique to the person). MFA requires at least 2 DIFFERENT factor categories (two passwords = NOT MFA). Modern MFA methods: FIDO2/WebAuthn (phishing-resistant), authenticator apps (TOTP — Time-based One-Time Password), push notifications. SMS-based MFA is considered weaker due to SIM-swapping attacks. CPA relevance: MFA is a critical access control for financial systems; SOC 2 CC6.1 addresses authentication mechanisms.',
    reference: 'NIST SP 800-63B; AICPA TSC CC6.1',
  },
  {
    id: 'isc-d12-022',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Cross-Border Data Transfers',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Under GDPR, transferring personal data to a country outside the European Economic Area (EEA) requires:',
    options: [
      'No restrictions on data transfer',
      'An adequacy decision by the European Commission for the destination country, OR appropriate safeguards such as Standard Contractual Clauses (SCCs), Binding Corporate Rules (BCRs), or approved certification mechanisms — and a Transfer Impact Assessment documenting the risks',
      'Only notifying the data subject',
      'Approval from each EU member state individually',
    ],
    correctAnswer: 1,
    explanation: 'GDPR Chapter V — Cross-border data transfers: (1) Adequacy decisions (Article 45) — European Commission determines that a third country provides adequate data protection (e.g., Japan, UK, South Korea, EU-U.S. Data Privacy Framework 2023). No additional safeguards needed for transfers to adequate countries. (2) Appropriate safeguards (Article 46) — when no adequacy decision exists: Standard Contractual Clauses (SCCs) — pre-approved contractual terms between data exporter and importer, Binding Corporate Rules (BCRs) — internal rules for multinational organizations, approved codes of conduct, certification mechanisms. (3) Derogations (Article 49) — limited exceptions: explicit consent, contractual necessity, important public interest, legal claims, vital interests. (4) Transfer Impact Assessment (TIA) — required post-Schrems II decision: assess whether the destination country provides essentially equivalent protection, consider local surveillance laws, implement supplementary measures (encryption, pseudonymization) if needed. CPA relevance: data transfer compliance affects multinational audit engagements and SOC privacy assessments.',
    reference: 'GDPR Articles 44-49; Schrems II (Case C-311/18)',
  },
  {
    id: 'isc-d12-023',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Vulnerability Management',
    subtopic: 'Patch Management',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An effective patch management process includes:',
    options: [
      'Applying all patches immediately to production without testing',
      'Inventorying assets, monitoring for patch releases, assessing severity and applicability, testing patches in a non-production environment, deploying patches within risk-based timeframes, and verifying successful installation',
      'Only patching when a breach occurs',
      'Disabling automatic updates permanently',
    ],
    correctAnswer: 1,
    explanation: 'Patch management lifecycle (NIST SP 800-40): (1) Asset inventory — maintain a comprehensive inventory of all hardware, software, and firmware (you cannot patch what you do not know about), (2) Patch monitoring — subscribe to vendor security advisories, CERT alerts, CVE databases, (3) Assessment — evaluate severity using CVSS (Common Vulnerability Scoring System) scores: Critical (9.0-10.0), High (7.0-8.9), Medium (4.0-6.9), Low (0.1-3.9), (4) Risk-based prioritization — critical/high severity patches prioritized for expedited deployment, (5) Testing — test patches in a staging/non-production environment to verify compatibility and prevent unintended disruptions, (6) Deployment — roll out patches within defined timeframes (e.g., critical: 48 hours, high: 7 days, medium: 30 days), (7) Verification — confirm successful installation and system functionality, (8) Documentation and reporting — maintain audit trail of patch status. Exception process: document compensating controls when patches cannot be applied immediately.',
    reference: 'NIST SP 800-40; AICPA TSC CC7.1',
  },
  {
    id: 'isc-d12-024',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Business Continuity',
    subtopic: 'Backup Strategies',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'The 3-2-1 backup rule recommends:',
    options: [
      'Backing up 3 files at a time',
      'Maintaining at least 3 copies of data, on 2 different types of storage media, with 1 copy stored off-site (geographically separate from the primary location)',
      'Backing up once every 3 months',
      'Using only 1 backup drive',
    ],
    correctAnswer: 1,
    explanation: 'The 3-2-1 backup rule: (1) 3 copies of data — the original plus 2 backups (protects against single point of failure), (2) 2 different media types — e.g., local disk + tape, local disk + cloud storage, NAS + removable drives (protects against media-specific failures), (3) 1 copy off-site — geographically separate from primary and on-site backup (protects against site-level disasters — fire, flood, theft). Modern extension: 3-2-1-1-0 rule — adds 1 immutable/air-gapped copy (protection against ransomware that encrypts backups) and 0 errors (regularly verify backup integrity through restoration testing). Backup types: Full (complete copy), Incremental (changes since last backup), Differential (changes since last full backup). Backup testing: regularly test restoration procedures to verify RPO/RTO can be met. CPA relevance: backup controls are part of IT general controls; availability criteria in SOC 2 (A1.2).',
    reference: 'NIST SP 800-34; AICPA TSC A1.2',
  },
  {
    id: 'isc-d12-025',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Endpoint Detection and Response',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Endpoint Detection and Response (EDR) solutions differ from traditional antivirus because:',
    options: [
      'EDR does the same thing as antivirus',
      'EDR provides continuous monitoring and recording of endpoint activities, advanced threat detection using behavioral analysis, automated response capabilities, threat hunting, and forensic investigation tools — going far beyond signature-based malware detection',
      'EDR only scans files for known viruses',
      'EDR replaces firewalls entirely',
    ],
    correctAnswer: 1,
    explanation: 'Traditional antivirus: signature-based detection — compares files against known malware signatures, effective for known threats, limited against zero-day and fileless attacks, periodic scanning. Endpoint Detection and Response (EDR): (1) Continuous monitoring — records all endpoint activities (process creation, file changes, network connections, registry modifications), (2) Behavioral analysis — detects suspicious behavior patterns even without known signatures (e.g., process injection, lateral movement, privilege escalation), (3) Threat detection — identifies advanced threats including fileless malware, living-off-the-land attacks, ransomware behavior, (4) Automated response — can isolate endpoints, kill malicious processes, rollback changes, (5) Threat hunting — proactive search for threats using telemetry data, (6) Forensic investigation — detailed timeline of events for incident investigation. XDR (Extended Detection and Response): extends EDR across endpoints, network, cloud, and email for correlated threat detection. CPA relevance: EDR is a key detective/preventive control for protecting financial systems.',
    reference: 'NIST SP 800-83; Gartner EDR Market Guide',
  },
];
