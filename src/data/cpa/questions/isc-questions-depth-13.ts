/**
 * CPA ISC Section - Questions Depth Batch 13
 * Blueprint Area: ISC-II (Security, Confidentiality, and Privacy)
 * Topics: Regulatory Compliance, Emerging Technologies, Audit Considerations, Third-Party Risk
 */

import { Question } from '../../../types';

export const ISC_QUESTIONS_DEPTH_13: Question[] = [
  {
    id: 'isc-d13-001',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Regulatory Compliance',
    subtopic: 'PCI DSS Requirements',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Payment Card Industry Data Security Standard (PCI DSS) v4.0 requires organizations that store, process, or transmit cardholder data to:',
    options: [
      'Only encrypt data during transmission',
      'Implement 12 requirement groups including: installing and maintaining network security controls, applying secure configurations, protecting stored account data, encrypting transmissions over open networks, protecting systems against malware, developing secure systems, restricting access, identifying and authenticating users, restricting physical access, logging and monitoring, testing security, and maintaining an information security policy',
      'Only scan for viruses quarterly',
      'Only change passwords annually',
    ],
    correctAnswer: 1,
    explanation: 'PCI DSS v4.0 (effective March 2024, mandatory March 2025) 12 requirement groups: (1) Install and maintain network security controls (firewalls, segmentation), (2) Apply secure configurations to all system components, (3) Protect stored account data (encryption, masking, tokenization — PAN must be rendered unreadable), (4) Protect cardholder data with strong cryptography during transmission over open, public networks, (5) Protect all systems and networks from malicious software, (6) Develop and maintain secure systems and software, (7) Restrict access to system components and cardholder data by business need to know, (8) Identify users and authenticate access to system components (MFA required), (9) Restrict physical access to cardholder data, (10) Log and monitor all access to network resources and cardholder data, (11) Test security of systems and networks regularly (vulnerability scans, pen tests), (12) Support information security with organizational policies and programs. CPA relevance: PCI DSS compliance is relevant for organizations processing payment cards; SOC 2 reports may reference PCI controls.',
    reference: 'PCI DSS v4.0',
  },
  {
    id: 'isc-d13-002',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Regulatory Compliance',
    subtopic: 'HIPAA Security Rule',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'The HIPAA Security Rule requires covered entities to implement safeguards in which three categories?',
    options: [
      'Legal, financial, and marketing safeguards',
      'Administrative safeguards, physical safeguards, and technical safeguards to protect electronic protected health information (ePHI)',
      'Only technical safeguards',
      'Environmental, political, and social safeguards',
    ],
    correctAnswer: 1,
    explanation: 'HIPAA Security Rule (45 CFR Part 164) — three categories of safeguards for ePHI: (1) Administrative safeguards — security management process, assigned security responsibility, workforce security, information access management, security awareness and training, security incident procedures, contingency plan, evaluation, business associate agreements. (2) Physical safeguards — facility access controls, workstation use and security, device and media controls. (3) Technical safeguards — access control (unique user identification, emergency access, automatic logoff, encryption), audit controls (hardware/software/procedural mechanisms to record and examine activity), integrity controls (mechanisms to authenticate ePHI), person or entity authentication, transmission security (integrity controls and encryption). Controls are either Required (must implement) or Addressable (implement or document equivalent alternative). CPA relevance: healthcare entity audits, SOC 2 reports for health tech companies, HIPAA compliance attestation.',
    reference: 'HIPAA Security Rule; 45 CFR §164.302-318',
  },
  {
    id: 'isc-d13-003',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Emerging Technologies',
    subtopic: 'AI Risk and Governance',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'From an ISC perspective, the use of artificial intelligence (AI) in financial reporting and audit raises which governance considerations?',
    options: [
      'AI risk is not relevant to CPAs',
      'Data quality and bias in training data, model transparency and explainability, validation and testing of AI outputs, ethical considerations, regulatory compliance (e.g., EU AI Act), change management, and maintaining appropriate human oversight of AI-generated results',
      'Only the cost of AI software licenses',
      'AI eliminates all need for internal controls',
    ],
    correctAnswer: 1,
    explanation: 'AI governance considerations for CPAs: (1) Data quality — AI outputs are only as reliable as training data; biased or incomplete data leads to biased results, (2) Model transparency — "black box" AI models may produce results that cannot be explained (critical for audit evidence), (3) Explainability — auditors must understand and explain how AI-derived conclusions were reached (AU-C 500 — sufficient appropriate audit evidence), (4) Validation — AI models require independent testing and validation before reliance, (5) Bias detection — statistical testing for discriminatory patterns in AI outputs, (6) Human oversight — human review of AI outputs before making decisions (human-in-the-loop), (7) EU AI Act — risk-based classification of AI systems (unacceptable, high, limited, minimal risk), high-risk AI in financial services requires conformity assessments, (8) Change management — AI models evolve; version control, model drift monitoring, retraining governance, (9) Ethics — responsible AI principles: fairness, accountability, transparency. AICPA guidance on AI in audit: AI tools may assist but do not replace professional judgment. CPA relevance: emerging area in IT governance, risk assessment, and audit methodology.',
    reference: 'AICPA AI Guidance; EU AI Act; NIST AI RMF',
  },
  {
    id: 'isc-d13-004',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Emerging Technologies',
    subtopic: 'Blockchain and Distributed Ledger',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'From an ISC controls perspective, blockchain technology impacts financial systems because:',
    options: [
      'Blockchain has no relevance to accounting or auditing',
      'It creates immutable transaction records through cryptographic hashing and consensus mechanisms — providing inherent integrity controls, but requiring new approaches to audit evidence, key management, smart contract review, and governance of decentralized systems',
      'It eliminates the need for all financial controls',
      'It only applies to cryptocurrency trading',
    ],
    correctAnswer: 1,
    explanation: 'Blockchain ISC considerations: (1) Immutability — transactions recorded on a blockchain are extremely difficult to alter (cryptographic hash chains), providing strong integrity controls, but this does not guarantee accuracy of the initial entry (garbage in, garbage out), (2) Consensus mechanisms — Proof of Work, Proof of Stake, Practical Byzantine Fault Tolerance — provide decentralized transaction validation, (3) Smart contracts — self-executing code that automates business logic; require code auditing for security vulnerabilities, logic errors, and compliance with business rules, (4) Key management — private keys control access to blockchain assets; loss of keys = loss of assets, theft of keys = theft of assets; HSMs and multi-signature wallets mitigate risk, (5) Privacy — public blockchains are transparent (all transactions visible); privacy solutions: zero-knowledge proofs, private/permissioned blockchains, (6) Audit considerations — verifying transactions on-chain, confirming ownership through private key attestation, understanding consensus mechanisms, evaluating smart contract controls. AICPA has issued guidance on auditing digital assets. CPA relevance: growing use in supply chain, financial transactions, digital assets.',
    reference: 'AICPA Practice Aid: Accounting for Digital Assets; NIST',
  },
  {
    id: 'isc-d13-005',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Third-Party Risk',
    subtopic: 'Vendor Risk Management',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An effective third-party risk management (TPRM) program should include:',
    options: [
      'Only reviewing vendor websites before signing contracts',
      'Due diligence assessment before engagement, contractual requirements for security controls, ongoing monitoring of vendor performance and security posture, SOC report review, right-to-audit clauses, incident notification requirements, and periodic reassessment of vendor risk',
      'No assessment of vendors because they handle their own security',
      'Only annual financial statement review',
    ],
    correctAnswer: 1,
    explanation: 'Third-party risk management lifecycle: (1) Risk identification — inventory all third parties, classify by criticality and data sensitivity (Tier 1: critical/sensitive data access, Tier 2: moderate, Tier 3: low risk), (2) Due diligence — pre-engagement assessment: security questionnaires, SOC 2 Type II report review, certifications (ISO 27001, SOC 2), financial stability, reputation check, (3) Contractual protections — security requirements, data processing agreements, SLAs, breach notification requirements (24-72 hour timeframes), right to audit, insurance requirements, data return/destruction at termination, (4) Ongoing monitoring — annual SOC report review, security scorecard monitoring, compliance attestations, vulnerability assessment results, (5) Incident management — vendor incident notification procedures, coordinated response, (6) Exit planning — data portability, secure data destruction, transition timeline. Focus areas: fourth-party risk (vendors of vendors), concentration risk (single vendor dependency), geopolitical risk (data residency). CPA relevance: AU-C 402 (audit considerations for service organizations); SOC 2 CC9.2 addresses vendor risk management.',
    reference: 'AICPA TSC CC9.2; AU-C 402',
  },
  {
    id: 'isc-d13-006',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Third-Party Risk',
    subtopic: 'Fourth-Party Risk',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Fourth-party risk refers to:',
    options: [
      'The risk of having exactly four vendors',
      'The risk posed by the subcontractors and service providers used by an organization\'s direct third-party vendors — creating a chain of dependency where the organization may have limited visibility into the security controls and practices of these downstream entities',
      'The risk of using four different cloud providers',
      'Risk from internal departments only',
    ],
    correctAnswer: 1,
    explanation: 'Fourth-party risk (also called "Nth-party risk" or subcontractor risk): An organization contracts with Vendor A (third party), who in turn uses Vendor B (fourth party) and Vendor C (fourth party). The organization has limited or no direct contractual relationship with fourth parties, yet data may flow through them. Challenges: (1) Limited visibility — the organization may not know which fourth parties are involved, (2) Reduced contractual control — no direct agreement with fourth parties, (3) Risk aggregation — vulnerabilities at any level can propagate upward, (4) Supply chain attacks — attackers target weaker links (e.g., SolarWinds supply chain attack affected thousands of downstream organizations). Mitigation: (1) Contractual requirements — require third parties to disclose and manage their subcontractors, flow down security requirements, (2) SOC 2 reports — request carve-out vs. inclusive method (inclusive method includes subservice organization controls), (3) Right to audit — extend audit rights to subcontractors, (4) Supply chain security — NIST SP 800-161 guidance. CPA relevance: AU-C 402 addresses subservice organizations; SOC reports distinguish between carve-out and inclusive methods.',
    reference: 'AU-C 402; NIST SP 800-161',
  },
  {
    id: 'isc-d13-007',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Privacy by Design',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'The Privacy by Design framework established by Dr. Ann Cavoukian includes seven foundational principles. Which of the following is a core principle?',
    options: [
      'Collect as much data as possible',
      'Proactive not reactive; preventative not remedial — anticipate and prevent privacy-invasive events before they happen rather than waiting for risks to materialize',
      'Privacy is optional for non-regulated industries',
      'Security and privacy are conflicting goals',
    ],
    correctAnswer: 1,
    explanation: 'Privacy by Design 7 foundational principles: (1) Proactive not Reactive; Preventative not Remedial — anticipate and prevent privacy risks before they occur, (2) Privacy as the Default Setting — no action required by the individual; privacy protections are built in automatically, (3) Privacy Embedded into Design — integrated into systems architecture and business practices, not added as an afterthought, (4) Full Functionality — Positive-Sum, not Zero-Sum — privacy and functionality coexist without trade-offs, (5) End-to-End Security — Full Lifecycle Protection — security measures from data collection through disposal, (6) Visibility and Transparency — Keep it Open — operations visible and verifiable by independent parties, (7) Respect for User Privacy — Keep it User-Centric — individual interests paramount, consent, accuracy, access, compliance. GDPR Article 25 codifies "data protection by design and by default" as a legal requirement. CPA relevance: Privacy by Design principles inform SOC 2 privacy criteria, GDPR compliance assessments, and advisory services.',
    reference: 'Privacy by Design Framework; GDPR Article 25',
  },
  {
    id: 'isc-d13-008',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Regulatory Compliance',
    subtopic: 'SOX IT Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Under Sarbanes-Oxley Act Section 404, management must assess the effectiveness of internal controls over financial reporting (ICFR). Which IT controls are most relevant?',
    options: [
      'Only password policies',
      'IT General Controls (ITGCs) including access controls, change management, IT operations, and program development — as well as application controls including input, processing, and output controls over financial applications',
      'Only virus scanning',
      'Only network speed optimization',
    ],
    correctAnswer: 1,
    explanation: 'SOX Section 404 IT controls framework: IT General Controls (ITGCs): (1) Access controls — user provisioning and deprovisioning, authentication, authorization, privileged access, periodic access reviews, (2) Change management — change request, approval, testing, deployment procedures for financial applications and databases, segregation of duties between developers and production, (3) IT operations — job scheduling, batch processing, backup and recovery, incident management, (4) Program development — SDLC methodology, requirements, design, testing, implementation. Application controls: (1) Input controls — validation, completeness, authorization of transactions (edit checks, reasonableness tests), (2) Processing controls — calculation accuracy, data integrity during processing, completeness of processing, (3) Output controls — report distribution, reconciliation, completeness verification. PCAOB AS 2201 requires auditors to understand and test ITGCs that are relevant to financial reporting. If ITGCs are deficient, they may undermine reliance on application controls. CPA relevance: core competency for CPA auditors of public companies.',
    reference: 'SOX §404; PCAOB AS 2201; COSO 2013',
  },
  {
    id: 'isc-d13-009',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Digital Forensics',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'When conducting a digital forensic investigation related to suspected financial fraud, the most critical requirement for ensuring evidence admissibility is:',
    options: [
      'Immediately deleting suspicious files',
      'Maintaining a documented chain of custody — creating forensic images (bit-for-bit copies) of evidence, using write-blockers to prevent modification, documenting every person who handles the evidence, and following established forensic methodologies',
      'Allowing all employees to review the evidence',
      'Summarizing findings verbally without documentation',
    ],
    correctAnswer: 1,
    explanation: 'Digital forensics evidence handling: Chain of custody — documented chronological record of: who collected the evidence, when, where, how it was stored, who had access, and any transfers. Essential for legal admissibility. Key procedures: (1) Identification — identify and locate potential evidence sources (computers, servers, mobile devices, cloud accounts, logs), (2) Preservation — create forensic images using write-blockers (prevent any modification to original evidence), generate hash values (MD5, SHA-256) of original and copy to verify integrity, (3) Collection — document everything: serial numbers, locations, timestamps, personnel involved, (4) Examination — analyze evidence using forensic tools (EnCase, FTK, Autopsy), recover deleted files, analyze metadata, timeline analysis, (5) Analysis — correlate findings, draw conclusions, identify relevant evidence, (6) Reporting — comprehensive report documenting methodology, findings, and conclusions, (7) Presentation — expert testimony if needed. Legal standards: Federal Rules of Evidence, Daubert standard. CPA relevance: forensic accounting investigations, fraud examinations, litigation support.',
    reference: 'NIST SP 800-86; Federal Rules of Evidence',
  },
  {
    id: 'isc-d13-010',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Network Security',
    subtopic: 'Network Segmentation',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Network segmentation as a security control works by:',
    options: [
      'Connecting all systems to one large flat network',
      'Dividing the network into smaller, isolated segments with access controls between them — limiting lateral movement if a breach occurs and containing the potential blast radius of an attack',
      'Disconnecting all systems from the network',
      'Only creating one VLAN for the entire organization',
    ],
    correctAnswer: 1,
    explanation: 'Network segmentation benefits and methods: (1) Reduced attack surface — compromising one segment does not grant access to all segments, (2) Lateral movement prevention — attackers cannot freely move between network zones, (3) Regulatory compliance — PCI DSS requires cardholder data environment segmentation, HIPAA requires ePHI network isolation, (4) Access control enforcement — granular policies between segments. Implementation methods: VLANs — virtual LANs for logical separation, Firewalls — control traffic between segments with rule sets, ACLs (Access Control Lists) — filter traffic on routers/switches, Software-Defined Networking (SDN) — programmable network policies, Micro-segmentation — granular, workload-level segmentation (Zero Trust). Common segments: DMZ (public-facing servers), internal network, management network, development/test, cardholder data environment, guest network. CPA relevance: network segmentation is a key IT control; evaluating network architecture is part of IT risk assessment for SOC and audit engagements.',
    reference: 'NIST SP 800-41; PCI DSS Requirement 1',
  },
  {
    id: 'isc-d13-011',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Emerging Technologies',
    subtopic: 'IoT Security Risks',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Internet of Things (IoT) devices in a corporate environment pose security risks because:',
    options: [
      'IoT devices have no security risks',
      'They often have limited processing power for security features, default or hardcoded credentials, infrequent firmware updates, expanded attack surface, and may communicate over insecure protocols — potentially providing entry points into the corporate network',
      'They are inherently more secure than traditional IT systems',
      'They are too small to be targets',
    ],
    correctAnswer: 1,
    explanation: 'IoT security challenges: (1) Limited resources — many IoT devices have constrained CPU, memory, and storage, limiting ability to run security software, (2) Default credentials — manufacturers often ship with default passwords that are rarely changed, publicly documented, (3) Firmware updates — many devices lack automatic update mechanisms, patches may not be available or timely, (4) Communication protocols — may use insecure or proprietary protocols without encryption, (5) Visibility — organizations may not have complete visibility into all IoT devices on their network (shadow IoT), (6) Attack surface — each connected device is a potential entry point; Mirai botnet exploited IoT devices for massive DDoS attacks, (7) Physical access — IoT devices may be deployed in physically accessible locations. Mitigation: network segmentation (isolate IoT on separate VLAN), device inventory and monitoring, change default credentials, firmware management, encryption, regular vulnerability scanning, disable unnecessary services. CPA relevance: IoT devices in manufacturing, building management, and retail environments create IT risks that affect control environment assessment.',
    reference: 'NIST SP 800-183; NISTIR 8259',
  },
  {
    id: 'isc-d13-012',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Identity and Access Management',
    subtopic: 'Single Sign-On and Federation',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'Single Sign-On (SSO) provides security benefits by:',
    options: [
      'Requiring users to remember many different passwords',
      'Allowing users to authenticate once and access multiple applications without re-entering credentials — reducing password fatigue, decreasing help desk calls, enabling centralized access control and monitoring, and facilitating consistent enforcement of authentication policies',
      'Eliminating the need for any authentication',
      'Only working for email applications',
    ],
    correctAnswer: 1,
    explanation: 'Single Sign-On (SSO) benefits and mechanisms: Benefits: (1) Reduced password fatigue — users remember one strong credential rather than many weak ones, (2) Improved security — fewer passwords means fewer to compromise, enables stronger authentication (MFA at the SSO provider), (3) Centralized access control — single point for provisioning/deprovisioning user access, (4) Audit trail — centralized logging of authentication events, (5) Reduced help desk burden — fewer password reset requests. SSO protocols: SAML 2.0 (Security Assertion Markup Language) — XML-based, widely used for enterprise SSO, OAuth 2.0 — authorization framework (delegated access), OpenID Connect (OIDC) — identity layer built on OAuth 2.0. Identity Federation: extends SSO across organizational boundaries using trust relationships. Risk considerations: SSO creates a high-value target (compromising the SSO account compromises ALL applications) — mitigated by strong MFA, anomaly detection, and session management. CPA relevance: SSO is a key access control for financial applications; IAM controls are evaluated in SOC and SOX audits.',
    reference: 'NIST SP 800-63; OASIS SAML 2.0',
  },
  {
    id: 'isc-d13-013',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Change Management Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'IT change management controls for financial systems should include:',
    options: [
      'Making changes directly in production without approval',
      'A formal change request and approval process, impact assessment, testing in non-production environments, segregation of duties between developers and operations, rollback procedures, documentation, and post-implementation review',
      'Only verbal approval from any employee',
      'Unlimited developer access to production',
    ],
    correctAnswer: 1,
    explanation: 'IT change management controls (ITIL, COBIT, SOX): (1) Change request — formal documentation of the proposed change, business justification, and impact assessment, (2) Classification — categorize changes: standard (pre-approved, low risk), normal (requires CAB approval), emergency (expedited process with retrospective review), (3) Change Advisory Board (CAB) — review and approve changes, assess risk and priority, (4) Testing — thorough testing in development and staging environments before production deployment, including regression testing, (5) Segregation of duties — developers should NOT have direct access to migrate changes to production; separate roles for development, testing, and deployment, (6) Implementation — follow approved implementation plan, schedule during maintenance windows when possible, (7) Rollback plan — documented procedure to revert changes if issues arise, (8) Post-implementation review — verify change was successful, no unintended consequences, update documentation, (9) Emergency changes — expedited approval process with mandatory retrospective review and documentation. CPA relevance: change management is a key ITGC for SOX compliance and SOC reports.',
    reference: 'ITIL v4; COBIT 2019; PCAOB AS 2201',
  },
  {
    id: 'isc-d13-014',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Incident Response',
    subtopic: 'Ransomware Response',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'When an organization discovers a ransomware attack that has encrypted critical financial systems, the recommended response includes:',
    options: [
      'Immediately pay the ransom to recover data quickly',
      'Isolate affected systems to prevent spread, activate the incident response plan, assess scope and impact, preserve evidence, evaluate recovery options from backups, engage law enforcement and legal counsel, communicate with stakeholders, and restore systems from known-clean backups while addressing the vulnerability that was exploited',
      'Shut down all systems permanently',
      'Ignore the attack and hope it resolves itself',
    ],
    correctAnswer: 1,
    explanation: 'Ransomware incident response (CISA, FBI, NIST guidance): (1) Isolate — immediately disconnect affected systems from the network to prevent lateral spread, do NOT power off (may destroy forensic evidence in memory), (2) Activate IR plan — mobilize incident response team, establish command structure, (3) Assess scope — determine which systems are affected, what data is encrypted, whether data was exfiltrated (double extortion), (4) Preserve evidence — forensic imaging of affected systems for investigation and law enforcement, (5) Determine recovery options — restore from clean, verified backups (test backup integrity before restoring), consider recovery time vs. ransom payment (FBI generally advises against paying — no guarantee of decryption, funds criminal activity, makes organization a repeat target), (6) Engage stakeholders — legal counsel (breach notification obligations), law enforcement (FBI IC3, CISA), cyber insurance carrier, PR/communications, (7) Eradicate — identify and remediate the initial infection vector (phishing, RDP, vulnerability), (8) Recover — restore from backups, rebuild affected systems, verify data integrity, (9) Post-incident — lessons learned, update controls, improve backup strategy, enhance security awareness training. CPA relevance: financial impact assessment, disclosure requirements (SEC Form 8-K for material incidents), business interruption insurance claims.',
    reference: 'CISA Ransomware Guide; NIST SP 800-61',
  },
  {
    id: 'isc-d13-015',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'De-identification Techniques',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An organization wants to use customer data for analytics while protecting privacy. Which technique reduces the risk of identifying individuals?',
    options: [
      'Publishing the data without any modifications',
      'Data anonymization techniques such as pseudonymization (replacing identifiers with artificial identifiers), k-anonymity (ensuring each record is indistinguishable from at least k-1 others), differential privacy (adding calibrated noise), or data masking (obscuring specific data values)',
      'Adding more personal identifiers',
      'Encrypting with a shared public key they post online',
    ],
    correctAnswer: 1,
    explanation: 'De-identification and anonymization techniques: (1) Pseudonymization — replace direct identifiers (names, SSN) with pseudonyms or tokens; reversible with a key; considered personal data under GDPR (reduced risk, not anonymous), (2) Anonymization — irreversibly remove all identifying information; properly anonymized data is NOT personal data under GDPR; techniques include generalization, suppression, perturbation, (3) K-anonymity — ensure each combination of quasi-identifiers (age, zip code, gender) appears in at least k records; prevents singling out individuals, (4) L-diversity — extends k-anonymity; ensures at least l distinct values for sensitive attributes within each equivalence class, (5) Differential privacy — add calibrated random noise to query results; provides mathematical guarantee that individual records cannot be identified; used by Apple and Google for analytics, (6) Data masking — replace real data with realistic but fictitious data; static masking (permanent) or dynamic masking (on-the-fly for specific users), (7) Tokenization — replace sensitive data with non-sensitive tokens; original data stored securely in token vault. Risk: re-identification attacks can combine anonymized data with external datasets. CPA relevance: privacy controls assessment, SOC 2 privacy criteria.',
    reference: 'NIST SP 800-188; GDPR Recital 26',
  },
  {
    id: 'isc-d13-016',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Cloud Security',
    subtopic: 'Container and Serverless Security',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Organizations using containerized applications (Docker, Kubernetes) for financial systems should implement which security controls?',
    options: [
      'No additional controls are needed for containers',
      'Container image scanning for vulnerabilities before deployment, image signing and provenance verification, least-privilege runtime configurations, network policies between containers, secrets management (not hardcoded in images), runtime monitoring, and regular updates of base images',
      'Only scanning containers after deployment',
      'Using default container configurations',
    ],
    correctAnswer: 1,
    explanation: 'Container security best practices (NIST SP 800-190): (1) Image security — scan images for vulnerabilities before deployment, use trusted base images from verified registries, sign images (content trust/Notary), minimize image size (reduce attack surface), avoid running as root, (2) Registry security — use private registries with access controls, scan images in registry, enforce image policies (only approved images), (3) Orchestrator security (Kubernetes) — RBAC (Role-Based Access Control), pod security standards, network policies (restrict pod-to-pod communication), secrets management (Kubernetes Secrets, HashiCorp Vault — not hardcoded), (4) Runtime security — monitor container behavior for anomalies, implement resource limits (CPU, memory), use read-only file systems where possible, runtime protection tools (Falco, Sysdig), (5) Network — micro-segmentation using network policies, TLS between services (service mesh — Istio), (6) Logging and monitoring — centralized logging of container events, audit logs for orchestrator actions. Supply chain: ensure CI/CD pipeline includes security scanning at each stage. CPA relevance: financial applications increasingly deployed in containers; understanding container security is relevant for IT risk assessment.',
    reference: 'NIST SP 800-190; CIS Kubernetes Benchmark',
  },
  {
    id: 'isc-d13-017',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Regulatory Compliance',
    subtopic: 'SEC Cybersecurity Disclosure Rules',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Under the SEC\'s 2023 cybersecurity disclosure rules, public companies must:',
    options: [
      'Only disclose cybersecurity incidents in annual reports',
      'Disclose material cybersecurity incidents on Form 8-K within four business days of determining materiality, describe cybersecurity risk management processes and governance in annual reports (Form 10-K), and disclose the board of directors\' oversight of cybersecurity risk and management\'s role in assessing and managing such risks',
      'Only report to CISA, not shareholders',
      'Only disclose if data was stolen',
    ],
    correctAnswer: 1,
    explanation: 'SEC Cybersecurity Disclosure Rules (effective December 2023): Incident Disclosure (Form 8-K, Item 1.05): (1) Report material cybersecurity incidents within 4 business days of determining materiality (not of discovering the incident), (2) Describe the nature, scope, and timing of the incident, (3) Describe the material impact or reasonably likely material impact on the company (financial condition, results of operations), (4) May delay disclosure if the U.S. Attorney General determines immediate disclosure would pose substantial risk to national security or public safety. Annual Disclosure (Form 10-K, Regulation S-K Item 106): (1) Risk management and strategy — describe processes for assessing, identifying, and managing material cybersecurity risks, whether any risks have materially affected or are reasonably likely to materially affect the company, engagement of third-party assessors, (2) Governance — describe the board\'s oversight of cybersecurity risk (committee responsibilities, expertise, frequency of briefings), management\'s role in assessing and managing cybersecurity risks. CPA relevance: external auditors consider cybersecurity disclosures; management\'s cybersecurity representations affect audit risk assessment.',
    reference: 'SEC Release No. 33-11216; 17 CFR §229.106',
  },
  {
    id: 'isc-d13-018',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Physical Security',
    subtopic: 'Physical Access Controls',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Physical security controls for a data center should include:',
    options: [
      'Only a locked front door',
      'Multiple layers of physical controls including perimeter security (fencing, bollards), access control systems (badge readers, biometric scanners), visitor management, surveillance cameras (CCTV), environmental controls (fire suppression, HVAC, UPS), and security guards — following a defense-in-depth approach',
      'A single security camera',
      'No controls because data centers are usually in safe areas',
    ],
    correctAnswer: 1,
    explanation: 'Data center physical security (defense-in-depth): Layer 1 — Perimeter: fencing, bollards, security gates, lighting, landscaping for natural surveillance. Layer 2 — Building: reinforced construction, limited entry points, blast protection, mantrap/airlock entries. Layer 3 — Access controls: card readers, biometric authentication (fingerprint, iris), PIN pads, multi-factor physical authentication. Layer 4 — Interior: surveillance cameras (CCTV) with recording, visitor management (escorted access, visitor logs), server rack locks, cable locks. Layer 5 — Environmental: fire detection and suppression (FM-200, Novec 1230 — not water in equipment areas), HVAC (temperature and humidity control), UPS (Uninterruptible Power Supply), backup generators, water detection sensors. Layer 6 — Monitoring: 24/7 security operations center (SOC), alarm systems, motion sensors. Additional: asset tracking, secure disposal of storage media, clean desk policy. CPA relevance: physical security is part of IT general controls; SOC 2 CC6.4 addresses physical access controls; data center audits evaluate physical security layers.',
    reference: 'NIST SP 800-53 PE controls; AICPA TSC CC6.4',
  },
  {
    id: 'isc-d13-019',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Security Metrics and KPIs',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Meaningful security metrics for management reporting should include:',
    options: [
      'Only the total number of firewalls installed',
      'Key performance indicators such as mean time to detect (MTTD) and respond (MTTR) to incidents, patch compliance rate, vulnerability remediation time, percentage of systems with current antivirus/EDR, phishing simulation click rates, and audit finding remediation status',
      'Only the IT security budget amount',
      'Number of emails received',
    ],
    correctAnswer: 1,
    explanation: 'Security metrics and KPIs (NIST SP 800-55): Operational metrics: (1) Mean Time to Detect (MTTD) — average time from threat occurrence to detection (lower is better), (2) Mean Time to Respond (MTTR) — average time from detection to containment/remediation, (3) Mean Time to Recover — time to restore normal operations. Vulnerability management: (4) Patch compliance rate — percentage of systems with current patches, (5) Vulnerability remediation time — average days to remediate by severity (critical: <48 hours), (6) Open vulnerability count by severity. Access control: (7) Dormant account percentage, (8) Access review completion rate, (9) Privileged account count and review status. Awareness: (10) Phishing simulation click rate (trending), (11) Security training completion rate. Compliance: (12) Audit finding remediation status (open/closed/overdue), (13) Policy exception count. Risk: (14) Third-party risk assessment completion, (15) Business impact analysis currency. Best practice: report security metrics to the board regularly (at least quarterly); align metrics with business objectives and risk appetite. CPA relevance: security metrics demonstrate control effectiveness for SOC and SOX assessments.',
    reference: 'NIST SP 800-55; ISACA COBIT 2019',
  },
  {
    id: 'isc-d13-020',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Regulatory Compliance',
    subtopic: 'SOX IT Audit Procedures',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'When auditing IT controls under PCAOB AS 2201, an auditor evaluating user access controls should:',
    options: [
      'Only review the access control policy without testing',
      'Test both the design and operating effectiveness of access controls by examining user provisioning and deprovisioning procedures, reviewing access rights for appropriateness (periodic access reviews), testing segregation of duties, verifying authentication mechanisms, and evaluating privileged access management',
      'Only count the number of user accounts',
      'Accept management\'s assertion without testing',
    ],
    correctAnswer: 1,
    explanation: 'PCAOB AS 2201 IT access control audit procedures: Design effectiveness testing: (1) Obtain and review access control policies and procedures, (2) Understand user provisioning workflow (request, approval, implementation), (3) Evaluate segregation of duties matrix, (4) Review authentication configuration (password complexity, MFA, session timeouts). Operating effectiveness testing: (1) User provisioning — select a sample of new users, verify proper approval before access was granted, verify appropriate access level assigned, (2) User deprovisioning — select a sample of terminated employees, verify timely access removal (within 1 business day), (3) Periodic access reviews — verify management performs regular reviews of user access rights, review evidence of reviews and remediation actions, (4) Privileged access — obtain list of privileged accounts, verify each is appropriate and approved, test for shared accounts, (5) Segregation of duties — test for conflicting access (e.g., can create vendors AND approve payments), (6) Generic/shared accounts — identify and evaluate compensating controls. Common deficiency: untimely deprovisioning of terminated employee access — significant deficiency or material weakness depending on severity.',
    reference: 'PCAOB AS 2201; SOX §404',
  },
  {
    id: 'isc-d13-021',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Emerging Technologies',
    subtopic: 'Quantum Computing Implications',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Quantum computing poses a significant threat to current cybersecurity because:',
    options: [
      'Quantum computers are already widely available and breaking all encryption',
      'Sufficiently powerful quantum computers could break widely used public-key cryptographic algorithms (RSA, ECC) using Shor\'s algorithm — organizations should begin planning for post-quantum cryptography migration by inventorying cryptographic assets and monitoring NIST post-quantum standards',
      'Quantum computing has no impact on security',
      'Quantum computers only affect gaming applications',
    ],
    correctAnswer: 1,
    explanation: 'Quantum computing impact on cryptography: Threat: Shor\'s algorithm (1994) can factor large numbers efficiently on a quantum computer, breaking: RSA (depends on factoring difficulty), ECC (depends on discrete logarithm), Diffie-Hellman key exchange. Current status: practical cryptographically relevant quantum computers (CRQC) do not yet exist, but are expected within 10-20 years. "Harvest now, decrypt later": adversaries may collect encrypted data today and decrypt it when quantum computers are available — particularly relevant for data with long-term sensitivity (government secrets, financial records). NIST Post-Quantum Cryptography (PQC) standardization: (1) FIPS 203 — ML-KEM (CRYSTALS-Kyber) for key encapsulation, (2) FIPS 204 — ML-DSA (CRYSTALS-Dilithium) for digital signatures, (3) FIPS 205 — SLH-DSA (SPHINCS+) for hash-based digital signatures. Migration planning: (1) Cryptographic inventory — identify all systems using vulnerable algorithms, (2) Risk assessment — prioritize based on data sensitivity and longevity, (3) Crypto-agility — design systems to swap algorithms without major redesign, (4) Hybrid approach — use both classical and post-quantum algorithms during transition. CPA relevance: long-term data protection strategy, risk disclosure, emerging IT risk assessment.',
    reference: 'NIST FIPS 203-205; NIST SP 800-208',
  },
  {
    id: 'isc-d13-022',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Security Architecture Principles',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'The principle of "defense in depth" means:',
    options: [
      'Using a single strong firewall',
      'Implementing multiple layers of security controls so that if one control fails, other controls continue to provide protection — no single point of failure for security',
      'Placing all security measures at the network perimeter only',
      'Training only the security team',
    ],
    correctAnswer: 1,
    explanation: 'Defense in depth (layered security): Principle: implement multiple, overlapping layers of security controls at different levels of the IT environment. If one layer is bypassed or fails, other layers continue to provide protection. Layers: (1) Policies, procedures, and awareness — governance foundation, (2) Physical security — facility access, locks, cameras, (3) Perimeter — firewalls, DMZ, IDS/IPS, DDoS protection, (4) Network — segmentation, VLANs, network access control (NAC), (5) Host/Endpoint — OS hardening, EDR, host-based firewall, patch management, (6) Application — secure coding, input validation, WAF, application-level authentication, (7) Data — encryption (at rest, in transit, in use), DLP (Data Loss Prevention), classification, access controls, backup. Related principles: least privilege — minimum necessary access, separation of duties — prevent single points of failure or fraud, fail securely — system defaults to secure state on failure, economy of mechanism — keep security controls simple to reduce errors. CPA relevance: defense in depth is a foundational concept for evaluating IT control environments in audit and SOC engagements.',
    reference: 'NIST SP 800-53; NSA Defense in Depth Guide',
  },
  {
    id: 'isc-d13-023',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Subject Rights',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Under GDPR, a data subject exercises their "right to be forgotten" (right to erasure). The data controller must:',
    options: [
      'Ignore the request',
      'Erase the personal data without undue delay, unless an exception applies (e.g., legal obligation to retain, exercise of legal claims, public interest, freedom of expression), and notify any third parties to whom the data was disclosed',
      'Only delete the data after 10 years',
      'Charge a fee for each erasure request',
    ],
    correctAnswer: 1,
    explanation: 'GDPR Article 17 — Right to Erasure ("Right to be Forgotten"): Data controller must erase personal data without undue delay when: (1) data is no longer necessary for the purpose it was collected, (2) data subject withdraws consent (and no other legal basis exists), (3) data subject objects to processing (Article 21) and no overriding legitimate grounds exist, (4) data has been unlawfully processed, (5) erasure is required to comply with a legal obligation, (6) data was collected in relation to offering information society services to a child. Exceptions (controller may refuse): (a) exercising the right of freedom of expression and information, (b) compliance with a legal obligation (e.g., tax records retention), (c) public health purposes, (d) archiving in the public interest, scientific or historical research, (e) establishment, exercise, or defense of legal claims. Controller must: notify all third parties who received the data, take reasonable steps to inform other controllers processing the data. Response timeframe: without undue delay (typically within 1 month). CPA relevance: privacy compliance assessments, SOC 2 privacy criteria P6.',
    reference: 'GDPR Article 17; AICPA TSC P6',
  },
  {
    id: 'isc-d13-024',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Security Governance Framework',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'A comprehensive information security governance framework should establish:',
    options: [
      'Only technical security controls',
      'Clear roles and responsibilities, information security policies aligned with business objectives, risk management processes, compliance monitoring, security awareness programs, incident management procedures, and regular reporting to executive leadership and the board of directors',
      'Only an annual security review',
      'Only a cybersecurity insurance policy',
    ],
    correctAnswer: 1,
    explanation: 'Information security governance (ISO 27014, COBIT 2019): (1) Strategic alignment — security strategy aligned with business objectives and risk appetite, (2) Roles and responsibilities — Chief Information Security Officer (CISO), security team, data owners, system owners, all employees, board oversight, (3) Policy framework — information security policy, acceptable use, data classification, incident response, access control, business continuity policies — reviewed annually, (4) Risk management — risk identification, assessment, treatment, acceptance, monitoring (ISO 31000, NIST RMF), (5) Compliance — regulatory compliance monitoring (SOX, HIPAA, GDPR, PCI DSS), internal audit of security controls, (6) Performance measurement — security metrics and KPIs, periodic security assessments and audits, (7) Resource management — adequate budget, staffing, training, (8) Reporting — regular reporting to executive management and board (quarterly minimum), (9) Culture — security awareness as part of organizational culture, tone at the top. CPA relevance: security governance is part of the entity-level control environment assessment (COSO principle 11 — selects and develops general controls over technology).',
    reference: 'ISO 27014; COBIT 2019; COSO 2013',
  },
  {
    id: 'isc-d13-025',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Third-Party Risk',
    subtopic: 'SOC Report Considerations',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'When reviewing a service organization\'s SOC 2 Type II report, a user entity auditor should pay particular attention to:',
    options: [
      'Only the service auditor\'s opinion',
      'The service auditor\'s opinion (modified or unmodified), the description of the system, the trust services criteria covered, the testing performed and results (any exceptions noted), complementary user entity controls (CUECs) that the user entity must implement, and the period covered by the report',
      'Only the number of pages',
      'Only whether the report mentions the user entity by name',
    ],
    correctAnswer: 1,
    explanation: 'SOC 2 Type II report analysis: (1) Service auditor\'s opinion — unmodified (clean) vs. modified (qualified, adverse, disclaimer); a modified opinion requires careful evaluation of the exceptions and their impact, (2) System description — understand the boundaries of the system covered, services provided, infrastructure, software, people, data, (3) Trust services criteria — which criteria are covered: Security (required), Availability, Processing Integrity, Confidentiality, Privacy — evaluate whether the criteria covered are relevant to your organization\'s needs, (4) Testing and results — review each control objective, the tests performed, and any exceptions or deviations noted; assess whether exceptions are relevant to your use of the service, (5) Complementary User Entity Controls (CUECs) — controls that the service organization expects the user entity to implement for overall control effectiveness (e.g., user access management, input validation); user entity auditor must verify these are in place, (6) Complementary Subservice Organization Controls (CSOCs) — controls at subservice organizations (carve-out vs. inclusive method), (7) Period covered — check for gaps between report periods, (8) Management response to exceptions. CPA relevance: AU-C 402 requires auditors to understand and evaluate SOC reports for service organizations used by audit clients.',
    reference: 'AU-C 402; AICPA SOC 2; AT-C 205',
  },
];
