// ISC Depth Questions - Batch 2
// Focus: More SOC (ISC-V), BCP/DR (ISC-III), Network Security (ISC-II),
// Change Management (ISC-III), Data Privacy depth (ISC-IV)

import { Question } from '../../../types';

export const ISC_QUESTIONS_DEPTH_2: Question[] = [
  // ==========================================
  // ISC-V: MORE SOC REPORTING
  // ==========================================
  {
    id: 'isc-d2-001',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-V',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'Management Assertions',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'In a SOC 2 Type II engagement, management\'s assertion includes a statement that:',
    options: [
      'The description of the system is fairly presented, and controls were suitably designed and operating effectively throughout the period',
      'The auditor agrees with management\'s risk assessment',
      'The entity complies with all applicable laws',
      'The entity has never experienced a security breach',
    ],
    correctAnswer: 0,
    explanation: 'Management\'s assertion in a SOC 2 Type II report states: (1) the description of the system is presented in accordance with the description criteria, (2) the controls stated in the description were suitably designed to meet the applicable Trust Services Criteria, and (3) the controls operated effectively throughout the specified period. The practitioner then expresses an opinion on these assertions.',
    reference: 'AT-C 205.37',
  },
  {
    id: 'isc-d2-002',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-V',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'Report Users',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'A SOC 1 report is primarily intended for use by:',
    options: [
      'The service organization\'s competitors for benchmarking',
      'The service organization\'s management, user entities, and user entity auditors',
      'Regulatory agencies only',
      'The general public',
    ],
    correctAnswer: 1,
    explanation: 'SOC 1 reports are restricted-use reports intended for: (1) service organization management — to demonstrate control effectiveness, (2) user entities (clients) — to understand controls at the service organization, and (3) user entity auditors — to evaluate the impact of service organization controls on their audit. User entity auditors rely on SOC 1 reports under AU-C 402 (Audit Considerations Relating to an Entity Using a Service Organization).',
    reference: 'AT-C 320.56; AU-C 402',
  },
  {
    id: 'isc-d2-003',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-V',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'Monitoring Controls',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'When evaluating a SOC 2 report, a user entity auditor identifies a control exception. The MOST appropriate response is to:',
    options: [
      'Request the service organization to restate the report',
      'Issue a qualified audit opinion immediately',
      'Evaluate the nature and extent of the exception and determine if the user entity\'s compensating controls mitigate the risk',
      'Disregard the SOC report entirely',
    ],
    correctAnswer: 2,
    explanation: 'A control exception does not automatically invalidate the SOC report. The user entity auditor should: (1) evaluate the nature, cause, and frequency of the exception, (2) assess whether it affects the controls relevant to the user entity\'s financial reporting, (3) determine if compensating controls at the service organization or user entity mitigate the risk, and (4) consider the effect on the audit plan — additional testing may be needed.',
    reference: 'AU-C 402.17-20',
  },

  // ==========================================
  // ISC-III: BUSINESS CONTINUITY & DISASTER RECOVERY
  // ==========================================
  {
    id: 'isc-d2-004',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-bcdr',
    topic: 'Business Continuity',
    subtopic: 'RTO and RPO',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Recovery Time Objective (RTO) measures:',
    options: [
      'The total cost of disaster recovery',
      'The number of backup copies maintained',
      'The maximum acceptable time to restore a system after a disruption',
      'The maximum amount of data loss an organization can tolerate',
    ],
    correctAnswer: 2,
    explanation: 'RTO = maximum time to restore a system/process after disruption. RPO (Recovery Point Objective) = maximum acceptable data loss measured in time (e.g., RPO of 4 hours means backups must be no more than 4 hours old). Together, RTO and RPO drive backup strategy: RPO determines backup frequency; RTO determines recovery technology (hot site vs. warm vs. cold). Both are determined by business impact analysis (BIA).',
    reference: 'NIST SP 800-34 Rev. 1',
  },
  {
    id: 'isc-d2-005',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-bcdr',
    topic: 'Business Continuity',
    subtopic: 'Hot, Warm, Cold Sites',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'A hot site disaster recovery facility is characterized by:',
    options: [
      'A fully equipped facility with hardware, software, and current data — ready for immediate failover',
      'A facility with hardware but no data replication',
      'A mobile trailer with basic computing equipment',
      'An empty building with power and HVAC only',
    ],
    correctAnswer: 0,
    explanation: 'Recovery site types: (1) Hot site — fully operational with hardware, software, network, and real-time data replication; immediate failover (RTO: minutes to hours); most expensive, (2) Warm site — has hardware and connectivity but requires data restoration; RTO: hours to days, (3) Cold site — empty facility with power/HVAC; requires equipment installation; RTO: days to weeks; least expensive. Cloud-based DR is increasingly used as a cost-effective alternative.',
    reference: 'NIST SP 800-34 Rev. 1',
  },
  {
    id: 'isc-d2-006',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-bcdr',
    topic: 'Business Continuity',
    subtopic: 'BCP Testing',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'The MOST comprehensive type of business continuity plan (BCP) test is a:',
    options: [
      'Full interruption test',
      'Tabletop exercise',
      'Parallel test',
      'Checklist review',
    ],
    correctAnswer: 0,
    explanation: 'BCP test types in order of increasing rigor: (1) Checklist review — team reviews the plan document, (2) Structured walk-through/tabletop — team discusses scenarios and responses, (3) Simulation test — simulates a disaster scenario without activating recovery, (4) Parallel test — recovery systems are activated alongside production (no disruption), (5) Full interruption — production is actually shut down and recovery is activated. Full interruption is most comprehensive but carries the highest risk.',
    reference: 'ISO 22301; NIST SP 800-34',
  },
  {
    id: 'isc-d2-007',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-bcdr',
    topic: 'Business Continuity',
    subtopic: 'Business Impact Analysis',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A Business Impact Analysis (BIA) is used to:',
    options: [
      'Perform financial statement audits',
      'Identify critical business processes and the impact of their disruption, including recovery priorities',
      'Deploy new software applications',
      'Test the effectiveness of security controls',
    ],
    correctAnswer: 1,
    explanation: 'BIA identifies: (1) critical business processes and systems, (2) the financial, operational, and reputational impact of disruption over time, (3) maximum tolerable downtime (MTD) for each process, (4) dependencies between processes, (5) recovery priorities — which systems to restore first. BIA results drive RTO/RPO requirements and inform the selection of recovery strategies. It should be updated annually or when significant changes occur.',
    reference: 'ISO 22301; NIST SP 800-34',
  },

  // ==========================================
  // ISC-III: CHANGE MANAGEMENT & SDLC
  // ==========================================
  {
    id: 'isc-d2-008',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-change-mgmt',
    topic: 'Change Management',
    subtopic: 'Change Control Process',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'In an IT change management process, the purpose of a Change Advisory Board (CAB) is to:',
    options: [
      'Evaluate proposed changes, assess risks, and approve or reject changes before implementation',
      'Monitor production systems after changes',
      'Perform user acceptance testing',
      'Write program code for changes',
    ],
    correctAnswer: 0,
    explanation: 'A Change Advisory Board (CAB) is a cross-functional group that reviews change requests to assess: (1) business justification, (2) risk and impact analysis, (3) resource requirements, (4) testing adequacy, (5) rollback plan. The CAB approves, defers, or rejects changes. Emergency changes may bypass the CAB but must be documented and reviewed retroactively. ITIL defines the CAB as part of the change enablement practice.',
    reference: 'ITIL 4; COBIT 2019 BAI06',
  },
  {
    id: 'isc-d2-009',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-change-mgmt',
    topic: 'Systems Development',
    subtopic: 'SDLC Phases',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'The correct sequence of traditional SDLC (Systems Development Life Cycle) phases is:',
    options: [
      'Planning/Requirements → Design → Development → Testing → Implementation → Maintenance',
      'Requirements → Implementation → Testing → Design → Deployment',
      'Development → Design → Testing → Planning → Support',
      'Design → Planning → Testing → Implementation → Maintenance',
    ],
    correctAnswer: 0,
    explanation: 'Traditional (waterfall) SDLC phases: (1) Planning/Feasibility, (2) Requirements Analysis, (3) System Design, (4) Development/Coding, (5) Testing (unit, integration, system, UAT), (6) Implementation/Deployment, (7) Operations and Maintenance. Agile methodologies use iterative cycles (sprints) but still address the same concerns: requirements, design, coding, testing, deployment. Post-implementation reviews assess whether objectives were met.',
    reference: 'NIST SP 800-64 Rev. 2',
  },
  {
    id: 'isc-d2-010',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-change-mgmt',
    topic: 'Change Management',
    subtopic: 'Segregation of Environments',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A critical IT general control is the separation of development, testing, and production environments. This separation primarily prevents:',
    options: [
      'Backup failures',
      'Unauthorized or untested code from being moved directly into the production environment',
      'Users from accessing the internet',
      'Hardware failures in production',
    ],
    correctAnswer: 1,
    explanation: 'Environment separation ensures: (1) developers cannot modify production directly — reducing risk of introducing bugs or malicious code, (2) testing is performed in a controlled environment before deployment, (3) audit trail exists for all code promotions, (4) data integrity is maintained — test data doesn\'t corrupt production. Code promotion should require approval from someone independent of the developer. Many SOX IT audits specifically test this control.',
    reference: 'COBIT 2019 BAI07; SOX ITGC Guidance',
  },

  // ==========================================
  // ISC-II: NETWORK & ACCESS SECURITY
  // ==========================================
  {
    id: 'isc-d2-011',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Network Security',
    subtopic: 'Firewall Types',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'A next-generation firewall (NGFW) differs from a traditional packet-filtering firewall in that it:',
    options: [
      'Does not inspect network traffic',
      'Provides application-level inspection, intrusion prevention, and identity awareness',
      'Is less secure than a traditional firewall',
      'Can only filter by IP address',
    ],
    correctAnswer: 1,
    explanation: 'NGFWs combine traditional packet filtering with: (1) deep packet inspection (DPI) — inspects application layer content, (2) intrusion prevention systems (IPS), (3) application awareness — controls based on application (not just port/protocol), (4) identity awareness — policies based on user identity, (5) SSL/TLS decryption for inspecting encrypted traffic, (6) threat intelligence integration. Traditional firewalls only filter by source/destination IP and port.',
    reference: 'NIST SP 800-41 Rev. 1',
  },
  {
    id: 'isc-d2-012',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Access Control',
    subtopic: 'Multi-Factor Authentication',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Multi-factor authentication (MFA) requires at least two of which three factor categories?',
    options: [
      'Email, phone number, and physical address',
      'First name, last name, and date of birth',
      'Something you know, something you have, and something you are',
      'Username, password, and security question',
    ],
    correctAnswer: 2,
    explanation: 'The three authentication factor categories: (1) Something you know — password, PIN, security question; (2) Something you have — smart card, hardware token, mobile phone (SMS/app); (3) Something you are — biometrics (fingerprint, facial recognition, retina scan). Effective MFA requires at least two DIFFERENT categories. Two passwords are not MFA (same category). NIST SP 800-63B recommends phishing-resistant MFA (FIDO2/WebAuthn) over SMS.',
    reference: 'NIST SP 800-63B',
  },
  {
    id: 'isc-d2-013',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Access Control',
    subtopic: 'Privileged Access Management',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'Privileged Access Management (PAM) controls should include all of the following EXCEPT:',
    options: [
      'Granting all IT staff permanent administrative access for efficiency',
      'Password vaulting with automated rotation',
      'Just-in-time (JIT) elevation of privileges',
      'Session recording for administrative activities',
    ],
    correctAnswer: 0,
    explanation: 'PAM best practices: (1) least privilege — no permanent admin access; use JIT elevation, (2) password vaulting — secure storage with automated rotation and check-out/check-in, (3) session monitoring/recording — full audit trail of privileged actions, (4) break-glass procedures — emergency access with dual authorization, (5) access reviews — regular recertification of privileged accounts. Granting permanent admin access to all IT staff is a major control weakness and violation of least privilege.',
    reference: 'NIST SP 800-53 AC-6; CIS Controls v8',
  },

  // ==========================================
  // ISC-IV: DATA PRIVACY & GOVERNANCE
  // ==========================================
  {
    id: 'isc-d2-014',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-IV',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Privacy by Design',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'The "privacy by design" principle requires that:',
    options: [
      'Privacy considerations are addressed only during annual audits',
      'Users must opt in to privacy protections after deployment',
      'Privacy protections are embedded into systems and processes from the initial design stage',
      'Privacy settings are configured only after a data breach occurs',
    ],
    correctAnswer: 2,
    explanation: 'Privacy by Design (Dr. Ann Cavoukian\'s framework, codified in GDPR Article 25) requires: (1) proactive, not reactive measures, (2) privacy as the default setting, (3) privacy embedded into design, (4) full functionality without trade-offs, (5) end-to-end security throughout the data lifecycle, (6) visibility and transparency, (7) respect for user privacy. Organizations must implement data protection measures at the time of design, not as an afterthought.',
    reference: 'GDPR Article 25; ISO 31700',
  },
  {
    id: 'isc-d2-015',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-IV',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Classification',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'The purpose of data classification is to:',
    options: [
      'Convert all data to a common format',
      'Categorize data by sensitivity level to apply appropriate security controls and handling procedures',
      'Reduce storage costs by deleting old data',
      'Eliminate the need for access controls',
    ],
    correctAnswer: 1,
    explanation: 'Data classification assigns sensitivity labels (e.g., Public, Internal, Confidential, Restricted/Secret) to data assets. Benefits: (1) appropriate security controls applied based on sensitivity (encryption, access restrictions), (2) cost-effective — most resources protect highest-sensitivity data, (3) regulatory compliance — PII, PHI, PCI data receive mandated protections, (4) user awareness — employees know handling requirements, (5) retention guidance — different classification levels may have different retention periods.',
    reference: 'NIST SP 800-60; ISO 27001 A.8.2',
  },

  // ==========================================
  // ISC-VI: MORE EMERGING TECH
  // ==========================================
  {
    id: 'isc-d2-016',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-VI',
    topicId: 'isc-emerging-tech',
    topic: 'Cloud Computing',
    subtopic: 'Cloud Deployment Models',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'A hybrid cloud deployment model combines:',
    options: [
      'A private cloud with one or more public cloud services, enabling data and application portability',
      'Multiple public clouds from different providers',
      'A traditional on-premises environment with no cloud services',
      'Two or more private clouds',
    ],
    correctAnswer: 0,
    explanation: 'Cloud deployment models: (1) Public — shared infrastructure operated by a third party (AWS, Azure, GCP), (2) Private — dedicated infrastructure for a single organization (on-premises or hosted), (3) Hybrid — combination of public and private with orchestration between them, enabling workload portability and flexibility, (4) Community — shared infrastructure for organizations with common concerns. Multi-cloud uses multiple public cloud providers.',
    reference: 'NIST SP 800-145',
  },
  {
    id: 'isc-d2-017',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-VI',
    topicId: 'isc-emerging-tech',
    topic: 'Emerging Technologies',
    subtopic: 'Digital Twins',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'In the context of enterprise systems, a digital twin is:',
    options: [
      'A virtual replica of a physical asset, process, or system that uses real-time data for simulation, analysis, and optimization',
      'A second authentication factor',
      'A duplicate website for disaster recovery',
      'A backup copy of a database',
    ],
    correctAnswer: 0,
    explanation: 'Digital twins create virtual models of physical objects/processes using IoT sensor data, AI/ML, and simulation. Accounting/audit implications: (1) asset valuation — continuous monitoring of asset condition, (2) predictive maintenance — optimizing depreciation estimates, (3) process optimization — identifying inefficiencies, (4) risk assessment — modeling scenarios before implementation, (5) inventory management — real-time tracking of physical goods.',
    reference: 'Gartner Digital Twin Reference; ISO 23247',
  },

  // ==========================================
  // ISC-II: SECURITY OPERATIONS
  // ==========================================
  {
    id: 'isc-d2-018',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topic: 'Security Operations',
    subtopic: 'SIEM',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An organization implements a Security Information and Event Management (SIEM) system to monitor its financial reporting infrastructure. The auditor reviews the SIEM configuration and finds that database audit logs from the ERP system are collected but correlation rules have not been configured for detecting unauthorized data modifications. What is the control implication?',
    options: [
      'Log collection alone provides adequate monitoring',
      'The SIEM is collecting data but not effectively analyzing it — without correlation rules for unauthorized modifications, the control does not achieve its monitoring objective, leaving data integrity risks undetected',
      'SIEM systems are only relevant for cybersecurity, not financial auditing',
      'The IT team should disable logging to reduce storage costs',
    ],
    correctAnswer: 1,
    explanation: 'A SIEM system\'s value depends on both data collection AND analysis through correlation rules and alerting. Collecting ERP database logs without analyzing them for unauthorized modifications means the detective control is incomplete — data integrity violations could occur without generating alerts. The auditor should recommend implementing correlation rules that detect: direct database modifications bypassing the application, unauthorized changes to financial data, and privilege escalation events.',
    reference: 'NIST SP 800-92',
  },
  {
    id: 'isc-d2-019',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Vulnerability Management',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An organization\'s vulnerability management program should include:',
    options: [
      'Purchasing the most expensive security tool available',
      'Regular vulnerability scanning, risk-based prioritization, and timely remediation with verification',
      'Only patching critical vulnerabilities',
      'Scanning for vulnerabilities once per year',
    ],
    correctAnswer: 1,
    explanation: 'Effective vulnerability management: (1) asset inventory — know what to scan, (2) regular scanning — automated, frequency based on risk (continuous for critical systems), (3) risk-based prioritization — CVSS score, exploitability, asset criticality, (4) remediation — patching, configuration changes, compensating controls, (5) verification — rescan to confirm remediation, (6) reporting and metrics — track mean time to remediate. PCI-DSS requires quarterly scans; best practice is continuous.',
    reference: 'NIST SP 800-40 Rev. 4',
  },

  // ==========================================
  // ISC-I: SYSTEM PROCESSING
  // ==========================================
  {
    id: 'isc-d2-020',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-processing',
    topic: 'System Processing Controls',
    subtopic: 'Input Controls',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Which of the following is a detective input control?',
    options: [
      'Batch control totals compared to expected totals after processing',
      'Required field validation preventing blank submissions',
      'Dropdown menus limiting selection options',
      'Data entry field validation (e.g., numeric-only fields)',
    ],
    correctAnswer: 0,
    explanation: 'Batch control totals are detective controls — they identify errors after data has been entered by comparing data control totals to independently calculated expected totals. Preventive input controls include: field validation, range checks, check digits, dropdown menus, and required field validation — these prevent errors at the point of entry. Detective controls identify errors that preventive controls missed.',
    reference: 'AICPA IT Audit Guide',
  },
  {
    id: 'isc-d2-021',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-processing',
    topic: 'System Processing Controls',
    subtopic: 'Processing Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A hash total is different from a financial total because:',
    options: [
      'Financial totals are less accurate than hash totals',
      'A hash total is a sum of a field that has no meaningful total (e.g., sum of account numbers), used solely for control purposes',
      'Hash totals can only be calculated manually',
      'Hash totals are always larger numbers',
    ],
    correctAnswer: 1,
    explanation: 'Control totals: (1) Financial total — sum of a monetary field (total debits = total credits), (2) Record count — number of records processed, (3) Hash total — sum of a non-meaningful field (e.g., total of all employee SSNs) used purely as a control. If the hash total before and after processing doesn\'t match, records were lost, added, or duplicated. Hash totals are effective because they detect any change in the population of records.',
    reference: 'AICPA IT Audit Guide',
  },

  // ==========================================
  // ISC-III: IT RISK MANAGEMENT
  // ==========================================
  {
    id: 'isc-d2-022',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-risk',
    topic: 'IT Risk Management',
    subtopic: 'Risk Assessment',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'In IT risk management, residual risk is defined as:',
    options: [
      'The risk of all IT projects failing',
      'The risk of a natural disaster',
      'The risk remaining after controls and mitigating measures have been implemented',
      'The total risk before any controls are applied',
    ],
    correctAnswer: 2,
    explanation: 'Residual risk = inherent risk − risk reduction from controls. Inherent risk is the risk level without any controls. Residual risk is what remains after controls are applied. Management must decide if residual risk is within the organization\'s risk appetite. If not, additional controls are needed, or the risk must be transferred (insurance), avoided (discontinue activity), or accepted with documentation.',
    reference: 'NIST SP 800-30 Rev. 1; ISO 27005',
  },
  {
    id: 'isc-d2-023',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-III',
    topicId: 'isc-risk',
    topic: 'IT Risk Management',
    subtopic: 'Risk Treatment',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'The four fundamental risk treatment options are:',
    options: [
      'Insure, outsource, ignore, and delay',
      'Prevent, detect, correct, and recover',
      'Mitigate (reduce), transfer, avoid, and accept',
      'Accept, reject, delay, and eliminate',
    ],
    correctAnswer: 2,
    explanation: 'Risk treatment strategies: (1) Mitigate/Reduce — implement controls to reduce likelihood or impact, (2) Transfer — shift risk to a third party (insurance, outsourcing), (3) Avoid — discontinue the activity creating the risk, (4) Accept — acknowledge the risk without additional action (within risk appetite, documented). Risk management frameworks (COSO ERM, ISO 31000, NIST RMF) all use variations of these four responses.',
    reference: 'ISO 31000; NIST SP 800-39',
  },

  // ==========================================
  // ISC-IV: DIGITAL TRANSFORMATION
  // ==========================================
  {
    id: 'isc-d2-024',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-IV',
    topicId: 'isc-digital',
    topic: 'Digital Transformation',
    subtopic: 'ERP Systems',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A key audit consideration for enterprise resource planning (ERP) systems is:',
    options: [
      'Integrated modules may propagate errors throughout the system, and complex access controls require careful configuration',
      'ERP systems cannot process financial transactions',
      'ERP systems are immune to cybersecurity threats',
      'ERP systems eliminate the need for internal controls',
    ],
    correctAnswer: 0,
    explanation: 'ERP audit considerations: (1) integration — errors in one module (e.g., procurement) flow automatically to others (accounts payable, general ledger), (2) access controls — role-based access must prevent toxic combinations (SoD violations), (3) configuration — custom settings affect control effectiveness, (4) change management — upgrades/patches affect all modules, (5) data conversion — initial migration requires validation, (6) master data management — centralized data requires integrity controls.',
    reference: 'ISACA ERP Audit/Assurance Program',
  },
  {
    id: 'isc-d2-025',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-IV',
    topicId: 'isc-digital',
    topic: 'Digital Transformation',
    subtopic: 'API Security',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'When evaluating controls over Application Programming Interfaces (APIs) used for financial data exchange, an auditor should verify:',
    options: [
      'That APIs are accessible without any authentication for ease of use',
      'Authentication (OAuth/API keys), encryption in transit, rate limiting, input validation, and logging of all API calls',
      'That APIs are documented on the company\'s public website',
      'That APIs use only GET requests',
    ],
    correctAnswer: 1,
    explanation: 'API security controls: (1) authentication — OAuth 2.0, API keys, mutual TLS, (2) authorization — token scoping, role-based permissions, (3) encryption — TLS for data in transit, (4) rate limiting — prevent abuse/DDoS, (5) input validation — prevent injection attacks, (6) logging — complete audit trail of API calls, (7) API gateway — centralized management and monitoring. APIs are increasingly used for financial data exchange (open banking, fintech integrations, automated reconciliation).',
    reference: 'OWASP API Security Top 10; NIST SP 800-95',
  },
];
