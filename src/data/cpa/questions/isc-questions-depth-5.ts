// ISC Depth Questions - Batch 5
// Focus: ISC-I (IT Governance), ISC-II (Security), ISC-III (Data Management)
// Difficulty: balanced

import { Question } from '../../../types';

export const ISC_QUESTIONS_DEPTH_5: Question[] = [
  {
    id: 'isc-d5-001',
    section: 'ISC',
    blueprintArea: 'ISC-I',
    topicId: 'isc-governance',
    topic: 'IT Governance and Risk',
    subtopic: 'COBIT Framework',
    difficulty: 'medium',
    question: 'COBIT (Control Objectives for Information and Related Technology) is primarily designed to:',
    options: [
      'Replace all other IT frameworks',
      'Provide a comprehensive framework for governance and management of enterprise IT — bridging the gap between business requirements, control needs, and technical issues through 5 principles and 40 governance/management processes',
      'Serve only as a software development methodology',
      'Address only financial reporting controls',
    ],
    correctAnswer: 1,
    explanation: 'COBIT 2019 (ISACA): An enterprise IT governance framework that: (1) Aligns IT goals with business objectives. (2) Provides 5 principles: meeting stakeholder needs, covering the enterprise end-to-end, applying a single integrated framework, enabling a holistic approach, and separating governance from management. (3) Contains 40 processes organized into governance (EDM — Evaluate, Direct, Monitor) and management (APO, BAI, DSS, MEA) domains. (4) Uses capability levels (0-5) and maturity models for process assessment. COBIT integrates with other frameworks: ITIL (service management), ISO 27001 (security), TOGAF (architecture), PMBOK (project management). CPA relevance: IT governance is fundamental to understanding IT general controls (ITGCs) in financial statement audits, SOX compliance, and SOC reporting.',
    reference: 'COBIT 2019 Framework; ISACA',
  },
  {
    id: 'isc-d5-002',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Public Key Infrastructure (PKI)',
    difficulty: 'hard',
    question: 'In a Public Key Infrastructure (PKI), a digital certificate issued by a Certificate Authority (CA) binds:',
    options: [
      'A user\'s password to their account',
      'An entity\'s identity to their public key — the CA digitally signs the certificate, allowing others to verify the identity of the certificate holder and use their public key for encryption or signature verification',
      'Two private keys together',
      'A MAC address to an IP address',
    ],
    correctAnswer: 1,
    explanation: 'PKI (Public Key Infrastructure): Core components: (1) Certificate Authority (CA): trusted entity that issues, manages, and revokes digital certificates. Root CA → intermediate CAs → end-entity certificates (hierarchical trust model). (2) Digital certificate (X.509): contains the subject\'s identity, public key, issuer (CA), validity period, serial number, signature algorithm, and the CA\'s digital signature. (3) Registration Authority (RA): verifies identity before CA issues certificate. (4) Certificate Revocation List (CRL) / Online Certificate Status Protocol (OCSP): mechanisms to check if a certificate has been revoked. Uses: (1) SSL/TLS for secure web communication (HTTPS). (2) S/MIME for encrypted email. (3) Code signing. (4) VPN authentication. (5) Digital signatures. Asymmetric encryption: public key encrypts → private key decrypts. Digital signature: private key signs → public key verifies. CPA exam relevance: understanding authentication, non-repudiation, and encryption in IT controls.',
    reference: 'X.509; NIST SP 800-32',
  },
  {
    id: 'isc-d5-003',
    section: 'ISC',
    blueprintArea: 'ISC-III',
    topicId: 'isc-data',
    topic: 'Data Management',
    subtopic: 'Data Classification',
    difficulty: 'easy',
    question: 'Data classification is the process of:',
    options: [
      'Deleting unnecessary data',
      'Categorizing data based on its sensitivity level and the impact of unauthorized disclosure — enabling organizations to apply appropriate security controls proportional to the data\'s value and risk',
      'Converting data to a different format',
      'Backing up data to multiple locations',
    ],
    correctAnswer: 1,
    explanation: 'Data Classification: Purpose: ensure appropriate protection levels based on data sensitivity. Common classification levels: (1) Public/Unclassified: no impact if disclosed. (2) Internal/Sensitive: limited impact — for internal use only. (3) Confidential: significant impact — includes PII, financial data, trade secrets. (4) Restricted/Highly Confidential: severe impact — includes PCI, PHI, classified government data. Government classification: Unclassified, Confidential, Secret, Top Secret. Classification process: (1) Data owner identifies and classifies. (2) Data custodian implements controls. (3) Data user accesses per policy. Regulatory requirements: PCI DSS (cardholder data), HIPAA (PHI), GDPR (personal data), SOX (financial data). Benefits: (1) Focus security resources on highest-risk data. (2) Regulatory compliance. (3) Incident response prioritization. (4) Access control alignment. CPA relevance: understanding what data requires enhanced controls in financial systems and audit evidence protection.',
    reference: 'NIST SP 800-60; ISO 27001 A.8',
  },
  {
    id: 'isc-d5-004',
    section: 'ISC',
    blueprintArea: 'ISC-I',
    topicId: 'isc-governance',
    topic: 'IT Governance and Risk',
    subtopic: 'Business Impact Analysis (BIA)',
    difficulty: 'medium',
    question: 'A Business Impact Analysis (BIA) is used to:',
    options: [
      'Test backup systems only',
      'Identify critical business functions and quantify the impact of their disruption — determining Recovery Time Objectives (RTO, maximum acceptable downtime) and Recovery Point Objectives (RPO, maximum acceptable data loss)',
      'Perform financial statement analysis',
      'Evaluate employee performance',
    ],
    correctAnswer: 1,
    explanation: 'BIA (Business Impact Analysis): Key outputs: (1) RTO (Recovery Time Objective): maximum acceptable time a system/process can be down. (2) RPO (Recovery Point Objective): maximum acceptable data loss measured in time (e.g., RPO of 4 hours means losing up to 4 hours of data is tolerable). (3) MTPD (Maximum Tolerable Period of Disruption): absolute limit beyond which the organization cannot survive. (4) Priority ranking of business processes by criticality. BIA process: (1) Identify critical business functions. (2) Determine impact of disruption (financial, operational, regulatory, reputational). (3) Set RTO/RPO for each function. (4) Identify dependencies (systems, data, people, third parties). BIA drives: BCP (Business Continuity Plan), DRP (Disaster Recovery Plan), backup strategies, and insurance decisions. CPA relevance: understanding continuity planning for financial reporting systems, audit considerations for IT disaster recovery capabilities.',
    reference: 'NIST SP 800-34; ISO 22301',
  },
  {
    id: 'isc-d5-005',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Network Segmentation',
    difficulty: 'medium',
    question: 'Network segmentation as a security control involves:',
    options: [
      'Connecting all systems to one network for simplicity',
      'Dividing a network into isolated segments (subnets or VLANs) to limit lateral movement of attackers and contain breaches — sensitive systems like financial databases are placed in restricted segments with controlled access points',
      'Using only wireless networks',
      'Encrypting all network traffic without segmentation',
    ],
    correctAnswer: 1,
    explanation: 'Network Segmentation: Purpose: limit the blast radius of security incidents and enforce least-privilege network access. Implementation methods: (1) VLANs (Virtual LANs): logical network separation at Layer 2. (2) Subnets: Layer 3 separation with routers/firewalls between segments. (3) DMZ (Demilitarized Zone): buffer zone between internet and internal network for public-facing servers. (4) Microsegmentation: granular, workload-level isolation (software-defined networking). Common segments: (1) User network (workstations). (2) Server network (application/database servers). (3) Management network (IT admin systems). (4) DMZ (web servers, email gateways). (5) Guest network (isolated from corporate resources). PCI DSS requirement: cardholder data environment must be segmented from other networks to reduce scope of compliance. Benefits: (1) Contains breaches. (2) Reduces attack surface. (3) Enables targeted monitoring. (4) Simplifies compliance. CPA relevance: key IT general control for protecting financial system integrity.',
    reference: 'NIST SP 800-41; PCI DSS v4.0',
  },
  {
    id: 'isc-d5-006',
    section: 'ISC',
    blueprintArea: 'ISC-III',
    topicId: 'isc-data',
    topic: 'Data Management',
    subtopic: 'Database Normalization',
    difficulty: 'medium',
    question: 'Database normalization reduces data redundancy by:',
    options: [
      'Combining all data into a single table',
      'Organizing data into multiple related tables with defined relationships — following normal forms (1NF, 2NF, 3NF) to eliminate repeating groups, partial dependencies, and transitive dependencies',
      'Deleting duplicate records',
      'Compressing the database files',
    ],
    correctAnswer: 1,
    explanation: 'Database Normalization: Progressive normal forms: (1) 1NF (First Normal Form): eliminate repeating groups — each column contains atomic (indivisible) values; each row is unique. (2) 2NF (Second Normal Form): 1NF + eliminate partial dependencies — non-key attributes must depend on the ENTIRE primary key (relevant for composite keys). (3) 3NF (Third Normal Form): 2NF + eliminate transitive dependencies — non-key attributes must not depend on other non-key attributes. (4) BCNF (Boyce-Codd NF): stricter version of 3NF. Benefits: (1) Reduces data redundancy. (2) Minimizes update/insert/delete anomalies. (3) Improves data integrity. (4) Reduces storage requirements. Trade-offs: over-normalization can reduce query performance (more JOINs required). Denormalization: intentionally adding redundancy for performance (common in data warehouses/OLAP). CPA relevance: understanding data integrity controls in ERP and financial systems, audit data reliability.',
    reference: 'Codd\'s Normal Forms; Database Design',
  },
  {
    id: 'isc-d5-007',
    section: 'ISC',
    blueprintArea: 'ISC-I',
    topicId: 'isc-governance',
    topic: 'IT Governance and Risk',
    subtopic: 'IT General Controls (ITGCs)',
    difficulty: 'easy',
    question: 'IT General Controls (ITGCs) in the context of a financial statement audit include:',
    options: [
      'Only password policies',
      'Access to programs and data, program change management, computer operations, and program development — these controls support the reliability of application controls and the integrity of financial data processing',
      'Only cybersecurity measures',
      'Only physical access controls',
    ],
    correctAnswer: 1,
    explanation: 'ITGCs (IT General Controls): Four primary domains: (1) Access to programs and data: logical access controls (user authentication, authorization, access reviews), physical access controls (data center security). (2) Program change management: controls over modifications to applications and systems (change request, approval, testing, migration to production). (3) Computer operations: job scheduling, backup/recovery, incident management, monitoring. (4) Program development: SDLC controls for new systems (requirements, design, testing, implementation). Why ITGCs matter for audits: if ITGCs are weak, application controls cannot be relied upon — the auditor may need to increase substantive testing. Testing approach: auditors test design and operating effectiveness of ITGCs. Common deficiencies: (1) Excessive access rights. (2) Lack of segregation of duties in IT. (3) Inadequate change management. (4) Missing audit trails. SOX implications: management must assess and auditors must evaluate ITGCs for accelerated filers.',
    reference: 'AS 2110; COSO 2013; PCAOB standards',
  },
  {
    id: 'isc-d5-008',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Incident Response Plan',
    difficulty: 'easy',
    question: 'An IT incident response plan should include which phases?',
    options: [
      'Only detection and recovery',
      'Preparation, detection/identification, containment, eradication, recovery, and lessons learned/post-incident review — following the NIST SP 800-61 framework',
      'Only notification of management',
      'Only documentation of the incident',
    ],
    correctAnswer: 1,
    explanation: 'NIST SP 800-61 Incident Response Lifecycle: 6 phases: (1) Preparation: establish IR team (CSIRT), develop procedures, acquire tools, conduct training, implement preventive controls. (2) Detection/Identification: identify potential incidents through monitoring, alerts, log analysis, user reports. Determine scope and classify severity. (3) Containment: short-term (isolate affected systems) and long-term (apply temporary fixes). Preserve evidence for forensics. (4) Eradication: remove the root cause (malware, vulnerabilities, unauthorized access). (5) Recovery: restore systems to normal operation, verify systems are functioning properly, monitor for re-infection. (6) Lessons Learned (Post-Incident Review): document findings, update procedures, identify improvements, share intelligence. Key elements: (1) Clear escalation procedures. (2) Communication plan (internal and external). (3) Evidence preservation (chain of custody). (4) Regulatory notification requirements (GDPR: 72 hours, state breach notification laws). CPA relevance: assessing entity\'s ability to respond to IT security incidents affecting financial data.',
    reference: 'NIST SP 800-61 Rev. 2',
  },
  {
    id: 'isc-d5-009',
    section: 'ISC',
    blueprintArea: 'ISC-III',
    topicId: 'isc-data',
    topic: 'Data Management',
    subtopic: 'ETL Process',
    difficulty: 'medium',
    question: 'In data warehousing, the ETL process stands for:',
    options: [
      'Evaluate, Test, Launch',
      'Extract, Transform, Load — data is extracted from source systems, transformed (cleaned, validated, formatted, aggregated) to meet business rules, and loaded into the target data warehouse for reporting and analysis',
      'Encrypt, Transfer, Log',
      'Edit, Track, List',
    ],
    correctAnswer: 1,
    explanation: 'ETL (Extract, Transform, Load): (1) Extract: pull data from source systems (ERP, CRM, databases, flat files, APIs). Full extraction (all data) or incremental (only changed data — delta). (2) Transform: apply business rules and data quality checks. Activities: data cleansing (fixing errors, handling nulls), deduplication, standardization (formats, codes), aggregation, derivation (calculated fields), surrogate key assignment, SCD (Slowly Changing Dimension) handling. (3) Load: insert data into target (data warehouse, data mart). Initial load (full) vs. incremental load. Dimension vs. fact table loading. Variations: ELT (Extract, Load, Transform): load raw data first, transform in-place using target system\'s processing power (common in cloud/big data — e.g., Snowflake, BigQuery). Real-time/streaming ETL: near-real-time processing (Kafka, Spark Streaming). CPA relevance: understanding how financial data flows from transactional systems to reporting systems — data integrity across the pipeline.',
    reference: 'Kimball Data Warehouse Toolkit',
  },
  {
    id: 'isc-d5-010',
    section: 'ISC',
    blueprintArea: 'ISC-IV',
    topicId: 'isc-soc',
    topic: 'SOC Reports',
    subtopic: 'SOC 2 Type II',
    difficulty: 'easy',
    question: 'A SOC 2 Type II report differs from a SOC 2 Type I report because it:',
    options: [
      'Covers only financial reporting controls',
      'Tests the operating effectiveness of controls over a period of time (typically 6-12 months) — whereas a Type I report only evaluates the suitability of design of controls at a specific point in time',
      'Is completed in one day',
      'Does not require an auditor\'s opinion',
    ],
    correctAnswer: 1,
    explanation: 'SOC 2 Reports (AICPA): Type I: evaluates the description of the service organization\'s system AND the suitability of the design of controls at a specific point in time. Answers: "Are the controls suitably designed?" Type II: evaluates everything in Type I PLUS tests the operating effectiveness of those controls over a specified period (usually 6-12 months). Answers: "Are the controls operating effectively?" Trust Services Criteria (TSC): Security (required), Availability, Processing Integrity, Confidentiality, Privacy (organization selects applicable criteria). Restricted use: SOC 2 reports are restricted-use reports (only for management, the service organization, user entities, and their auditors). vs. SOC 3: same criteria as SOC 2 but a general-use report (can be publicly distributed) — less detail, no system description. CPA relevance: CPAs often rely on SOC reports when auditing entities that use service organizations (SAS 145 / AU-C 402 — complementary user entity controls).',
    reference: 'AICPA SOC 2 guide; SSAE 18',
  },
  {
    id: 'isc-d5-011',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Blockchain Fundamentals',
    difficulty: 'medium',
    question: 'A key characteristic of blockchain technology in an accounting context is:',
    options: [
      'Data can be easily modified or deleted',
      'Immutability — once a transaction is recorded in a block and added to the chain, it cannot be altered without invalidating all subsequent blocks, providing a tamper-evident audit trail',
      'It replaces the need for any financial controls',
      'It operates without any network consensus',
    ],
    correctAnswer: 1,
    explanation: 'Blockchain for Accounting/Auditing: Key features: (1) Immutability: cryptographic hashing links blocks — altering any block invalidates subsequent hashes. (2) Distributed ledger: copies maintained by multiple nodes (no single point of failure or control). (3) Consensus mechanisms: Proof of Work (PoW), Proof of Stake (PoS), Practical Byzantine Fault Tolerance (PBFT) — ensure agreement on ledger state. (4) Transparency: public blockchains are visible to all participants; private/permissioned blockchains restrict access. Accounting applications: (1) Triple-entry bookkeeping: shared ledger between parties eliminates reconciliation. (2) Smart contracts: automated execution of contractual terms (revenue recognition triggers, payment processing). (3) Supply chain tracking: provenance and authenticity verification. (4) Real-time auditing: continuous audit trails. Challenges: (1) Scalability (throughput limitations). (2) Regulatory uncertainty. (3) Privacy concerns (right to be forgotten vs. immutability). (4) Energy consumption (PoW). CPA relevance: understanding how blockchain affects audit evidence, financial reporting, and internal controls.',
    reference: 'AICPA Blockchain Fundamentals',
  },
  {
    id: 'isc-d5-012',
    section: 'ISC',
    blueprintArea: 'ISC-I',
    topicId: 'isc-governance',
    topic: 'IT Governance and Risk',
    subtopic: 'Risk Assessment Methodologies',
    difficulty: 'medium',
    question: 'A quantitative risk assessment calculates risk using:',
    options: [
      'Subjective ratings of high/medium/low',
      'Numerical values — Annual Loss Expectancy (ALE) = Single Loss Expectancy (SLE, asset value × exposure factor) × Annualized Rate of Occurrence (ARO, frequency of the threat per year)',
      'Only the number of past incidents',
      'Employee surveys about perceived risk',
    ],
    correctAnswer: 1,
    explanation: 'Risk Assessment Methodologies: Quantitative: uses numerical/monetary values. (1) Asset Value (AV): monetary worth of the asset. (2) Exposure Factor (EF): percentage of asset lost in a single incident (0-100%). (3) Single Loss Expectancy: SLE = AV × EF. (4) Annualized Rate of Occurrence (ARO): estimated frequency of the threat per year. (5) Annual Loss Expectancy: ALE = SLE × ARO. Used for cost-benefit analysis of controls: if a control costs less than the ALE reduction it provides → cost-justified. Qualitative: uses descriptive scales (high/medium/low for likelihood and impact). Easier to perform but less precise. Hybrid approach: commonly used in practice — combines elements of both. Frameworks: NIST SP 800-30 (Risk Assessment), ISO 27005, OCTAVE, FAIR (Factor Analysis of Information Risk). CPA relevance: CPAs assess IT risks as part of audit planning and internal control evaluation (risk of material misstatement).',
    reference: 'NIST SP 800-30; FAIR',
  },
  {
    id: 'isc-d5-013',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Ransomware',
    difficulty: 'easy',
    question: 'Ransomware is a type of malware that:',
    options: [
      'Monitors keyboard input',
      'Encrypts the victim\'s data and demands payment (typically in cryptocurrency) for the decryption key — defense requires regular offline backups, endpoint protection, user awareness training, and incident response planning',
      'Sends spam emails from the victim\'s account',
      'Only targets mobile devices',
    ],
    correctAnswer: 1,
    explanation: 'Ransomware: Types: (1) Crypto-ransomware: encrypts files (most common — e.g., WannaCry, REvil, LockBit). (2) Locker ransomware: locks the user out of the operating system. (3) Double extortion: encrypts AND exfiltrates data — threatens to publish if ransom is not paid. (4) Ransomware-as-a-Service (RaaS): criminal groups provide ransomware platforms to affiliates. Attack vectors: phishing emails, exploiting vulnerabilities (unpatched systems), RDP (Remote Desktop Protocol) brute force, compromised websites. Prevention: (1) Regular backups (offline/air-gapped — not connected to network). (2) Patch management. (3) Email filtering and user awareness training. (4) Endpoint detection and response (EDR). (5) Network segmentation. (6) Least privilege access. (7) Multi-factor authentication. Response: (1) Isolate affected systems. (2) Assess scope. (3) Contact law enforcement (FBI IC3). (4) Restore from backups. (5) Do NOT pay ransom if possible (no guarantee of decryption, funds criminal activity). CPA relevance: ransomware attacks can disrupt financial reporting, destroy audit evidence, and trigger disclosure requirements.',
    reference: 'CISA Ransomware Guide; NIST CSF',
  },
  {
    id: 'isc-d5-014',
    section: 'ISC',
    blueprintArea: 'ISC-III',
    topicId: 'isc-data',
    topic: 'Data Management',
    subtopic: 'Data Governance Framework',
    difficulty: 'easy',
    question: 'Data governance in an organization establishes:',
    options: [
      'Only the IT department\'s responsibilities for data',
      'Policies, procedures, roles, and standards for managing data as a strategic asset — including data ownership, stewardship, quality standards, access rules, lifecycle management, and regulatory compliance across the entire organization',
      'A single database for all company data',
      'Only data backup procedures',
    ],
    correctAnswer: 1,
    explanation: 'Data Governance: Key components: (1) Data ownership: business stakeholders responsible for data accuracy and appropriate use. (2) Data stewardship: day-to-day management of data quality and adherence to governance policies. (3) Data quality management: accuracy, completeness, consistency, timeliness, validity (DAMA — Data Management Association framework). (4) Data architecture: logical and physical data models, data flow documentation. (5) Master data management (MDM): single authoritative source for critical business data (customers, products, employees). (6) Metadata management: data about data (definitions, lineage, relationships). (7) Data lifecycle management: creation, storage, use, archival, destruction. (8) Regulatory compliance: GDPR, CCPA, SOX, HIPAA requirements for data handling. Frameworks: DAMA-DMBOK (Data Management Body of Knowledge), EDM Council (financial services). CPA relevance: data governance supports financial data integrity, audit trail reliability, and regulatory compliance — weak governance = higher risk of material misstatement.',
    reference: 'DAMA-DMBOK; COBIT 2019 APO01',
  },
  {
    id: 'isc-d5-015',
    section: 'ISC',
    blueprintArea: 'ISC-IV',
    topicId: 'isc-soc',
    topic: 'SOC Reports',
    subtopic: 'Complementary User Entity Controls',
    difficulty: 'medium',
    question: 'Complementary User Entity Controls (CUECs) in a SOC report are:',
    options: [
      'Controls performed by the service auditor',
      'Controls that the user organization (client of the service organization) must implement for the service organization\'s controls to be effective — the SOC report lists these, and the user entity\'s auditor must assess whether they are in place',
      'Optional controls that never need testing',
      'Controls performed by the service organization only',
    ],
    correctAnswer: 1,
    explanation: 'CUECs (Complementary User Entity Controls): Definition: controls that the service organization\'s system design assumes are implemented by user entities. If CUECs are not in place, the service organization\'s controls may not achieve their objectives. Examples: (1) User entity must perform timely access reviews for their users in the service organization\'s system. (2) User entity must reconcile output reports to source data. (3) User entity must restrict physical/logical access to their own systems that interact with the service organization. (4) User entity must communicate employee terminations promptly to the service organization. Auditor responsibilities: (1) Service auditor: identifies and lists CUECs in the SOC report description. (2) User entity auditor: evaluates whether CUECs are designed and operating effectively at the user entity. If a CUEC is missing → the user entity auditor cannot rely on the related service organization control. Related concepts: Complementary Subservice Organization Controls (CSOCs) — controls needed from subservice organizations. CPA relevance: critical understanding for auditors relying on SOC reports under AU-C 402.',
    reference: 'SSAE 18; AU-C 402',
  },
  {
    id: 'isc-d5-016',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Robotic Process Automation (RPA)',
    difficulty: 'easy',
    question: 'Robotic Process Automation (RPA) in accounting refers to:',
    options: [
      'Physical robots performing accounting tasks',
      'Software bots that automate repetitive, rule-based tasks such as data entry, reconciliation, and report generation — freeing human accountants for higher-value analytical and judgment-based work',
      'Replacing all accountants with AI',
      'Only automating tax return preparation',
    ],
    correctAnswer: 1,
    explanation: 'RPA (Robotic Process Automation): Software robots (bots) that mimic human interactions with computer systems. Types: (1) Attended RPA: bots assist humans during tasks (triggered by users). (2) Unattended RPA: bots operate independently on scheduled or event-triggered tasks. (3) Intelligent automation: RPA + AI/ML for handling unstructured data and making decisions. Accounting applications: (1) AP/AR processing: invoice matching, payment processing, collections. (2) Reconciliations: bank reconciliation, intercompany reconciliation. (3) Journal entries: standard recurring entries, accruals. (4) Financial close: automating close checklists, consolidation tasks. (5) Tax compliance: data gathering, form population. (6) Audit: data extraction, sampling, confirmation tracking. Benefits: speed, accuracy (no manual errors), scalability, 24/7 operation, audit trail. Risks: (1) Bots can propagate errors if programmed incorrectly. (2) Security (bot credentials management). (3) Change management (bots break when applications change). (4) Governance (bot inventory, monitoring, access controls).',
    reference: 'AICPA; Gartner RPA',
  },
  {
    id: 'isc-d5-017',
    section: 'ISC',
    blueprintArea: 'ISC-I',
    topicId: 'isc-governance',
    topic: 'IT Governance and Risk',
    subtopic: 'Segregation of Duties in IT',
    difficulty: 'easy',
    question: 'Proper segregation of duties in IT requires that:',
    options: [
      'One person handles all IT functions',
      'The roles of programming/development, computer operations, and security administration are separated — developers should not have access to production systems, and operators should not be able to modify programs',
      'All employees have administrator access',
      'Only the CIO has system access',
    ],
    correctAnswer: 1,
    explanation: 'IT Segregation of Duties (SoD): Key incompatible functions: (1) Systems development/programming ←→ Computer operations: developers should not run production systems or have access to production data. (2) Systems development ←→ Security administration: developers should not control their own access. (3) Computer operations ←→ Security administration: operators should not manage access permissions. (4) Database administration ←→ Security administration: DBAs should not control access to their own databases. (5) Change management ←→ Deployment: the person approving changes should not deploy them. Why: prevents any single individual from (1) initiating and approving transactions, (2) modifying programs and processing data with those programs, (3) granting themselves access to sensitive systems. Compensating controls (small IT departments): (1) Management review and monitoring. (2) Detailed audit logging with independent review. (3) Dual control for sensitive operations. (4) Version control and code review by independent parties. CPA relevance: SoD is a foundational ITGC evaluated in every financial statement audit.',
    reference: 'COSO 2013; COBIT 2019',
  },
  {
    id: 'isc-d5-018',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Zero Trust Architecture',
    difficulty: 'hard',
    question: 'Zero Trust Architecture is a security model based on the principle of:',
    options: [
      'Trusting all internal network traffic',
      '"Never trust, always verify" — every access request is authenticated, authorized, and encrypted regardless of the requester\'s location (inside or outside the network perimeter), implementing least-privilege access and continuous verification',
      'Blocking all external connections',
      'Using only one authentication factor',
    ],
    correctAnswer: 1,
    explanation: 'Zero Trust Architecture (ZTA): Core principles (NIST SP 800-207): (1) All data sources and computing services are resources. (2) All communication is secured regardless of network location. (3) Access to individual resources is granted on a per-session basis. (4) Access is determined by dynamic policy (identity, device health, behavior patterns, environmental factors). (5) The enterprise monitors and measures integrity and security posture of all owned/associated assets. (6) All resource authentication and authorization are dynamic and strictly enforced. (7) The enterprise collects as much information as possible about the current state of assets and uses it to improve security. Implementation components: (1) Identity verification (MFA, continuous authentication). (2) Device validation (health checks, compliance). (3) Microsegmentation. (4) Least privilege access. (5) Continuous monitoring and analytics. (6) Encryption everywhere. Drivers: cloud adoption (no clear perimeter), remote work, sophisticated threats. CPA relevance: understanding modern security architecture when evaluating entity IT controls and audit evidence reliability.',
    reference: 'NIST SP 800-207',
  },
  {
    id: 'isc-d5-019',
    section: 'ISC',
    blueprintArea: 'ISC-III',
    topicId: 'isc-data',
    topic: 'Data Management',
    subtopic: 'Data Retention Policies',
    difficulty: 'easy',
    question: 'A data retention policy specifies:',
    options: [
      'That all data should be kept forever',
      'How long different types of data must be retained and when they should be securely destroyed — balancing legal/regulatory requirements (tax records, SOX, HIPAA) with storage costs and privacy obligations (GDPR right to erasure)',
      'That data should be deleted immediately after use',
      'Only cloud storage pricing',
    ],
    correctAnswer: 1,
    explanation: 'Data Retention Policy: Key components: (1) Retention periods by data type: tax records (7 years — IRS §6501), SOX financial records (7 years for audit workpapers, 5 years for audit firm records), HIPAA medical records (6 years), employee records (varies by jurisdiction — often 3-7 years after termination), contracts (term + statute of limitations). (2) Legal hold: obligation to preserve data when litigation is reasonably anticipated (supersedes normal destruction schedules). Spoliation = destruction of evidence despite legal hold. (3) Secure destruction methods: digital — overwriting (DOD 5220.22-M), degaussing, physical destruction (shredding). Paper — cross-cut shredding, incineration. Certificate of destruction. (4) Regulatory considerations: GDPR right to erasure (right to be forgotten) — must delete personal data when no longer needed. CCPA — similar deletion rights. (5) Backup considerations: retention policies must extend to backup media. Benefits: (1) Compliance. (2) Reduced storage costs. (3) Reduced discovery burden in litigation. (4) Reduced security risk from retaining unnecessary data.',
    reference: 'NIST SP 800-88; SOX §802',
  },
  {
    id: 'isc-d5-020',
    section: 'ISC',
    blueprintArea: 'ISC-IV',
    topicId: 'isc-soc',
    topic: 'SOC Reports',
    subtopic: 'SOC 1 vs SOC 2',
    difficulty: 'easy',
    question: 'The primary difference between SOC 1 and SOC 2 reports is:',
    options: [
      'SOC 1 is more detailed than SOC 2',
      'SOC 1 focuses on controls relevant to user entities\' financial reporting (under SSAE 18) — while SOC 2 evaluates controls related to security, availability, processing integrity, confidentiality, and/or privacy (Trust Services Criteria)',
      'SOC 2 is only for government entities',
      'SOC 1 includes privacy controls',
    ],
    correctAnswer: 1,
    explanation: 'SOC 1 vs SOC 2: SOC 1 (SSAE 18 / ISAE 3402): (1) Purpose: controls at a service organization relevant to USER ENTITIES\' INTERNAL CONTROL OVER FINANCIAL REPORTING. (2) Audience: user entity management, user entity auditors. (3) Standard: SSAE 18 (AT-C 320). (4) Example: payroll processor, payment processor, benefits administrator. SOC 2 (SSAE 18): (1) Purpose: controls related to Trust Services Criteria (Security, Availability, Processing Integrity, Confidentiality, Privacy). (2) Audience: management, stakeholders who need assurance about operational controls. (3) Standard: AT-C 105/205 + Trust Services Criteria. (4) Example: cloud hosting provider, SaaS company, data center. SOC 3: same as SOC 2 but general-use (can be publicly distributed) — less detail, no system description. Both SOC 1 and SOC 2 have Type I and Type II variants. CPA financial statement auditors primarily use SOC 1 reports (controls affecting financial reporting). SOC 2 reports are more relevant for IT governance and security assurance.',
    reference: 'AICPA SOC reporting; SSAE 18',
  },
  {
    id: 'isc-d5-021',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Cloud Computing Models',
    difficulty: 'easy',
    question: 'The three primary cloud service models are:',
    options: [
      'Public, Private, and Hybrid',
      'IaaS (Infrastructure as a Service), PaaS (Platform as a Service), and SaaS (Software as a Service) — each model shifts different levels of management responsibility from the customer to the cloud provider',
      'Internet, Intranet, and Extranet',
      'Desktop, Mobile, and Tablet',
    ],
    correctAnswer: 1,
    explanation: 'Cloud Service Models: (1) IaaS (Infrastructure as a Service): provider manages hardware, networking, virtualization. Customer manages OS, middleware, applications, data. Examples: AWS EC2, Azure VMs, Google Compute Engine. Most flexible/lowest-level. (2) PaaS (Platform as a Service): provider manages everything in IaaS + OS, middleware, runtime. Customer manages applications and data. Examples: AWS Elastic Beanstalk, Azure App Service, Google App Engine. Good for developers. (3) SaaS (Software as a Service): provider manages everything. Customer uses the application and manages their data/users. Examples: Microsoft 365, Salesforce, QuickBooks Online, Workday. Deployment models (separate from service models): Public cloud (shared infrastructure), Private cloud (dedicated), Hybrid (combination), Multi-cloud (multiple providers). Shared responsibility model: security responsibility varies by model — IaaS (most customer responsibility) → SaaS (least customer responsibility). CPA relevance: understanding risks when financial data is processed/stored in the cloud — vendor management, data sovereignty, audit access rights, SOC report reliance.',
    reference: 'NIST SP 800-145; CSA Cloud Controls Matrix',
  },
  {
    id: 'isc-d5-022',
    section: 'ISC',
    blueprintArea: 'ISC-I',
    topicId: 'isc-governance',
    topic: 'IT Governance and Risk',
    subtopic: 'ITIL Service Management',
    difficulty: 'medium',
    question: 'ITIL (Information Technology Infrastructure Library) is a framework focused on:',
    options: [
      'Software development only',
      'IT service management (ITSM) — providing best practices for delivering IT services aligned with business needs, covering the full service lifecycle from strategy through design, transition, operation, and continual improvement',
      'Hardware procurement exclusively',
      'Database administration only',
    ],
    correctAnswer: 1,
    explanation: 'ITIL 4 (latest version): IT Service Management framework. Core concepts: (1) Service Value System (SVS): how all components work together to create value. (2) Service Value Chain: 6 activities — Plan, Improve, Engage, Design & Transition, Obtain/Build, Deliver & Support. (3) 34 practices organized into: General management (risk, project, knowledge management), Service management (incident, problem, change, service desk, service level management, capacity/availability, IT asset management, configuration management), Technical management (deployment, infrastructure/platform, software development). Key ITSM processes: (1) Incident management: restore normal service quickly. (2) Problem management: identify root causes of incidents. (3) Change management: control the lifecycle of changes to minimize disruption. (4) Configuration management (CMDB): maintain information about configuration items and their relationships. (5) Service level management: define and monitor SLAs. 4 dimensions: people, information/technology, partners/suppliers, value streams/processes. CPA relevance: ITIL practices support IT operational effectiveness and reliability, which underpin accounting information system integrity.',
    reference: 'ITIL 4 Foundation; AXELOS',
  },
  {
    id: 'isc-d5-023',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Vulnerability Management',
    difficulty: 'medium',
    question: 'An effective vulnerability management program includes:',
    options: [
      'Only annual penetration testing',
      'Regular vulnerability scanning, risk-based prioritization, timely remediation (patching), verification of fixes, and continuous monitoring — using CVSS (Common Vulnerability Scoring System) to prioritize vulnerabilities by severity',
      'Only installing antivirus software',
      'Waiting for vendors to automate all patches',
    ],
    correctAnswer: 1,
    explanation: 'Vulnerability Management Lifecycle: (1) Asset discovery: inventory all systems, applications, and network devices. (2) Vulnerability scanning: use automated tools (e.g., Nessus, Qualys, Rapid7) to identify known vulnerabilities. Frequency: critical systems — weekly/continuous; others — monthly/quarterly. (3) Prioritization: use CVSS (0-10 scale; Critical ≥ 9.0, High ≥ 7.0, Medium ≥ 4.0, Low < 4.0) combined with business context (asset criticality, exploitability, internet exposure). (4) Remediation: apply patches, configuration changes, compensating controls. SLA targets: Critical — 24-72 hours; High — 30 days; Medium — 90 days; Low — next maintenance cycle. (5) Verification: re-scan to confirm vulnerabilities are resolved. (6) Reporting: track metrics (number of open vulnerabilities, age, compliance with SLAs). Related activities: penetration testing (active exploitation of vulnerabilities — typically annually or after major changes), threat intelligence (understanding active exploits in the wild). CPA relevance: patch management and vulnerability management are key ITGCs affecting financial system security and integrity.',
    reference: 'NIST SP 800-40; CVSS v3.1',
  },
  {
    id: 'isc-d5-024',
    section: 'ISC',
    blueprintArea: 'ISC-III',
    topicId: 'isc-data',
    topic: 'Data Management',
    subtopic: 'XBRL in Financial Reporting',
    difficulty: 'medium',
    question: 'XBRL (eXtensible Business Reporting Language) is used in financial reporting to:',
    options: [
      'Create financial statements in PDF format only',
      'Tag financial data with standardized, machine-readable labels — enabling automated analysis, comparison across companies, and regulatory filing (SEC requires XBRL/iXBRL for financial statements using the US GAAP taxonomy)',
      'Encrypt financial statements',
      'Replace accounting software',
    ],
    correctAnswer: 1,
    explanation: 'XBRL (eXtensible Business Reporting Language): XML-based standard for electronic communication of business and financial data. Key concepts: (1) Taxonomy: a dictionary of reporting elements (concepts) with defined relationships. US GAAP Taxonomy: maintained by FASB. IFRS Taxonomy: maintained by IFRS Foundation. (2) Instance document: the actual financial data tagged with taxonomy elements. (3) Inline XBRL (iXBRL): combines human-readable HTML with XBRL tags — now required by SEC (since 2018-2020 rollout). SEC requirements: (1) All operating companies must file financial statements in iXBRL. (2) Cover page data, financial statements, and notes must be tagged. (3) Detail tagging for balance sheet, income statement, cash flow, equity, and notes. Benefits: (1) Automated data extraction and analysis. (2) Cross-company comparability. (3) Reduced manual data entry. (4) Improved data quality. (5) Faster regulatory processing. Challenges: (1) Custom extensions complexity. (2) Quality of tagging varies. (3) Taxonomy updates. CPA relevance: understanding XBRL is essential for financial reporting, audit analytics, and SEC compliance.',
    reference: 'SEC EDGAR; XBRL International',
  },
  {
    id: 'isc-d5-025',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'AI and Machine Learning in Auditing',
    difficulty: 'medium',
    question: 'Artificial Intelligence (AI) and Machine Learning (ML) are being used in auditing to:',
    options: [
      'Replace auditors entirely',
      'Analyze entire populations of transactions (instead of sampling), identify anomalies and patterns, predict risks, and automate routine audit procedures — enhancing audit quality while requiring human oversight for judgment and professional skepticism',
      'Only generate financial statements',
      'Eliminate the need for audit evidence',
    ],
    correctAnswer: 1,
    explanation: 'AI/ML in Auditing: Current applications: (1) Full population testing: analyze 100% of transactions instead of sampling — journal entry testing, accounts payable duplicate detection, revenue anomalies. (2) Anomaly detection: ML algorithms identify unusual patterns (outliers, fraud indicators, statistical anomalies) that might be missed in sample-based testing. (3) Risk assessment: predictive models identify high-risk areas for audit focus. (4) Natural Language Processing (NLP): analyze contracts, correspondence, disclosures for key terms and risks. (5) Continuous auditing/monitoring: real-time analysis of transactions and controls. (6) Document extraction: OCR + ML to extract data from invoices, receipts, confirmations. (7) Predictive analytics: estimate account balances, identify trends. Challenges: (1) "Black box" problem — explainability of ML models. (2) Data quality and bias. (3) Professional standards still require human judgment. (4) Auditor competence in data analytics. (5) Independence consideration. Professional guidance: AU-C 500 (audit evidence), PCAOB guidance on data analytics. CPA relevance: understanding how emerging technologies are transforming audit methodology while maintaining professional standards.',
    reference: 'AICPA Audit Data Analytics Guide',
  },
];
