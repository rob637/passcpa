/**
 * CPA ISC Section - Questions Depth Batch 7
 * Blueprint Area: ISC-I (Information Systems)
 * Topics: IT Governance, ERP, SDLC, Database Management, Cloud Computing, IT Architecture
 */

import { Question } from '../../../types';

export const ISC_QUESTIONS_DEPTH_7: Question[] = [
  {
    id: 'isc-d7-001',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-it-governance',
    topic: 'IT Governance',
    subtopic: 'COBIT Framework',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'COBIT (Control Objectives for Information and Related Technologies) is primarily used for:',
    options: [
      'Software development only',
      'IT governance and management — providing a comprehensive framework that helps organizations align IT strategy with business objectives, manage risk, and ensure IT value delivery',
      'Physical security audits',
      'Network configuration management',
    ],
    correctAnswer: 1,
    explanation: 'COBIT (current version COBIT 2019 by ISACA) is a framework for IT governance and management. It provides: (1) Governance objectives — Evaluate, Direct, Monitor (EDM), (2) Management objectives — Align, Plan, Organize (APO); Build, Acquire, Implement (BAI); Deliver, Service, Support (DSS); Monitor, Evaluate, Assess (MEA). Key concepts: (1) Separation of governance (board level) from management (executive level), (2) Stakeholder needs cascade to enterprise goals → IT-related goals → enabler goals, (3) Design factors for tailoring governance, (4) Focus areas including small/medium enterprise, cybersecurity, DevOps. CPA relevance: COBIT is widely referenced by auditors for evaluating IT controls and governance.',
    reference: 'COBIT 2019 Framework',
  },
  {
    id: 'isc-d7-002',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Agile vs Waterfall',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'The primary difference between Agile and Waterfall software development methodologies is:',
    options: [
      'Waterfall is always faster',
      'Agile uses iterative, incremental development with frequent feedback loops and adaptive planning, while Waterfall follows a sequential, linear approach where each phase must be completed before the next begins',
      'Agile does not use any documentation',
      'Waterfall is best for rapidly changing requirements',
    ],
    correctAnswer: 1,
    explanation: 'Waterfall (traditional): Sequential phases — Requirements → Design → Implementation → Testing → Deployment → Maintenance. Each phase is completed before the next starts. Works well for: stable requirements, regulated environments, well-understood projects. Agile (iterative): Short sprints (1-4 weeks), delivering working software incrementally. Key practices: daily standups, sprint planning, retrospectives, user stories, continuous integration. Frameworks: Scrum, Kanban, SAFe (Scaled Agile). Works well for: evolving requirements, innovative projects, customer-facing apps. Audit implications: (1) Waterfall has clear milestones and documentation, (2) Agile requires different testing approaches — continuous testing, automated controls, (3) Both need change management controls, (4) Agile may have less formal documentation (auditors may need to adapt procedures).',
    reference: 'ISACA; Agile Alliance',
  },
  {
    id: 'isc-d7-003',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-databases',
    topic: 'Database Management',
    subtopic: 'Relational Database Concepts',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'In a relational database, referential integrity ensures that:',
    options: [
      'All data is encrypted at rest',
      'A foreign key value in one table must match an existing primary key value in the referenced table (or be null), preventing orphaned records',
      'Only administrators can access the database',
      'Data is automatically backed up',
    ],
    correctAnswer: 1,
    explanation: 'Referential integrity: a database constraint ensuring relationships between tables remain consistent. A foreign key in a child table must reference a valid primary key in the parent table. Example: an invoice line item\'s customer_id must match an existing customer in the customers table. Prevents: (1) Orphaned records (child records referencing non-existent parents), (2) Cascade actions: ON DELETE CASCADE (delete children when parent deleted), ON DELETE RESTRICT (prevent parent deletion if children exist), ON DELETE SET NULL. Other database integrity types: (1) Entity integrity — primary keys must be unique and non-null, (2) Domain integrity — column values must meet defined constraints (data type, range, format), (3) User-defined integrity — business rules enforced through triggers and stored procedures. CPA relevance: database integrity controls support processing integrity and data reliability for financial reporting.',
    reference: 'Database Systems Concepts',
  },
  {
    id: 'isc-d7-004',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-cloud',
    topic: 'Cloud Computing',
    subtopic: 'Service Models — IaaS, PaaS, SaaS',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'Which cloud service model gives the customer the MOST control over the computing environment?',
    options: [
      'Software as a Service (SaaS)',
      'Infrastructure as a Service (IaaS) — the customer manages the OS, applications, data, and middleware, while the provider manages the physical hardware, virtualization, and networking',
      'Platform as a Service (PaaS)',
      'Function as a Service (FaaS)',
    ],
    correctAnswer: 1,
    explanation: 'Cloud service models (most to least customer control): (1) IaaS — customer controls: OS, runtime, applications, data; provider controls: hardware, virtualization, networking. Examples: AWS EC2, Azure VMs, Google Compute Engine. (2) PaaS — customer controls: applications and data; provider controls: OS, runtime, middleware, hardware. Examples: Heroku, Azure App Service, Google App Engine. (3) SaaS — customer controls: configuration, data; provider controls: everything else. Examples: Office 365, Salesforce, Google Workspace. (4) FaaS (Serverless) — customer controls: code/functions only; provider controls: all infrastructure. Examples: AWS Lambda, Azure Functions. Audit implication: the shared responsibility model — as you move from IaaS to SaaS, more security responsibility shifts to the provider, but the organization retains responsibility for data governance.',
    reference: 'NIST SP 800-145; CSA',
  },
  {
    id: 'isc-d7-005',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-systems',
    topic: 'Enterprise Systems',
    subtopic: 'ERP Systems',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A key audit risk with Enterprise Resource Planning (ERP) systems is:',
    options: [
      'They cannot process financial transactions',
      'A misconfigured access control in the ERP can allow unauthorized transactions across multiple business processes (procurement, payroll, GL), since all modules share a common database',
      'They are only used by manufacturing companies',
      'ERP systems do not support automation',
    ],
    correctAnswer: 1,
    explanation: 'ERP systems (SAP, Oracle, Microsoft Dynamics) integrate all business functions into a single system with a common database. Audit risks: (1) Access control — ERP roles can be complex; misconfiguration may allow users excessive privileges across modules (e.g., ability to create vendors AND approve payments → fraud risk), (2) Segregation of duties (SoD) — must be carefully designed since all functions are in one system, (3) Configuration changes — ERP customization can introduce control gaps, (4) Data integrity — all modules share data; errors propagate across the system, (5) Master data management — unauthorized changes to vendor/customer/employee master files affect all processes, (6) Change management — ERP upgrades/patches are complex and risky. Controls: SoD matrix review, periodic access recertification, automated SoD conflict detection, change management procedures, audit logging.',
    reference: 'ISACA IT Audit Resources',
  },
  {
    id: 'isc-d7-006',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-network',
    topic: 'Network Architecture',
    subtopic: 'Network Segmentation',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Network segmentation divides a network into smaller segments using firewalls, VLANs, or other controls. The PRIMARY security benefit is:',
    options: [
      'Increased internet speed',
      'Limiting the blast radius of a security breach — if one segment is compromised, the attacker cannot easily move laterally to other segments containing sensitive systems or data',
      'Reducing the number of servers needed',
      'Eliminating all malware',
    ],
    correctAnswer: 1,
    explanation: 'Network segmentation controls: (1) VLANs — logically separate network traffic at Layer 2, (2) Firewalls — filter traffic between segments at Layer 3/4/7, (3) DMZ (Demilitarized Zone) — isolate public-facing servers from internal networks, (4) Micro-segmentation — fine-grained segmentation at the workload level (zero trust approach). Benefits: (1) Limit lateral movement — attackers who compromise one segment cannot easily reach others, (2) Reduce attack surface — sensitive systems (financial databases, PII stores) are isolated, (3) Compliance — PCI DSS requires segmentation of cardholder data environment (CDE), (4) Performance — reduce broadcast domains. CPA relevance: auditors evaluate network segmentation to assess whether financial reporting systems are adequately protected from lower-security zones.',
    reference: 'NIST SP 800-41; PCI DSS',
  },
  {
    id: 'isc-d7-007',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Change Management Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'Which of the following is the MOST important change management control for financial reporting systems?',
    options: [
      'Allowing developers to directly modify production code',
      'Requiring formal change requests, testing in a non-production environment, approval by authorized personnel, and separation between development and production environments',
      'Deploying changes immediately without testing',
      'Only documenting changes annually',
    ],
    correctAnswer: 1,
    explanation: 'Change management (ITGC): Key controls: (1) Formal change request — documented business justification and approval before development, (2) Separate environments — development, test/QA, staging, production — developers should NOT have direct access to production, (3) Testing — functional, regression, user acceptance testing (UAT) before deployment, (4) Approval — business and IT management authorization before production deployment, (5) Rollback plan — procedures to revert changes if issues arise, (6) Emergency change process — expedited process for critical fixes, with retroactive documentation and approval, (7) Post-implementation review — verify change works as intended. Why this matters for CPAs: (1) Unauthorized changes to financial applications could alter calculations, bypass controls, or corrupt data, (2) PCAOB AS 2201 requires evaluation of ITGCs including change management, (3) SOX 404 — change management failures can result in material weaknesses.',
    reference: 'ITIL; PCAOB AS 2201; SOX §404',
  },
  {
    id: 'isc-d7-008',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-data-management',
    topic: 'Data Management',
    subtopic: 'Data Warehouse vs Data Lake',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'The key difference between a data warehouse and a data lake is:',
    options: [
      'Data warehouses store more data',
      'A data warehouse stores structured, processed, schema-on-write data optimized for analytics and reporting, while a data lake stores raw data in any format (structured, semi-structured, unstructured) using a schema-on-read approach',
      'Data lakes are always cloud-based',
      'Data warehouses do not support SQL queries',
    ],
    correctAnswer: 1,
    explanation: 'Data Warehouse: (1) Stores structured, cleaned, transformed data (ETL process before loading), (2) Schema-on-write — data must conform to a predefined schema before loading, (3) Optimized for complex queries and reporting (OLAP), (4) Examples: Snowflake, Amazon Redshift, Google BigQuery. Data Lake: (1) Stores raw data in native format — structured (CSV, tables), semi-structured (JSON, XML), unstructured (images, logs, text), (2) Schema-on-read — schema is applied when data is queried (not when stored), (3) Supports data science, machine learning, and exploratory analytics, (4) Examples: Amazon S3-based lakes, Azure Data Lake, Apache Hadoop. CPA relevance: (1) Data warehouses feed financial dashboards and analytics used by auditors, (2) Data governance controls are critical for both — ensuring data quality, lineage, and integrity, (3) Data lakes may store source data useful for substantive audit procedures.',
    reference: 'DAMA Data Management Body of Knowledge',
  },
  {
    id: 'isc-d7-009',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-it-governance',
    topic: 'IT Governance',
    subtopic: 'IT Strategic Planning',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A key element of IT strategic alignment is ensuring that:',
    options: [
      'IT operates independently from business strategy',
      'IT investments and initiatives directly support the organization\'s business objectives and strategy, with appropriate governance structures to oversee value delivery, risk management, and resource optimization',
      'All employees are trained in programming',
      'IT budgets are minimized',
    ],
    correctAnswer: 1,
    explanation: 'IT strategic alignment (ISACA/COBIT concept): IT should enable and support business objectives, not operate in a silo. Key practices: (1) IT strategy developed in conjunction with business strategy, (2) IT steering committee — cross-functional governance body with business and IT leaders, (3) IT balanced scorecard — measuring IT performance against business value, (4) Portfolio management — prioritizing IT investments based on business value and risk, (5) Service level agreements (SLAs) between IT and business units. COBIT EDM01 (Ensure Governance Framework Setting and Maintenance): Board ensures IT governance is embedded in enterprise governance. Audit focus: (1) Does the IT strategy align with the business plan? (2) Is there an IT steering committee with appropriate authority? (3) Are IT investments evaluated for business value? (4) Is there adequate oversight of IT risks?',
    reference: 'COBIT 2019; ISACA',
  },
  {
    id: 'isc-d7-010',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-itgc',
    topic: 'IT General Controls',
    subtopic: 'Computer Operations Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'IT General Controls (ITGCs) related to computer operations include all of the following EXCEPT:',
    options: [
      'Job scheduling and monitoring',
      'Backup and recovery procedures',
      'Incident management and problem resolution',
      'Revenue recognition policy determination',
    ],
    correctAnswer: 3,
    explanation: 'ITGC categories (PCAOB AS 2201): (1) Program development — controls over design, development, and testing of new applications, (2) Program changes — change management (formal requests, testing, approval, deployment), (3) Access to programs and data — logical access controls (authentication, authorization, user provisioning, periodic access reviews), (4) Computer operations — job scheduling, batch processing monitoring, backup and recovery, incident management, data center environmental controls (power, cooling, fire suppression). Revenue recognition policy → accounting policy decision, NOT an ITGC. ITGCs provide the foundation for application controls — if ITGCs are deficient, the auditor cannot rely on automated application controls. PCAOB requires evaluation of ITGCs for applications relevant to financial reporting.',
    reference: 'PCAOB AS 2201; AICPA',
  },
  {
    id: 'isc-d7-011',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-systems',
    topic: 'Enterprise Systems',
    subtopic: 'System Integration',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'When evaluating interface controls between two financial systems, an auditor should verify that:',
    options: [
      'The systems use the same programming language',
      'Completeness and accuracy controls exist — such as record counts, hash totals, and reconciliation procedures — to ensure that all transactions are transferred correctly and completely between systems',
      'Both systems are hosted on the same server',
      'The interface runs only during business hours',
    ],
    correctAnswer: 1,
    explanation: 'Interface/integration controls ensure data transferred between systems is complete, accurate, and authorized. Key controls: (1) Completeness — record counts, control totals (hash totals, batch totals) compared between sending and receiving systems, (2) Accuracy — validation of data types, formats, and values on receipt, (3) Authorization — only authorized interfaces can send/receive data, (4) Error handling — exception reports for failed transfers, error queues, reprocessing procedures, (5) Timeliness — monitoring to ensure transfers complete within expected windows, (6) Reconciliation — automated or manual reconciliation between systems (e.g., AP subledger to GL). Types: (1) Batch interfaces — periodic file transfers (nightly, hourly), (2) Real-time interfaces — API calls, message queues, (3) ETL processes — extract, transform, load for data warehouses. Audit approach: test a sample of transfers for completeness and accuracy, review exception reports.',
    reference: 'PCAOB AS 2201; ISACA',
  },
  {
    id: 'isc-d7-012',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-cloud',
    topic: 'Cloud Computing',
    subtopic: 'Cloud Deployment Models',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'A hybrid cloud deployment model combines:',
    options: [
      'Only public cloud services from multiple providers',
      'Private cloud and public cloud infrastructure, allowing data and applications to be shared between them while maintaining security for sensitive workloads in the private cloud',
      'Physical servers in multiple offices',
      'Cloud services with no internet connectivity',
    ],
    correctAnswer: 1,
    explanation: 'Cloud deployment models (NIST SP 800-145): (1) Public cloud — shared infrastructure operated by a third-party provider (AWS, Azure, GCP), available to the general public, multi-tenant, (2) Private cloud — dedicated infrastructure for a single organization (on-premises or hosted), greater control but higher cost, (3) Hybrid cloud — combination of public and private, with orchestration between them. Benefits: keep sensitive data in private cloud, use public cloud for scalable/non-sensitive workloads (cloud bursting), (4) Community cloud — shared by organizations with common interests (government, healthcare). CPA considerations: (1) Data sovereignty — where is data stored geographically? (2) Shared responsibility — who is responsible for what controls? (3) Vendor lock-in risk, (4) SOC reports for cloud providers, (5) Data portability and exit strategy.',
    reference: 'NIST SP 800-145',
  },
  {
    id: 'isc-d7-013',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-databases',
    topic: 'Database Management',
    subtopic: 'Database Normalization',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'Database normalization is the process of:',
    options: [
      'Encrypting all database fields',
      'Organizing data to reduce redundancy and dependency by dividing large tables into smaller, related tables, improving data integrity and reducing the risk of update anomalies',
      'Deleting old records to save space',
      'Converting databases from SQL to NoSQL',
    ],
    correctAnswer: 1,
    explanation: 'Normalization: organizing data structure to reduce redundancy. Normal forms: (1) First Normal Form (1NF) — eliminate repeating groups; each cell contains a single value, (2) Second Normal Form (2NF) — 1NF + eliminate partial dependencies (all non-key attributes depend on the entire primary key), (3) Third Normal Form (3NF) — 2NF + eliminate transitive dependencies (non-key attributes depend only on the primary key, not on other non-key attributes). Benefits: (1) Reduced data redundancy, (2) Prevent update/insert/delete anomalies, (3) Improved data integrity. Trade-offs: (1) More tables = more joins needed for queries (potential performance impact), (2) For reporting, denormalized structures (star schemas) may be preferred. CPA relevance: properly normalized databases support data integrity controls — updates in one place propagate correctly, reducing risk of inconsistent financial data.',
    reference: 'Database Design Fundamentals',
  },
  {
    id: 'isc-d7-014',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Testing Methodologies',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'User Acceptance Testing (UAT) in the SDLC is performed by:',
    options: [
      'Software developers only',
      'End users (business stakeholders) to validate that the system meets business requirements and functions correctly in real-world scenarios before production deployment',
      'The database administrator',
      'External auditors',
    ],
    correctAnswer: 1,
    explanation: 'Testing levels in SDLC: (1) Unit testing — developers test individual modules/functions, (2) Integration testing — test interfaces between modules, (3) System testing — test the complete system against specifications, (4) User Acceptance Testing (UAT) — business users test against requirements. UAT types: (1) Alpha testing — internal users in development environment, (2) Beta testing — external users in production-like environment, (3) Contract acceptance testing — against contractual requirements, (4) Regulation acceptance testing — verify compliance requirements. UAT best practices: (1) Business users write test cases based on requirements, (2) Sign-off required before go-live, (3) Defect tracking and resolution, (4) Testing with realistic data. Audit focus: (1) Was UAT completed satisfactorily? (2) Were issues resolved before deployment? (3) Was formal sign-off obtained? (4) Were appropriate users involved?',
    reference: 'SDLC Best Practices; ISACA',
  },
  {
    id: 'isc-d7-015',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-it-governance',
    topic: 'IT Governance',
    subtopic: 'IT Risk Management',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'In IT risk management, residual risk is defined as:',
    options: [
      'The total risk before controls are applied',
      'The risk that remains after controls and mitigation measures have been implemented — organizations accept residual risk when it falls within their risk appetite/tolerance',
      'Risk that has been completely eliminated',
      'Risk that only affects IT systems, not business operations',
    ],
    correctAnswer: 1,
    explanation: 'Risk concepts: (1) Inherent risk — risk before any controls are applied (raw risk), (2) Control risk — risk that controls fail to prevent or detect threats, (3) Residual risk — risk remaining after controls are implemented. Formula: Residual Risk = Inherent Risk − Control Effectiveness. Risk treatment options: (1) Mitigate — implement controls to reduce risk, (2) Transfer — insurance, outsourcing, contracts (shift financial impact), (3) Accept — risk is within tolerance (document the acceptance decision), (4) Avoid — eliminate the risk by eliminating the activity. Risk appetite: amount of risk an organization is willing to accept (set by the board). Risk tolerance: acceptable variation around risk appetite (set by management). CPA relevance: understanding residual risk helps auditors assess whether controls adequately address financial reporting risks.',
    reference: 'COSO ERM; NIST RMF; ISO 27005',
  },
  {
    id: 'isc-d7-016',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-data-management',
    topic: 'Data Management',
    subtopic: 'Data Governance Framework',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A data governance framework typically includes:',
    options: [
      'Only technical data storage specifications',
      'Policies, procedures, roles (data owners, data stewards, data custodians), data quality standards, and oversight mechanisms to ensure data is accurate, consistent, secure, and used appropriately across the organization',
      'Only the IT department\'s responsibilities',
      'Hardware inventory tracking',
    ],
    correctAnswer: 1,
    explanation: 'Data governance roles: (1) Data owner — business manager responsible for data classification, access decisions, and ensuring data quality for their domain (usually a business executive, not IT), (2) Data steward — implements day-to-day data quality practices (data cleansing, metadata management, resolving data issues), (3) Data custodian — IT role responsible for technical aspects (storage, backup, security implementation, database administration). Key elements: (1) Data quality management (accuracy, completeness, timeliness, consistency), (2) Data classification (confidential, internal, public), (3) Data lifecycle management (creation, storage, usage, archival, destruction), (4) Metadata management (data dictionaries, lineage), (5) Data privacy compliance (GDPR, CCPA). CPA relevance: poor data governance → unreliable financial data → material misstatement risk.',
    reference: 'DAMA DMBOK; COBIT 2019',
  },
  {
    id: 'isc-d7-017',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-network',
    topic: 'Network Architecture',
    subtopic: 'OSI Model Layers',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'The OSI (Open Systems Interconnection) model has seven layers. Which layer is responsible for end-to-end communication, flow control, and connection management between hosts?',
    options: [
      'Layer 1 — Physical',
      'Layer 4 — Transport (which includes protocols such as TCP and UDP)',
      'Layer 7 — Application',
      'Layer 2 — Data Link',
    ],
    correctAnswer: 1,
    explanation: 'OSI Model (bottom to top): Layer 1 — Physical: electrical signals, cables, connectors. Layer 2 — Data Link: MAC addresses, switches, frames, error detection. Layer 3 — Network: IP addresses, routing, packets (routers). Layer 4 — Transport: end-to-end communication, port numbers, flow control, segmentation. TCP (reliable, connection-oriented) and UDP (unreliable, connectionless). Layer 5 — Session: manages sessions between applications. Layer 6 — Presentation: data formatting, encryption/decryption, compression. Layer 7 — Application: HTTP, SMTP, FTP, DNS — user-facing protocols. CPA/audit relevance: understanding network layers helps assess where controls operate — firewalls at Layer 3/4 (packet filtering), Layer 7 (application firewalls/WAF), encryption at Layer 6/7 (TLS/SSL), access controls at Layer 2 (port security).',
    reference: 'ISO/IEC 7498-1; OSI Reference Model',
  },
  {
    id: 'isc-d7-018',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-controls',
    topic: 'Application Controls',
    subtopic: 'Input Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'A limit check (also called a reasonableness check) is an application input control that:',
    options: [
      'Verifies the user\'s password',
      'Tests whether a numeric value falls within a predefined acceptable range, flagging or rejecting entries that exceed maximum or minimum thresholds',
      'Counts the number of users online',
      'Monitors network bandwidth usage',
    ],
    correctAnswer: 1,
    explanation: 'Application input controls ensure data entered is valid, complete, and authorized. Types: (1) Limit/reasonableness check — numeric values within acceptable ranges (e.g., hours worked cannot exceed 80/week), (2) Validity check — input matches valid values from a master file (e.g., state code must be a valid US state), (3) Format/field check — data matches expected format (date = MM/DD/YYYY), (4) Check digit — calculated digit appended to numeric fields (e.g., Luhn algorithm for credit cards), (5) Completeness check — all required fields are populated, (6) Sequence check — transactions are in expected order, (7) Sign check — numeric field has correct positive/negative sign, (8) Batch controls — record counts, hash totals, control totals to verify batch completeness. CPA relevance: input controls prevent garbage-in-garbage-out, directly supporting data integrity for financial transactions.',
    reference: 'AICPA; ISACA',
  },
  {
    id: 'isc-d7-019',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-systems',
    topic: 'Enterprise Systems',
    subtopic: 'Middleware and APIs',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An API (Application Programming Interface) introduces audit risks related to:',
    options: [
      'Physical server temperature',
      'Unauthorized data access, data integrity during transmission, and the need for authentication/authorization controls — if API security is weak, external parties could access or manipulate financial data',
      'Monitor resolution',
      'Keyboard input speed',
    ],
    correctAnswer: 1,
    explanation: 'API security considerations: (1) Authentication — verify the identity of the calling application/user (API keys, OAuth 2.0 tokens, mutual TLS), (2) Authorization — ensure the authenticated caller has permission for the requested action (role-based, scope-based), (3) Data integrity — validate input (prevent injection attacks), ensure data is not modified in transit (TLS encryption), (4) Rate limiting — prevent abuse/denial of service, (5) Logging and monitoring — audit trails for API calls (who called what, when, with what data), (6) Input validation — prevent SQL injection, XSS via malformed API inputs, (7) API gateway — centralized security, throttling, and monitoring. Financial system risks: (1) Unauthorized data extraction via insecure APIs (e.g., customer PII, financial records), (2) Unauthorized transactions if write APIs lack proper authorization, (3) Data leakage through verbose error messages.',
    reference: 'OWASP API Security Top 10; NIST',
  },
  {
    id: 'isc-d7-020',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'DevOps and CI/CD',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'In a DevOps environment with continuous integration/continuous deployment (CI/CD), the auditor\'s primary concern is that:',
    options: [
      'Changes are deployed too slowly',
      'Automated deployment pipelines may bypass traditional change management controls — the auditor must verify that automated testing, code review, approval gates, and logging are embedded in the CI/CD pipeline to maintain control effectiveness',
      'Only one developer writes code',
      'The organization uses open-source software',
    ],
    correctAnswer: 1,
    explanation: 'CI/CD audit considerations: CI (Continuous Integration): developers frequently merge code into a shared repository; automated builds and tests run on each merge. CD (Continuous Deployment): code automatically deploys to production after passing automated tests. Audit risks: (1) Traditional manual change approval may not exist — need automated approval gates, (2) Rapid deployment frequency means errors can reach production faster. Controls: (1) Automated testing (unit, integration, security scans) as quality gates, (2) Code review requirements (peer reviews, pull request approvals), (3) Approval gates — automated or manual checkpoints before production deployment, (4) Immutable audit logs of all pipeline activities, (5) Infrastructure as Code (IaC) — changes to infrastructure are version-controlled and reviewed, (6) Rollback mechanisms — automated rollback on failure. Auditor approach: evaluate the pipeline itself as a control system; test whether automated controls are configured and operating effectively.',
    reference: 'ISACA DevOps Audit; NIST',
  },
  {
    id: 'isc-d7-021',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-it-governance',
    topic: 'IT Governance',
    subtopic: 'ITIL Service Management',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'ITIL (Information Technology Infrastructure Library) is a framework for:',
    options: [
      'Software programming standards',
      'IT service management (ITSM) — providing best practices for delivering IT services to meet business needs through service strategy, design, transition, operation, and continual service improvement',
      'Database design only',
      'Physical network cable standards',
    ],
    correctAnswer: 1,
    explanation: 'ITIL (current version ITIL 4): IT service management framework. Key practices (formerly processes): (1) Incident management — restore normal service as quickly as possible, (2) Problem management — identify root causes of recurring incidents, (3) Change enablement — manage changes to minimize risk, (4) Service request management — handle routine service requests, (5) Service level management — define and monitor SLAs, (6) Service desk — single point of contact for users, (7) Release management — plan and control software releases, (8) Configuration management — maintain accurate records of IT assets and their relationships (CMDB). ITIL 4 guiding principles: focus on value, start where you are, progress iteratively, collaborate, think holistically, keep it simple, optimize and automate. CPA relevance: ITIL practices support IT controls — incident management, change management, and service continuity directly affect financial system reliability.',
    reference: 'ITIL 4 Foundation; AXELOS',
  },
  {
    id: 'isc-d7-022',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-data-management',
    topic: 'Data Management',
    subtopic: 'Data Quality Dimensions',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'The key dimensions of data quality include:',
    options: [
      'Only speed of data retrieval',
      'Accuracy, completeness, consistency, timeliness, and validity — each dimension ensures data is fit for its intended use in decision-making and financial reporting',
      'Font size and color of data displays',
      'Database storage capacity',
    ],
    correctAnswer: 1,
    explanation: 'Data quality dimensions: (1) Accuracy — data correctly represents the real-world entity or event (e.g., transaction amounts match source documents), (2) Completeness — all required data is present (no missing values, fields, or records), (3) Consistency — data values are consistent across systems and time (e.g., customer address is the same in billing and shipping systems), (4) Timeliness — data is available when needed and reflects current state (not stale), (5) Validity — data conforms to defined business rules and formats (e.g., dates in correct format, valid codes), (6) Uniqueness — no duplicate records. Additional: (7) Integrity — referential integrity maintained, (8) Relevance — data is useful for its intended purpose. CPA relevance: data quality directly impacts financial reporting reliability — auditors assess data quality controls to determine if audit evidence from systems is reliable.',
    reference: 'DAMA DMBOK; ISO 8000',
  },
  {
    id: 'isc-d7-023',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-controls',
    topic: 'Application Controls',
    subtopic: 'Output Controls',
    difficulty: 'medium',
    skillLevel: 'Application',
    question: 'An output control designed to ensure report distribution is restricted to authorized recipients is:',
    options: [
      'A hash total on input data',
      'A distribution list that defines who should receive each report, combined with access restrictions on report repositories and secure delivery mechanisms',
      'A check digit on account numbers',
      'An input validation rule',
    ],
    correctAnswer: 1,
    explanation: 'Output controls ensure information produced by systems is complete, accurate, and distributed only to authorized users. Key controls: (1) Distribution lists — formally define authorized recipients for each report, (2) Report access controls — role-based access to report repositories (SharePoint, report servers), (3) Secure delivery — encrypted email for sensitive reports, secure file transfer, (4) Report reconciliation — verify output totals match expected values (compare to input batch totals), (5) Exception reports — highlight anomalies for management review, (6) Report retention — defined retention periods and secure destruction, (7) Sensitive report handling — confidential labels, restricted printing, watermarks, DLP controls. CPA relevance: (1) Financial reports (trial balance, aging reports, bank reconciliation) used for audit evidence must be reliable, (2) Unauthorized access to financial reports could lead to insider trading or fraud, (3) Report integrity supports IT-dependent manual controls.',
    reference: 'AICPA IT Controls; ISACA',
  },
  {
    id: 'isc-d7-024',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-network',
    topic: 'Network Architecture',
    subtopic: 'Virtual Private Network (VPN)',
    difficulty: 'easy',
    skillLevel: 'Remembering and Understanding',
    question: 'A Virtual Private Network (VPN) provides:',
    options: [
      'Faster internet speeds',
      'An encrypted tunnel over a public network (such as the internet), enabling secure remote access to an organization\'s internal network as if the user were physically connected to the local network',
      'Physical server protection',
      'Unlimited cloud storage',
    ],
    correctAnswer: 1,
    explanation: 'VPN types: (1) Remote Access VPN — individual users connect to the corporate network from remote locations (uses client software), (2) Site-to-Site VPN — connects two office networks over the internet (always-on, router/firewall-based). Protocols: (1) IPsec — Layer 3 encryption (network layer), (2) SSL/TLS VPN — Layer 4-7 encryption (often accessed via web browser, e.g., Cisco AnyConnect), (3) WireGuard — modern, lightweight protocol. Security features: (1) Encryption — protects data in transit from eavesdropping, (2) Authentication — certificates, multi-factor authentication, (3) Tunnel — encapsulates traffic to prevent interception. CPA relevance: (1) Remote work security — VPNs protect access to financial systems from home/travel, (2) Compensating control for remote access risk, (3) Auditors should verify VPN requires MFA, uses strong encryption, and has appropriate access controls and logging.',
    reference: 'NIST SP 800-77; VPN Technologies',
  },
  {
    id: 'isc-d7-025',
    section: 'ISC',
    courseId: 'cpa',
    blueprintArea: 'ISC-I',
    topicId: 'isc-databases',
    topic: 'Database Management',
    subtopic: 'NoSQL Databases',
    difficulty: 'medium',
    skillLevel: 'Remembering and Understanding',
    question: 'NoSQL databases differ from traditional relational databases in that they:',
    options: [
      'Cannot store any data',
      'Offer flexible schemas and horizontal scalability, supporting unstructured and semi-structured data (document, key-value, column-family, and graph models), but may sacrifice strict ACID compliance for availability and partition tolerance (CAP theorem)',
      'Only run on mainframe computers',
      'Always provide stronger data integrity than SQL databases',
    ],
    correctAnswer: 1,
    explanation: 'NoSQL database types: (1) Document stores (MongoDB, CouchDB) — JSON-like documents, flexible schema, (2) Key-Value stores (Redis, DynamoDB) — simple key-value pairs, fast lookups, (3) Column-Family (Cassandra, HBase) — data organized by columns, optimized for large datasets, (4) Graph databases (Neo4j, Amazon Neptune) — nodes and edges, ideal for relationship-heavy data. CAP theorem: distributed systems can guarantee at most 2 of 3: Consistency, Availability, Partition tolerance. Many NoSQL databases sacrifice strict consistency (eventual consistency) for availability and scalability. Audit considerations: (1) Flexible schemas may lead to data quality issues, (2) Eventual consistency means data might not be immediately consistent across nodes, (3) Auditors need to understand the data model to extract and validate data, (4) Some NoSQL databases lack mature auditing/logging features compared to RDBMS.',
    reference: 'Database Architecture; ISACA',
  },
];
