// ISC - Information Systems and Controls Expanded Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Second batch

import { Question } from '../../../types';

export const ISC_QUESTIONS_EXPANDED: Question[] = [
  // ==========================================
  // AREA I: Information Systems
  // ==========================================
  {
    id: 'isc-exp-001',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'Database Architecture',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'Database normalization to third normal form (3NF) eliminates:',
    options: [
      'All data redundancy',
      'Foreign keys',
      'Transitive dependencies (non-key attributes depending on other non-key attributes)',
      'Primary keys',
    ],
    correctAnswer: 2,
    explanation: '1NF: atomic values, no repeating groups. 2NF: 1NF + no partial dependencies (non-key depends on full PK). 3NF: 2NF + no transitive dependencies (non-key depends only on PK). Reduces redundancy and anomalies.',
    reference: 'Database Design - Normalization',
  },
  {
    id: 'isc-exp-002',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'Data Warehousing',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'A data warehouse differs from an operational database by:',
    options: [
      'Being subject-oriented, integrated, time-variant, and non-volatile for decision support',
      'Processing more transactions',
      'Using real-time processing',
      'Having less data',
    ],
    correctAnswer: 0,
    explanation: 'Data warehouse: subject-oriented (by business area), integrated (consistent), time-variant (historical), non-volatile (no updates, only loads). OLAP vs OLTP. Supports analysis, reporting, decision-making.',
    reference: 'Data Warehousing Concepts',
  },
  {
    id: 'isc-exp-003',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'ERP Systems',
    difficulty: 'medium',
    blueprintArea: 'ISC-I',
    skillLevel: 'Application',
    question: 'The primary benefit of an Enterprise Resource Planning (ERP) system is:',
    options: [
      'Reduced training needs',
      'Integration of business processes and data across the organization',
      'Lower hardware costs',
      'Elimination of all controls',
    ],
    correctAnswer: 1,
    explanation: 'ERP integrates: finance, HR, supply chain, manufacturing, CRM into single system with shared database. Benefits: data consistency, real-time visibility, process standardization. Challenges: cost, complexity, change management.',
    reference: 'ERP Systems',
  },
  {
    id: 'isc-exp-004',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'SDLC',
    difficulty: 'medium',
    blueprintArea: 'ISC-I',
    skillLevel: 'Application',
    question: 'In the System Development Life Cycle (SDLC), user acceptance testing occurs during:',
    options: [
      'Planning phase',
      'Maintenance phase',
      'Analysis phase',
      'Implementation/testing phase before go-live',
    ],
    correctAnswer: 3,
    explanation: 'SDLC phases: Planning → Analysis → Design → Development → Testing (unit, integration, system, UAT) → Implementation → Maintenance. UAT verifies system meets business requirements before deployment.',
    reference: 'SDLC Phases',
  },

  // ==========================================
  // AREA II: Security, Confidentiality, Privacy
  // ==========================================
  {
    id: 'isc-exp-005',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topic: 'Information Security',
    subtopic: 'Access Controls',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An organization\'s change management process requires that all changes to production systems be tested in a staging environment before deployment. The auditor discovers that the staging environment was decommissioned 6 months ago due to cost reduction, and all changes have been deployed directly to production since then. What is the primary risk?',
    options: [
      'Direct-to-production deployment is more efficient and reduces costs',
      'Deploying untested changes directly to production increases the risk of system outages, data corruption, and security vulnerabilities — changes that would have been caught in testing may cause financial reporting system failures',
      'Staging environments are optional if the development team is experienced',
      'Production testing is sufficient because it uses real data',
    ],
    correctAnswer: 1,
    explanation: 'A staging environment is a critical control in the change management process. Without it: (1) defective code or configurations may cause production outages, (2) regression issues go undetected, (3) performance impacts are unknown until they affect users, and (4) the change management control is fundamentally weakened. For financial reporting systems, this represents a significant IT general control deficiency.',
    reference: 'Access Control Models',
  },
  {
    id: 'isc-exp-006',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Encryption',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Public key cryptography uses:',
    options: [
      'Shared secret keys only',
      'Same key for encryption and decryption',
      'Different keys - public key encrypts, private key decrypts (asymmetric)',
      'No keys',
    ],
    correctAnswer: 2,
    explanation: 'Asymmetric encryption: public key (shared) encrypts, private key (secret) decrypts. Enables digital signatures (sign with private, verify with public). RSA, ECC common algorithms. Slower than symmetric.',
    reference: 'Cryptography Fundamentals',
  },
  {
    id: 'isc-exp-007',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topic: 'Information Security',
    subtopic: 'Network Security',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An organization migrates its financial reporting system from an on-premises data center to a public cloud provider. During the migration, the auditor discovers that the organization did not update its risk assessment, did not evaluate the cloud provider\'s SOC 2 report, and did not modify its internal controls to address the shared responsibility model. What is the primary concern?',
    options: [
      'Cloud migrations do not require changes to the risk assessment or control framework',
      'The organization failed to assess and address the risks introduced by the cloud migration — shared responsibility models change the control landscape, and without updated risk assessments and controls, the organization may have unaddressed risks in the cloud environment',
      'Cloud providers assume all responsibility for financial data security',
      'SOC 2 reports are optional and provide no relevant audit evidence',
    ],
    correctAnswer: 1,
    explanation: 'Cloud migration fundamentally changes the control environment. The organization must: (1) update the risk assessment to address cloud-specific risks (data sovereignty, shared tenancy, API security), (2) evaluate the cloud provider\'s complementary user entity controls through SOC 2 reports, (3) implement controls aligned with the shared responsibility model, and (4) update monitoring to cover cloud-specific threats. Migrating without these steps creates unmanaged risk.',
    reference: 'Network Security Architecture',
  },
  {
    id: 'isc-exp-008',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Intrusion Detection',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'An Intrusion Detection System (IDS) differs from a firewall by:',
    options: [
      'Blocking traffic',
      'Monitoring and alerting on suspicious activity rather than blocking it',
      'Managing passwords',
      'Filtering email',
    ],
    correctAnswer: 1,
    explanation: 'IDS: monitors, detects, alerts on suspicious activity. IPS: IDS + prevention (blocks). Types: signature-based (known attacks), anomaly-based (abnormal behavior). Complement firewalls for defense in depth.',
    reference: 'Intrusion Detection Systems',
  },
  {
    id: 'isc-exp-009',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'GDPR Rights',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Under GDPR, the right to be forgotten (erasure) requires organizations to:',
    options: [
      'Delete all backups immediately',
      'Never delete any data',
      'Only delete data after 7 years',
      'Delete personal data upon request when no legitimate reason for retention exists',
    ],
    correctAnswer: 3,
    explanation: 'Right to erasure (Art. 17): delete personal data when: consent withdrawn, data no longer necessary, unlawful processing, legal obligation. Exceptions: legal claims, public interest, archiving. Must notify recipients.',
    reference: 'GDPR Data Subject Rights',
  },
  {
    id: 'isc-exp-010',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Breach Response',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'An organization\'s breach response plan should include:',
    options: [
      'Detection, containment, eradication, recovery, notification, and lessons learned',
      'Deleting all evidence',
      'Ignoring small breaches',
      'Paying ransoms immediately',
    ],
    correctAnswer: 0,
    explanation: 'Incident response: (1) Preparation, (2) Detection/Analysis, (3) Containment, (4) Eradication, (5) Recovery, (6) Post-incident (lessons learned). Notification per laws (GDPR 72 hrs, state laws). Preserve evidence.',
    reference: 'Incident Response Framework',
  },

  // ==========================================
  // AREA III: SOC Engagements
  // ==========================================
  {
    id: 'isc-exp-011',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-soc',
    topic: 'SOC Reports',
    subtopic: 'SOC 2 Trust Services',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'The Trust Services Criteria for SOC 2 include all of the following EXCEPT:',
    options: [
      'Security',
      'Availability',
      'Confidentiality',
      'Profitability',
    ],
    correctAnswer: 3,
    explanation: 'Trust Services Criteria: Security (common criteria - required), Availability, Processing Integrity, Confidentiality, Privacy. Security is foundation; others selected based on service relevance. Profitability is not a TSC.',
    reference: 'Trust Services Criteria',
  },
  {
    id: 'isc-exp-013',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-soc',
    topic: 'SOC Reports',
    subtopic: 'Management Assertions',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'In a SOC 2 report, management\'s assertion includes:',
    options: [
      'Only financial statement accuracy',
      'Competitor analysis',
      'The system description is accurate and controls are suitably designed and operated effectively',
      'Future performance guarantees',
    ],
    correctAnswer: 2,
    explanation: 'SOC 2 management assertion: (1) system description is fairly presented, (2) controls are suitably designed, (3) Type 2: controls operated effectively throughout period. CPA\'s opinion addresses these assertions.',
    reference: 'SOC 2 Reporting',
  },

  // ==========================================
  // AREA IV: Emerging Technology
  // ==========================================
  {
    id: 'isc-exp-014',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-blockchain',
    topic: 'Blockchain Technology',
    subtopic: 'Consensus Mechanisms',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Proof of work consensus mechanism:',
    options: [
      'Is centrally controlled',
      'Requires computational effort to validate transactions and add blocks',
      'Requires no energy',
      'Uses voting by stakeholders',
    ],
    correctAnswer: 1,
    explanation: 'Proof of Work: miners solve computational puzzles to validate and add blocks. First to solve gets reward. Energy intensive. Proof of Stake: validators stake cryptocurrency, selected based on stake. More efficient.',
    reference: 'Blockchain Consensus',
  },
  {
    id: 'isc-exp-015',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-blockchain',
    topic: 'Blockchain Technology',
    subtopic: 'Smart Contracts',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'A smart contract on blockchain:',
    options: [
      'Requires manual execution',
      'Automatically executes predefined terms when conditions are met',
      'Only handles cryptocurrency',
      'Can be changed after deployment',
    ],
    correctAnswer: 1,
    explanation: 'Smart contracts: self-executing code on blockchain. Triggered by conditions (e.g., payment received). Immutable once deployed (generally). Applications: escrow, supply chain, insurance claims automation.',
    reference: 'Smart Contracts',
  },
  {
    id: 'isc-exp-016',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-ai',
    topic: 'Artificial Intelligence',
    subtopic: 'Machine Learning Types',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Supervised machine learning differs from unsupervised by:',
    options: [
      'Not using data',
      'Working only with images',
      'Training on labeled data with known outcomes',
      'Requiring no input',
    ],
    correctAnswer: 2,
    explanation: 'Supervised: learns from labeled data (input-output pairs). Predicts/classifies new data. Unsupervised: finds patterns in unlabeled data (clustering, dimensionality reduction). Reinforcement: learns from rewards/penalties.',
    reference: 'Machine Learning Fundamentals',
  },
  {
    id: 'isc-exp-017',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-ai',
    topic: 'Artificial Intelligence',
    subtopic: 'AI Governance',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Evaluation',
    question: 'Key risks in AI systems that require governance include:',
    options: [
      'User interface design',
      'Bias, explainability, data privacy, model drift, and ethical concerns',
      'Processing speed only',
      'Hardware costs',
    ],
    correctAnswer: 1,
    explanation: 'AI governance addresses: bias (training data, algorithm), explainability (black box models), privacy (data used), security (adversarial attacks), drift (model degradation), ethics (fairness, transparency, accountability).',
    reference: 'AI Governance Framework',
  },
  {
    id: 'isc-exp-018',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-cloud',
    topic: 'Cloud Computing',
    subtopic: 'Shared Responsibility',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'In the cloud shared responsibility model for IaaS:',
    options: [
      'Provider manages everything',
      'Provider secures infrastructure; customer secures OS, applications, and data',
      'No security is needed',
      'Customer manages hardware',
    ],
    correctAnswer: 1,
    explanation: 'Shared responsibility varies by model. IaaS: customer responsible for OS, apps, data; provider for physical, network, hypervisor. PaaS: provider adds OS. SaaS: provider manages most; customer manages data, access.',
    reference: 'Cloud Security - Shared Responsibility',
  },
  {
    id: 'isc-exp-019',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-cloud',
    topic: 'Cloud Computing',
    subtopic: 'Cloud Risks',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Evaluation',
    question: 'Significant risks in cloud computing include:',
    options: [
      'Data sovereignty, vendor lock-in, multi-tenancy vulnerabilities, and data loss/leakage',
      'Faster processing',
      'Better scalability',
      'Lower costs',
    ],
    correctAnswer: 0,
    explanation: 'Cloud risks: data location/sovereignty (laws vary by jurisdiction), vendor lock-in, shared infrastructure vulnerabilities, compliance challenges, loss of control, availability/downtime, insider threats at provider.',
    reference: 'Cloud Computing Risks',
  },
  {
    id: 'isc-exp-020',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-rpa',
    topic: 'Robotic Process Automation',
    subtopic: 'RPA Controls',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Controls over RPA bots should include:',
    options: [
      'No monitoring needed',
      'Manual backup only',
      'Unlimited access permissions',
      'Access management, change control, exception handling, and audit logging',
    ],
    correctAnswer: 3,
    explanation: 'RPA controls: bot access management (least privilege), change management for bot code, exception handling and escalation, comprehensive logging, segregation of duties, monitoring bot actions and outcomes.',
    reference: 'RPA Governance and Controls',
  },

  // Additional comprehensive coverage
  {
    id: 'isc-exp-021',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-controls',
    topic: 'IT General Controls',
    subtopic: 'Change Management',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'Effective IT change management requires:',
    options: [
      'Immediate implementation',
      'Making changes without documentation',
      'Developer-only approval',
      'Request, approval, testing, implementation with rollback plan, and documentation',
    ],
    correctAnswer: 3,
    explanation: 'Change management: formal request, impact assessment, appropriate approval, testing (including UAT), scheduled implementation, rollback plan, post-implementation review, documentation. Prevents unauthorized changes.',
    reference: 'IT General Controls - Change Management',
  },
  {
    id: 'isc-exp-022',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-controls',
    topic: 'IT General Controls',
    subtopic: 'Segregation of Duties',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'In an IT environment, proper segregation of duties separates:',
    options: [
      'Only programmers',
      'Database activities only',
      'All users',
      'Development, operations, and security/administration functions',
    ],
    correctAnswer: 3,
    explanation: 'IT SOD: developers (create/change programs), operations (execute programs, manage production), security (grant access). Same person shouldn\'t code changes and move to production. Compensating controls if small IT shop.',
    reference: 'IT Segregation of Duties',
  },
  {
    id: 'isc-exp-023',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-controls',
    topic: 'Application Controls',
    subtopic: 'Input Controls',
    difficulty: 'medium',
    blueprintArea: 'ISC-I',
    skillLevel: 'Application',
    question: 'A check digit control verifies:',
    options: [
      'File completeness',
      'The accuracy of data entry using a calculated verification digit',
      'Total amount of a batch',
      'User authorization',
    ],
    correctAnswer: 1,
    explanation: 'Check digit: computed from other digits in a code (account number, UPC). System recalculates and compares. Catches transposition and transcription errors. Common in account numbers, credit cards (Luhn algorithm).',
    reference: 'Input Validation Controls',
  },
  {
    id: 'isc-exp-024',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-controls',
    topic: 'Application Controls',
    subtopic: 'Processing Controls',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'Run-to-run totals control ensures:',
    options: [
      'Reports are distributed',
      'Data processed from one step matches input to the next step',
      'Programs execute on time',
      'Users are authenticated',
    ],
    correctAnswer: 1,
    explanation: 'Run-to-run totals: verify completeness by comparing output totals from one processing step to input totals of next. Detects lost or added records during processing. Part of batch processing controls.',
    reference: 'Processing Controls',
  },
  {
    id: 'isc-exp-025',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-bcp',
    topic: 'Business Continuity',
    subtopic: 'Recovery Strategies',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'A hot site provides:',
    options: [
      'Mobile computing only',
      'Fully equipped facility with current data, ready for immediate use',
      'Empty space only',
      'Basic infrastructure without data',
    ],
    correctAnswer: 1,
    explanation: 'Recovery sites: Hot (fully equipped, current data, immediate failover), Warm (equipment, needs data restoration), Cold (space and power, needs everything). Cost vs recovery time tradeoff.',
    reference: 'Disaster Recovery Sites',
  },
  {
    id: 'isc-exp-026',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-bcp',
    topic: 'Business Continuity',
    subtopic: 'RTO and RPO',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Recovery Point Objective (RPO) determines:',
    options: [
      'Number of recovery personnel',
      'How long recovery takes',
      'The maximum acceptable data loss measured in time (backup frequency)',
      'Cost of recovery',
    ],
    correctAnswer: 2,
    explanation: 'RPO: max acceptable data loss (time since last backup). 1-hour RPO = hourly backups. RTO: max acceptable downtime (time to restore operations). Together they drive backup/recovery strategy and costs.',
    reference: 'BCP/DR Metrics',
  },
  {
    id: 'isc-exp-027',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-audit',
    topic: 'IT Audit',
    subtopic: 'Data Analytics',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'In IT audit, data analytics techniques include:',
    options: [
      'Only manual review',
      'Physical inspection',
      'Benford\'s Law analysis, duplicate detection, gap testing, and stratification',
      'Interviewing only',
    ],
    correctAnswer: 2,
    explanation: 'Audit analytics: Benford\'s Law (digit frequency for fraud), duplicate testing, gap analysis (sequence completeness), stratification (segment data), trend analysis, outlier detection. CAATTs automate testing.',
    reference: 'IT Audit - Data Analytics',
  },
  {
    id: 'isc-exp-028',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-I',
    topic: 'IT Audit',
    subtopic: 'Continuous Auditing',
    difficulty: 'hard',
    skillLevel: 'Evaluation',
    question: 'An IT auditor evaluating a client\'s ERP system discovers that the system administrator has modified production financial data directly in the database, bypassing the application\'s input controls and audit trail. What is the most significant control concern?',
    options: [
      'The modification is acceptable because the system administrator has the technical capability',
      'Direct database modifications bypass application-level controls (input validation, authorization workflows, and audit trails), which means the change cannot be traced, verified, or attributed through normal audit procedures, undermining data integrity',
      'Database-level access is only a concern for IT audits, not financial audits',
      'The system administrator is authorized to make any changes they deem necessary',
    ],
    correctAnswer: 1,
    explanation: 'Direct database manipulation is one of the most significant IT control breaches because it circumvents all application-layer controls designed to ensure data integrity. Without the application\'s audit trail, the change is invisible to normal monitoring. The auditor should: (1) assess what data was modified and its financial impact, (2) review database audit logs (if enabled), (3) evaluate who has database-level access, (4) assess segregation of duties, and (5) consider whether other unauthorized changes may have occurred.',
    reference: 'Continuous Auditing',
  },
  {    id: 'isc-exp-029',    courseId: 'cpa',    section: 'ISC',    blueprintArea: 'ISC-I',    topic: 'IT Governance',    subtopic: 'COBIT Framework',    difficulty: 'hard',    skillLevel: 'Analysis',    question: 'An IT governance committee reviews the organization\'s IT strategic plan and discovers there is no alignment between IT initiatives and business objectives. The CIO proposes major infrastructure upgrades without demonstrating how they support revenue growth, risk reduction, or regulatory compliance. What governance concern does this raise?',    options: [    'IT infrastructure decisions do not need to align with business objectives',    'Lack of IT-business alignment means IT investments may not deliver value — the governance committee should require IT initiatives to demonstrate clear linkage to business objectives, measureable benefits, and alignment with the entity\'s risk appetite and strategic direction',    'The CIO has sole authority over IT investments and does not need governance approval',    'IT governance only applies to public companies subject to SOX',    ],    correctAnswer: 1,    explanation: 'IT governance frameworks (COBIT, ISO 38500) emphasize IT-business alignment as a fundamental principle. When IT investments lack documented linkage to business objectives, the organization risks: (1) misallocation of capital, (2) investments that don\'t support strategic goals, (3) inability to measure ROI, and (4) technology decisions made in isolation that may increase rather than reduce risk. The governance committee should establish processes for evaluating IT investment alignment.',    reference: 'COBIT Framework',  },
  {
    id: 'isc-exp-030',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-governance',
    topic: 'IT Governance',
    subtopic: 'IT Risk Management',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'IT risk response strategies include:',
    options: [
      'Technology upgrades only',
      'Ignoring all risks',
      'Avoid, mitigate, transfer, or accept risks based on cost-benefit analysis',
      'Only insurance',
    ],
    correctAnswer: 2,
    explanation: 'Risk responses: Avoid (eliminate threat), Mitigate (reduce likelihood/impact with controls), Transfer (insurance, outsourcing), Accept (acknowledge and monitor). Selection based on risk appetite and cost-benefit.',
    reference: 'IT Risk Management',
  },
  {
    id: 'isc-exp-031',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Security Awareness',
    difficulty: 'medium',
    blueprintArea: 'ISC-II',
    skillLevel: 'Application',
    question: 'An effective security awareness program should:',
    options: [
      'Rely on technical controls only',
      'Focus only on IT staff',
      'Train employees once at hiring',
      'Provide ongoing training, phishing simulations, and policy reminders',
    ],
    correctAnswer: 3,
    explanation: 'Security awareness: ongoing (not one-time), all employees, covers policies, phishing recognition, social engineering, physical security. Simulations test effectiveness. Human element is often weakest link.',
    reference: 'Security Awareness Training',
  },
  {
    id: 'isc-exp-032',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Vulnerability Management',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'A vulnerability management program includes:',
    options: [
      'User training only',
      'Physical security only',
      'Installing antivirus only',
      'Scanning, prioritizing, patching, and verifying remediation of security weaknesses',
    ],
    correctAnswer: 3,
    explanation: 'Vulnerability management: identify (scanning), prioritize (by risk/CVSS), remediate (patching, configuration), verify (rescan), report. Continuous process. Penetration testing validates findings.',
    reference: 'Vulnerability Management',
  },
  {    id: 'isc-exp-033',    courseId: 'cpa',    section: 'ISC',    blueprintArea: 'ISC-II',    topic: 'Data Privacy',    subtopic: 'Privacy by Design',    difficulty: 'hard',    skillLevel: 'Evaluation',    question: 'A multinational company transfers customer personal data from its EU subsidiary to its US headquarters for financial consolidation purposes. The company has not executed Standard Contractual Clauses (SCCs) or obtained any other legal mechanism for the cross-border transfer. What is the regulatory exposure?',    options: [    'Cross-border data transfers within the same corporate group are automatically permitted',    'The transfer likely violates GDPR Article 46 — without an adequate legal transfer mechanism (SCCs, binding corporate rules, or adequacy decision), the company faces potential fines up to 4% of global annual turnover and possible injunctions to cease transfers',    'GDPR does not apply to financial consolidation data',    'The US provides adequate data protection and no transfer mechanism is needed',    ],    correctAnswer: 1,    explanation: 'GDPR restricts transfers of personal data outside the EEA unless adequate safeguards exist. Without SCCs, binding corporate rules, or other Article 46 mechanisms, the transfer is unlawful. Penalties are severe: up to €20M or 4% of global turnover. The auditor should assess: (1) the volume and sensitivity of transferred data, (2) potential regulatory enforcement, (3) financial exposure for fines and legal costs, and (4) whether contingent liability disclosure is needed.',    reference: 'Privacy by Design Framework',  },
  {
    id: 'isc-exp-034',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Minimization',
    difficulty: 'medium',
    blueprintArea: 'ISC-II',
    skillLevel: 'Application',
    question: 'Data minimization requires organizations to:',
    options: [
      'Share data freely',
      'Collect all available data',
      'Store data indefinitely',
      'Collect only data necessary for specified purposes and retain only as long as needed',
    ],
    correctAnswer: 3,
    explanation: 'Data minimization: collect only what\'s needed (purpose limitation), retain only as long as necessary, securely dispose when no longer needed. Core privacy principle across regulations (GDPR, CCPA).',
    reference: 'Data Minimization Principle',
  },
  {
    id: 'isc-exp-035',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-soc',
    topic: 'SOC Reports',
    subtopic: 'Report Limitations',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Evaluation',
    question: 'Limitations of SOC reports include:',
    options: [
      'No limitations exist',
      'Future predictions included',
      'Complete assurance provided',
      'Point-in-time assessment, reliance on CUECs, and scope limited to described system',
    ],
    correctAnswer: 3,
    explanation: 'SOC limitations: Type 1 = design only (point-in-time). Type 2 = specific period (may not reflect current state). Scope limited to described system. Relies on CUECs. Not guarantee of no breaches.',
    reference: 'SOC Report Limitations',
  },
  {
    id: 'isc-exp-036',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-soc',
    topic: 'SOC Reports',
    subtopic: 'SOC for Supply Chain',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'SOC for Supply Chain reports address:',
    options: [
      'Only financial controls',
      'Production and distribution controls for manufacturers and distributors',
      'Marketing effectiveness',
      'Employee payroll',
    ],
    correctAnswer: 1,
    explanation: 'SOC for Supply Chain: examines controls over production and distribution (not IT services). Addresses product risks (safety, quality, integrity). Uses Supply Chain Risk Management criteria. For product-related assurance.',
    reference: 'SOC for Supply Chain',
  },
  {
    id: 'isc-exp-037',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'IoT Security',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Evaluation',
    question: 'Key security concerns with Internet of Things (IoT) devices include:',
    options: [
      'Only physical theft',
      'No security concerns',
      'User interface design',
      'Limited computing resources for security, default credentials, and inadequate patching',
    ],
    correctAnswer: 3,
    explanation: 'IoT risks: resource constraints (weak encryption), default/hardcoded passwords, infrequent updates, large attack surface, data privacy, physical security, supply chain compromise. Require network segmentation, monitoring.',
    reference: 'IoT Security Challenges',
  },
  {
    id: 'isc-exp-038',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Quantum Computing',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Evaluation',
    question: 'Quantum computing poses a threat to current encryption because:',
    options: [
      'It can potentially break current asymmetric encryption algorithms much faster',
      'It uses less power',
      'It creates better firewalls',
      'It eliminates passwords',
    ],
    correctAnswer: 0,
    explanation: 'Quantum threat: Shor\'s algorithm can factor large numbers quickly (breaks RSA, ECC). Organizations need post-quantum cryptography planning. Symmetric encryption less affected (just need longer keys).',
    reference: 'Quantum Computing and Cryptography',
  },
  {
    id: 'isc-exp-039',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'DevSecOps',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'DevSecOps integrates security into development by:',
    options: [
      'Outsourcing security',
      'Adding security at the end',
      'Incorporating security testing throughout the CI/CD pipeline',
      'Eliminating security reviews',
    ],
    correctAnswer: 2,
    explanation: 'DevSecOps: security integrated throughout SDLC (not bolt-on at end). Automated security testing in CI/CD: SAST (code analysis), DAST (running app), SCA (dependencies), container scanning. Shift-left security.',
    reference: 'DevSecOps Practices',
  },
  {
    id: 'isc-exp-040',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Zero Trust Architecture',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Zero Trust security model is based on:',
    options: [
      'No security controls',
      'Trusting internal network traffic',
      'Perimeter security only',
      'Never trust, always verify - authenticating and authorizing every access request',
    ],
    correctAnswer: 3,
    explanation: 'Zero Trust: assume breach, verify explicitly, least privilege access. No implicit trust based on network location. Micro-segmentation, continuous authentication, encryption everywhere. Addresses modern threats.',
    reference: 'Zero Trust Architecture',
  },
];

