// ISC - Information Systems Mastery Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Mastery batch

import { Question } from '../../../types';

export const ISC_QUESTIONS_MASTERY: Question[] = [
  {
    id: 'isc-mast-001',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'Data Warehouse Architecture',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'The star schema in data warehouse design uses:',
    options: [
      'Highly normalized tables',
      'Central fact table surrounded by denormalized dimension tables',
      'Flat files only',
      'Linked lists',
    ],
    correctAnswer: 1,
    explanation: 'Star schema: central fact table (measures, foreign keys) surrounded by dimension tables (descriptive attributes). Denormalized for query performance. Snowflake schema normalizes dimensions further. Fact tables can be very large.',
    reference: 'Data Warehouse - Dimensional Modeling',
  },
  {
    id: 'isc-mast-002',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-I',
    topic: 'Information Systems',
    subtopic: 'API Security',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A company implements an enterprise resource planning (ERP) system with an integrated business intelligence (BI) module. The BI module provides executives with real-time financial dashboards. The auditor discovers that the BI module applies its own transformations to data from the ERP database, and the transformed data occasionally differs from the source ERP reports. What control concern exists?',
    options: [
      'Data transformations in BI tools are always accurate and do not require validation',
      'Data integrity risk — if the BI module transforms data differently than the ERP\'s standard reporting, executives may make decisions based on inaccurate information, and the transformed data may not reconcile to the audited financial statements',
      'BI modules are outside the scope of a financial audit',
      'Only the ERP\'s standard reports need to be tested',
    ],
    correctAnswer: 1,
    explanation: 'When BI tools transform source data, the reliability of the output depends on the accuracy of those transformations. Discrepancies between BI dashboards and ERP reports indicate potential issues with: (1) transformation logic (incorrect calculations, missing data), (2) refresh timing (stale data), (3) filter or aggregation differences, or (4) data quality issues. The auditor should evaluate whether executives rely on BI data for decisions that affect financial reporting and assess the reconciliation between BI output and ERP source data.',
    reference: 'API Security Best Practices',
  },
  {
    id: 'isc-mast-003',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Agile Scrum',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'In Scrum methodology, the Sprint Retrospective:',
    options: [
      'Demonstrates completed work',
      'Plans sprint backlog',
      'Reviews team processes to identify improvements for the next sprint',
      'Gathers requirements',
    ],
    correctAnswer: 2,
    explanation: 'Sprint Retrospective: team reflects on sprint - what went well, what to improve, action items. After Sprint Review. Sprint ceremonies: Planning, Daily Standup, Review (demo), Retrospective. Continuous improvement focus.',
    reference: 'Agile - Scrum Ceremonies',
  },
  {
    id: 'isc-mast-004',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Version Control',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Application',
    question: 'Version control systems provide:',
    options: [
      'Complete change history, branching, merging, collaboration, and ability to revert changes',
      'Encryption',
      'Backup only',
      'Testing automation',
    ],
    correctAnswer: 0,
    explanation: 'Version control (Git, etc.): track all changes, who/when/why, branching for parallel development, merging, revert to any point, collaboration, audit trail. Essential for SDLC. Supports DevOps practices.',
    reference: 'Software Development - Version Control',
  },
  {
    id: 'isc-mast-005',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Cybersecurity',
    subtopic: 'Endpoint Detection and Response',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Endpoint Detection and Response (EDR) solutions:',
    options: [
      'Only scan for viruses',
      'Manage patches',
      'Replace antivirus entirely',
      'Continuously monitor endpoints for threats, provide behavioral analysis, and enable rapid response',
    ],
    correctAnswer: 3,
    explanation: 'EDR: continuous endpoint monitoring, behavioral analysis (not just signatures), threat detection, investigation capabilities, response actions (isolate, remediate). Advanced from traditional AV. Part of defense in depth.',
    reference: 'Endpoint Security - EDR',
  },
  {
    id: 'isc-mast-006',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Cybersecurity',
    subtopic: 'Social Engineering',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Evaluation',
    question: 'Spear phishing differs from regular phishing by:',
    options: [
      'Using malware',
      'Avoiding email',
      'Being less effective',
      'Targeting specific individuals with personalized, researched content'
    ],
    correctAnswer: 3,
    explanation: 'Spear phishing: highly targeted, uses personal information (name, role, colleagues, interests) for credibility. More dangerous than mass phishing. Whaling targets executives specifically. Defense: training, email filtering, MFA.',
    reference: 'Social Engineering - Phishing Types',
  },
  {
    id: 'isc-mast-007',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Cryptography',
    subtopic: 'Key Management',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Effective cryptographic key management includes:',
    options: [
      'Using same key forever',
      'Storing keys with data',
      'Secure generation, storage, distribution, rotation, revocation, and destruction of keys',
      'Sharing keys openly',
    ],
    correctAnswer: 2,
    explanation: 'Key management lifecycle: generation (secure random), storage (HSM, vault), distribution (secure channel), usage (access control), rotation (periodic change), revocation (compromise), destruction (secure erase). Keys separate from data.',
    reference: 'Cryptography - Key Management',
  },
  {
    id: 'isc-mast-008',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Network Security',
    subtopic: 'DDoS Mitigation',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'DDoS attack mitigation strategies include:',
    options: [
      'Rate limiting, traffic filtering, CDN distribution, and scrubbing centers',
      'Ignoring the attack',
      'Increasing bandwidth only',
      'Reducing services',
    ],
    correctAnswer: 0,
    explanation: 'DDoS mitigation: rate limiting, IP blocking, traffic analysis/filtering, Anycast CDN distribution, cloud-based scrubbing centers, over-provisioning, WAF rules, BGP Flowspec. Layered defense necessary.',
    reference: 'Network Security - DDoS Protection',
  },
  {
    id: 'isc-mast-009',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-controls',
    topic: 'IT Controls',
    subtopic: 'Automated Controls',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Automated controls are generally more reliable because:',
    options: [
      'They cost less',
      'They never fail',
      'They operate consistently without human variability when properly programmed and tested',
      'They don\'t need testing',
    ],
    correctAnswer: 2,
    explanation: 'Automated controls: consistent execution, no fatigue/distraction, operate every transaction, efficient. BUT: depend on proper programming, need testing, depend on ITGCs. Still need periodic validation. One test may suffice if ITGCs strong.',
    reference: 'IT Controls - Automated vs Manual',
  },
  {
    id: 'isc-mast-010',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-controls',
    topic: 'IT General Controls',
    subtopic: 'Privileged Access',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Evaluation',
    question: 'Privileged access management (PAM) should include:',
    options: [
      'Shared admin accounts',
      'Permanent admin rights',
      'Self-service password reset only',
      'Just-in-time access, session recording, credential vaulting, and least privilege enforcement',
    ],
    correctAnswer: 3,
    explanation: 'PAM: credential vaulting (no standing passwords), just-in-time elevation, session recording, least privilege, approval workflows, automatic password rotation, separation of duties for admin functions. Critical for security.',
    reference: 'Access Control - Privileged Access',
  },
  {
    id: 'isc-mast-011',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'CCPA Rights',
    difficulty: 'hard',
    blueprintArea: 'ISC-IV',
    skillLevel: 'Application',
    question: 'Under the California Consumer Privacy Act (CCPA/CPRA), consumers have:',
    options: [
      'No privacy rights',
      'Limited rights',
      'Rights to know, delete, opt-out of sale, and non-discrimination for exercising rights',
      'Only deletion rights',
    ],
    correctAnswer: 2,
    explanation: 'CCPA/CPRA rights: know what personal info collected, delete personal info, opt-out of sale/sharing, non-discrimination, correct inaccurate info, limit use of sensitive info. Applies to businesses meeting thresholds.',
    reference: 'CCPA/CPRA Consumer Rights',
  },
  {
    {
      id: 'isc-mast-012',
      courseId: 'cpa',
      section: 'ISC',
      blueprintArea: 'ISC-IV',
      topic: 'Data Privacy',
      subtopic: 'Privacy Impact Assessment',
      difficulty: 'hard',
      skillLevel: 'Analysis',
      question: 'An organization\'s cloud security configuration includes storing API keys and database credentials in plaintext within application configuration files committed to the source code repository. The repository is accessible to all 200 developers. Several former employees who left the company still have access to the repository because deprovisioning was not performed. What vulnerability does this create?',
      options: [
        'Storing credentials in configuration files is standard practice',
        'Plaintext credentials in a widely-accessible code repository create a critical vulnerability — any current or former employee with repository access can extract database credentials and API keys, potentially accessing financial databases and external services without authorization',
        'Source code repositories are inherently secure environments for credential storage',
        'Credentials in configuration files are protected by the repository\'s access controls',
      ],
      correctAnswer: 1,
      explanation: 'Storing plaintext credentials in source code repositories is a critical vulnerability: (1) all 200 developers can see production credentials, (2) former employees with unrevoked access can extract credentials, (3) if the repository is compromised, all stored credentials are exposed, (4) credential rotation requires code changes and redeployment. Best practice: use secrets management solutions (HashiCorp Vault, AWS Secrets Manager), environment variables, or CI/CD secret injection.',
      reference: 'Privacy - Impact Assessments',
    },
    id: 'isc-mast-013',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'Complementary User Entity Controls',
    difficulty: 'hard',
    blueprintArea: 'ISC-V',
    skillLevel: 'Evaluation',
    question: 'Complementary User Entity Controls (CUECs) in SOC reports:',
    options: [
      'Replace service organization controls',
      'Are controls the user organization must implement for service organization controls to be effective',
      'Are tested by service auditor',
      'Are optional',
    ],
    correctAnswer: 1,
    explanation: 'CUECs: controls service organization assumes user implements. Listed in SOC report. User auditor must evaluate if user implemented CUECs. Examples: user access reviews, input validation, output reconciliation. Critical for reliance.',
    reference: 'SOC Reports - CUECs',
  },
  {
    id: 'isc-mast-014',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'SOC for Cybersecurity',
    difficulty: 'hard',
    blueprintArea: 'ISC-V',
    skillLevel: 'Analysis',
    question: 'SOC for Cybersecurity reports focus on:',
    options: [
      'Individual transactions',
      'Financial controls only',
      'Organization-wide cybersecurity risk management program effectiveness',
      'Compliance with tax laws',
    ],
    correctAnswer: 2,
    explanation: 'SOC for Cybersecurity: organization-wide exam of cybersecurity risk management program. Uses AICPA description criteria. Evaluates design and effectiveness. Voluntary. Broader than SOC 2. Useful for board, management, stakeholders.',
    reference: 'AICPA SOC for Cybersecurity',
  },
  {
    id: 'isc-mast-015',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-VI',
    topic: 'Emerging Technologies',
    subtopic: 'Quantum Computing Impact',
    difficulty: 'hard',
    skillLevel: 'Evaluation',
    question: 'An organization deploys blockchain technology to create an immutable audit trail for high-value financial transactions. The auditor discovers that while the blockchain records are immutable, the input data comes from a traditional database that lacks adequate input validation controls. What should the auditor conclude?',
    options: [
      'The blockchain ensures data integrity regardless of input quality',
      'Blockchain immutability only preserves data as entered — if input data is inaccurate or fraudulent due to weak controls at the source, the blockchain permanently records incorrect information (\'garbage in, garbage out\')',
      'Blockchain technology eliminates the need for traditional controls',
      'The auditor cannot evaluate blockchain-based systems',
    ],
    correctAnswer: 1,
    explanation: 'Blockchain immutability is a strength only when combined with strong input controls. If source data is incorrect (due to weak validation, unauthorized changes, or fraud), the blockchain permanently and immutably records those errors. The auditor must evaluate the entire data chain — from input through processing to the blockchain record — not just the blockchain layer. Input validation, authorization controls, and data quality at the source remain essential.',
    reference: 'Quantum Computing - Cryptography Impact',
  },
  {
    id: 'isc-mast-016',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-VI',
    topic: 'Emerging Technologies',
    subtopic: 'IoT Security',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A financial institution implements an AI-based fraud detection system that analyzes transaction patterns to flag suspicious activity. The auditor discovers that the model was trained on data from 3 years ago and has not been retrained since deployment. The false positive rate has increased from 5% to 45%. What is the audit implication?',
    options: [
      'AI models do not degrade over time and retraining is unnecessary',
      'Model drift has significantly reduced the control\'s effectiveness — a 45% false positive rate means the security team is overwhelmed with false alerts, increasing the risk that actual fraud goes undetected amid the noise',
      'The high false positive rate means the system is more conservative and therefore better at catching fraud',
      'The auditor should not evaluate AI systems because they are too complex',
    ],
    correctAnswer: 1,
    explanation: 'AI model drift occurs when the patterns in current data diverge from training data. A 45% false positive rate (up from 5%) indicates severe degradation: (1) analyst fatigue from investigating false alerts reduces attention to genuine fraud, (2) real fraud patterns may have evolved beyond the model\'s detection capability, (3) the control is no longer operating as designed. The auditor should treat this as a control deficiency and evaluate compensating controls.',
    reference: 'IoT Security Challenges',
  },
  {
    id: 'isc-mast-017',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-emerging',
    topic: 'Cloud Computing',
    subtopic: 'Multi-Cloud Strategy',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Evaluation',
    question: 'Benefits of multi-cloud strategy include:',
    options: [
      'Simplified management',
      'Avoiding vendor lock-in, leveraging best-of-breed services, and improving resilience',
      'Lower costs always',
      'Less complexity',
    ],
    correctAnswer: 1,
    explanation: 'Multi-cloud benefits: avoid lock-in, use best services from each provider, regulatory compliance (data residency), disaster recovery, negotiating leverage. Challenges: complexity, skill requirements, data integration, security consistency.',
    reference: 'Cloud Strategy - Multi-Cloud',
  },
  {
    id: 'isc-mast-018',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-III',
    topic: 'Business Continuity',
    subtopic: 'BIA Components',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An organization\'s disaster recovery plan relies on a third-party data center for its recovery site. The auditor discovers that the contract does not include guaranteed resource allocation during a regional disaster — the recovery site operates on a \'first-come, first-served\' basis and may not have capacity if multiple clients invoke their DR plans simultaneously. What is the primary risk?',
    options: [
      'Third-party data centers always have sufficient capacity',
      'In a regional disaster affecting multiple clients, the recovery site may lack capacity to support the entity\'s recovery, rendering the DR plan ineffective precisely when it is needed most',
      'Contract terms do not affect DR plan effectiveness',
      'The entity should not test its DR plan to avoid revealing capacity issues',
    ],
    correctAnswer: 1,
    explanation: 'Non-dedicated recovery sites (\'shared\' or \'first-come, first-served\') create capacity contention risk during widespread disasters — the exact scenario when DR plans are most needed. If multiple clients invoke simultaneously, some will not get resources. The auditor should: (1) evaluate the contract\'s capacity guarantees, (2) assess the likelihood of concurrent invocations, (3) consider the financial reporting impact of extended downtime, and (4) recommend dedicated or guaranteed-capacity arrangements.',
    reference: 'Business Continuity - BIA',
  },
  {
    id: 'isc-mast-019',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-bcp',
    topic: 'Disaster Recovery',
    subtopic: 'DR Testing',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'DR plan testing methods include:',
    options: [
      'Tabletop exercises, walkthrough tests, simulation tests, parallel tests, and full interruption tests',
      'Only documentation review',
      'Production testing only',
      'No testing needed',
    ],
    correctAnswer: 0,
    explanation: 'DR testing progression: checklist/documentation review, tabletop exercise (discussion), walkthrough (step-by-step), simulation (mock disaster), parallel (recover to DR site while production runs), full interruption (actual switchover). Regular testing essential.',
    reference: 'Disaster Recovery Testing',
  },
  {
    id: 'isc-mast-020',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-frameworks',
    topic: 'Control Frameworks',
    subtopic: 'ISO 27001',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'ISO 27001 certification requires:',
    options: [
      'Self-assessment only',
      'Implementing an Information Security Management System with risk assessment and controls, verified by external audit',
      'Buying software',
      'Training only',
    ],
    correctAnswer: 1,
    explanation: 'ISO 27001: ISMS framework. Requires: risk assessment, risk treatment, statement of applicability (Annex A controls), documentation, management review, internal audit, external certification audit. 3-year certification cycle.',
    reference: 'ISO/IEC 27001',
  },
  {
    id: 'isc-mast-021',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-audit',
    topic: 'IT Audit',
    subtopic: 'Data Analytics in Audit',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Using data analytics in IT audit enables:',
    options: [
      'Smaller sample sizes only',
      'Eliminating all manual work',
      'Reducing documentation',
      'Full population testing, anomaly detection, pattern recognition, and continuous monitoring',
    ],
    correctAnswer: 3,
    explanation: 'Audit analytics: 100% population testing, identify anomalies/outliers, pattern/trend analysis, continuous auditing/monitoring, risk assessment enhancement, fraud detection. Tools: ACL, IDEA, SQL, Python. Requires data quality.',
    reference: 'IT Audit - Data Analytics',
  },
  {
    id: 'isc-mast-022',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Security Metrics',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Evaluation',
    question: 'Effective security metrics should measure:',
    options: [
      'Number of employees',
      'IT budget only',
      'Number of firewalls',
      'Mean time to detect/respond, patch compliance, incident trends, vulnerability remediation time, and risk reduction',
    ],
    correctAnswer: 3,
    explanation: 'Security metrics: MTTD (mean time to detect), MTTR (mean time to respond/remediate), patch compliance %, vulnerability aging, phishing click rates, incident volume/severity trends, control effectiveness. Align with business risk.',
    reference: 'Security Metrics and KPIs',
  },
  {
    id: 'isc-mast-023',
    courseId: 'cpa',
    section: 'ISC',
    blueprintArea: 'ISC-II',
    topic: 'Incident Response',
    subtopic: 'Evidence Preservation',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'An organization\'s incident response plan delegates authority to the CISO to make breach notification decisions. During a breach affecting customer financial data, the CISO decides not to notify affected individuals or regulators because the CISO believes the risk of harm is low. The legal team and board were not consulted. What governance failure occurred?',
    options: [
      'The CISO has appropriate authority to make all breach notification decisions independently',
      'Breach notification decisions have legal, regulatory, and reputational implications that extend beyond the CISO\'s technical authority — the decision should involve legal counsel, senior management, and the board, and regulatory notification requirements may be mandatory regardless of the CISO\'s risk assessment',
      'Breach notification is optional in all jurisdictions',
      'The CISO\'s risk assessment is the only relevant factor in notification decisions',
    ],
    correctAnswer: 1,
    explanation: 'Breach notification is a legal obligation in many jurisdictions (state breach notification laws, GDPR Article 33/34, GLBA), not a discretionary decision. A CISO making this decision unilaterally: (1) may violate mandatory notification timelines (72 hours under GDPR), (2) exposes the organization to regulatory penalties, (3) creates personal liability for the CISO and executives, and (4) demonstrates a governance failure in the incident response process. Cross-functional decision-making is essential.',
    reference: 'Digital Forensics - Evidence Handling',
  },
  {
    id: 'isc-mast-024',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-data',
    topic: 'Data Governance',
    subtopic: 'Data Classification',
    difficulty: 'hard',
    blueprintArea: 'ISC-IV',
    skillLevel: 'Analysis',
    question: 'Data classification schemes typically include:',
    options: [
      'Public, internal, confidential, and restricted/highly confidential levels based on sensitivity and impact',
      'Random categories',
      'Only two levels',
      'Technical specifications',
    ],
    correctAnswer: 0,
    explanation: 'Classification levels: Public (no restriction), Internal (business use), Confidential (sensitive, limited access), Restricted/Top Secret (highest sensitivity). Drives: access controls, encryption requirements, handling procedures, retention.',
    reference: 'Data Governance - Classification',
  },
  {
    id: 'isc-mast-025',
    section: 'ISC',
    courseId: 'cpa',
    topicId: 'isc-automation',
    topic: 'Process Automation',
    subtopic: 'Intelligent Automation',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Evaluation',
    question: 'Intelligent automation combines RPA with:',
    options: [
      'AI/ML capabilities for handling unstructured data and decision-making',
      'More manual processes',
      'Legacy systems only',
      'Reduced functionality'
    ],
    correctAnswer: 0,
    explanation: 'Intelligent automation: RPA + AI/ML. RPA handles structured, rule-based tasks. AI adds: document understanding (OCR, NLP), decision-making, learning from data, handling exceptions. Also called: cognitive automation, hyperautomation.',
    reference: 'Intelligent Automation',
  },
];
