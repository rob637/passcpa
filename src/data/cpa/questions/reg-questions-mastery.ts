// REG - Regulation Mastery Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Mastery batch

import { Question } from '../../../types';

export const REG_QUESTIONS_MASTERY: Question[] = [
  {
    id: 'reg-mast-001',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-ethics',
    topic: 'Professional Ethics',
    subtopic: 'Circular 230 Due Diligence',
    difficulty: 'hard',
    blueprintArea: 'REG-I',
    skillLevel: 'Evaluation',
    question: 'Under Circular 230 due diligence requirements, a practitioner must:',
    options: [
      'Make reasonable inquiries if information appears incorrect, inconsistent, or incomplete',
      'Obtain independent appraisals',
      'Verify all third-party data',
      'Accept all client representations',
    ],
    correctAnswer: 0,
    explanation: 'Due diligence: rely on client info unless appears incorrect, incomplete, inconsistent. Then must make reasonable inquiries. Not required to independently verify good faith client representations unless red flags exist.',
    reference: 'Circular 230 §10.22',
  },
  {
    id: 'reg-mast-002',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-contracts',
    topic: 'Contract Law',
    subtopic: 'Parol Evidence Rule',
    difficulty: 'hard',
    blueprintArea: 'REG-II',
    skillLevel: 'Analysis',
    question: 'The parol evidence rule prohibits:',
    options: [
      'Subsequent modifications',
      'Interpretation evidence',
      'Prior or contemporaneous agreements that contradict a fully integrated written contract',
      'All oral evidence',
    ],
    correctAnswer: 2,
    explanation: 'Parol evidence: prior/contemporaneous oral or written agreements excluded if they contradict fully integrated contract. Exceptions: fraud, duress, mistake, condition precedent, ambiguity interpretation, subsequent modifications.',
    reference: 'Contract Law - Parol Evidence',
  },
  {
    id: 'reg-mast-003',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-ucc',
    topic: 'UCC Article 2',
    subtopic: 'Battle of the Forms',
    difficulty: 'hard',
    blueprintArea: 'REG-II',
    skillLevel: 'Evaluation',
    question: 'Under UCC §2-207, additional terms in an acceptance between merchants:',
    options: [
      'Create a counteroffer',
      'Require explicit acceptance',
      'Void the acceptance',
      'Become part of the contract unless they materially alter it, are objected to, or offer limits acceptance',
    ],
    correctAnswer: 3,
    explanation: 'UCC 2-207: acceptance valid despite different terms. Between merchants, additional terms become part unless: (1) offer limits, (2) material alteration, (3) seasonable objection. Material = surprise or hardship. Conflicting terms may "knock out."',
    reference: 'UCC §2-207',
  },
  {
    id: 'reg-mast-004',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-individual',
    topic: 'Individual Taxation',
    subtopic: 'Section 121 Exclusion',
    difficulty: 'hard',
    blueprintArea: 'REG-III',
    skillLevel: 'Analysis',
    question: 'The Section 121 principal residence exclusion of $250,000/$500,000 requires:',
    options: [
      'First-time seller status',
      'Continuous residence',
      'Ownership and use as principal residence for 2 of the 5 years before sale',
      'Any ownership',
    ],
    correctAnswer: 2,
    explanation: '§121: exclude up to $250K ($500K MFJ) if owned AND used as principal residence 2 of 5 years before sale. Doesn\'t need to be continuous. Partial exclusion for health, employment change, unforeseen circumstances.',
    reference: 'IRC §121',
  },
  {
    id: 'reg-mast-005',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-individual',
    topic: 'Individual Taxation',
    subtopic: 'Wash Sale Rule',
    difficulty: 'hard',
    blueprintArea: 'REG-III',
    skillLevel: 'Analysis',
    question: 'The wash sale rule disallows loss deduction when:',
    options: [
      'Only corporate stock is sold',
      'Gain results from sale',
      'Any securities are sold',
      'Substantially identical securities are acquired within 30 days before or after the sale',
    ],
    correctAnswer: 3,
    explanation: 'Wash sale: loss disallowed if acquire substantially identical stock/securities 30 days before OR after sale. Disallowed loss added to replacement security basis. Applies to stock, options on same stock. Not for gains.',
    reference: 'IRC §1091',
  },
  {
    id: 'reg-mast-006',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-basis',
    topic: 'Property Basis',
    subtopic: 'Related Party Basis',
    difficulty: 'hard',
    blueprintArea: 'REG-IV',
    skillLevel: 'Analysis',
    question: 'When property acquired by gift is sold at a loss, and FMV was below donor\'s basis at gift:',
    options: [
      'Use selling price',
      'Use zero basis',
      'Use FMV at date of gift (dual basis rule)',
      'Use donor\'s basis',
    ],
    correctAnswer: 2,
    explanation: 'Gift dual basis: For gain, use donor\'s basis (carryover). For loss, use lower of donor\'s basis or FMV at gift. If sold between the two, no gain or loss. Prevents transferring built-in losses via gifts.',
    reference: 'IRC §1015(a)',
  },
  {
    id: 'reg-mast-007',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-corporate',
    topic: 'Corporate Taxation',
    subtopic: 'Accumulated Earnings Tax',
    difficulty: 'hard',
    blueprintArea: 'REG-V',
    skillLevel: 'Evaluation',
    question: 'The accumulated earnings tax applies when:',
    options: [
      'A loss occurs',
      'A corporation accumulates earnings beyond reasonable business needs to avoid shareholder dividend tax',
      'S election is made',
      'Any earnings are retained',
    ],
    correctAnswer: 1,
    explanation: 'AET: 20% penalty tax on accumulated taxable income if accumulation to avoid shareholder tax. Reasonable needs: expansion, debt retirement, working capital. $250K minimum credit ($150K PSC). Burden on IRS, then shifts.',
    reference: 'IRC §531-537',
  },
  {
    id: 'reg-mast-008',
    courseId: 'cpa',
    section: 'REG',
    blueprintArea: 'REG-V',
    topic: 'Corporate Taxation',
    subtopic: 'Personal Holding Company',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A C corporation owned by 3 shareholders (each 33%) had adjusted ordinary gross income of $500,000, of which $400,000 was from dividends, interest, and royalties. The corporation distributed no dividends. Under IRC §542, is this a personal holding company (PHC)?',
    options: [
      'Yes, because more than 60% of AOGI is PHCI and 5 or fewer individuals own more than 50% of the stock',
      'No, because the stock ownership test requires more than 5 shareholders',
      'No, because the income threshold is 80%, not 60%',
      'Yes, but only if the corporation is publicly traded',
    ],
    correctAnswer: 0,
    explanation: 'A corporation is a PHC under IRC §542 if: (1) the income test is met — 60% or more of adjusted ordinary gross income is PHCI, and (2) the ownership test is met — more than 50% of the stock is owned by 5 or fewer individuals. Here, PHCI = $400,000/$500,000 = 80% (exceeds 60%), and 3 shareholders own 100% (exceeds the 50% threshold with 5 or fewer individuals). The PHC tax is 20% on undistributed personal holding company income.',
    reference: 'IRC §541-547',
  },
  {
    id: 'reg-mast-009',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-scorp',
    topic: 'S Corporation',
    subtopic: 'Post-Termination Period',
    difficulty: 'hard',
    blueprintArea: 'REG-V',
    skillLevel: 'Analysis',
    question: 'After S election termination, the post-termination transition period allows:',
    options: [
      'NOL carryback',
      'Loss carryover utilization and tax-free AAA distributions',
      'New S election immediately',
      'Continued S treatment',
    ],
    correctAnswer: 1,
    explanation: 'PTTP: period after S termination (generally 1 year). Allows: (1) shareholders to use suspended losses against stock basis, (2) distributions from AAA treated as tax-free return of capital. Facilitates transition.',
    reference: 'IRC §1377(b)',
  },
  {
    id: 'reg-mast-010',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-partnership',
    topic: 'Partnership Taxation',
    subtopic: 'Inside vs Outside Basis',
    difficulty: 'hard',
    blueprintArea: 'REG-V',
    skillLevel: 'Analysis',
    question: 'The difference between inside and outside basis matters for:',
    options: [
      'Self-employment tax',
      'Distributions causing gain, sales of partnership interests, and §743(b) adjustments',
      'Operating income',
      'Depreciation only',
    ],
    correctAnswer: 1,
    explanation: 'Inside = partnership\'s basis in assets. Outside = partner\'s basis in partnership interest. Differences arise from: asset appreciation, §754 elections, contributed property. Affects: distribution gain, interest sale, optional basis adjustments.',
    reference: 'IRC §743, §751, §752',
  },
  {
    id: 'reg-mast-011',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-procedures',
    topic: 'Tax Procedures',
    subtopic: 'Penalty Abatement',
    difficulty: 'hard',
    blueprintArea: 'REG-I',
    skillLevel: 'Application',
    question: 'First-time penalty abatement applies when:',
    options: [
      'Amount is under $1,000',
      'Taxpayer has clean 3-year compliance history and meets other criteria',
      'Taxpayer requests it',
      'Any penalty is assessed',
    ],
    correctAnswer: 1,
    explanation: 'FTA: administrative waiver for failure to file, failure to pay, failure to deposit. Requirements: (1) no penalties in prior 3 years, (2) all required returns filed or on extension, (3) any tax due paid or in payment plan.',
    reference: 'IRM 20.1.1.3.6.1',
  },
  {
    id: 'reg-mast-012',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-employment',
    topic: 'Employment Tax',
    subtopic: 'Worker Classification Tests',
    difficulty: 'hard',
    blueprintArea: 'REG-III',
    skillLevel: 'Analysis',
    question: 'The ABC test for worker classification presumes employee status unless:',
    options: [
      'Worker has multiple clients',
      'Worker is free from control, performs work outside usual business, and is independently established',
      'Payment is by project',
      'Worker signs contractor agreement',
    ],
    correctAnswer: 1,
    explanation: 'ABC test (many states): presume employee unless ALL met: (A) free from control/direction, (B) work outside usual course of hiring entity\'s business, (C) customarily engaged in independent trade/occupation. Stricter than IRS common law.',
    reference: 'Worker Classification - ABC Test',
  },
  {
    id: 'reg-mast-013',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-property',
    topic: 'Property Transactions',
    subtopic: 'Net Section 1231 Gain',
    difficulty: 'hard',
    blueprintArea: 'REG-IV',
    skillLevel: 'Analysis',
    question: 'Net Section 1231 gain is recharacterized as ordinary income to the extent of:',
    options: [
      '§1245 recapture only',
      'Depreciation taken',
      'Unrecaptured net §1231 losses from the prior 5 years',
      'All §1231 gains',
    ],
    correctAnswer: 2,
    explanation: '§1231 lookback rule: net §1231 gain treated as ordinary income to extent of non-recaptured net §1231 losses from 5 preceding years. Prevents converting ordinary losses to capital losses and vice versa for gains.',
    reference: 'IRC §1231(c)',
  },
  {
    id: 'reg-mast-014',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-secured',
    topic: 'Secured Transactions',
    subtopic: 'Attachment',
    difficulty: 'hard',
    blueprintArea: 'REG-II',
    skillLevel: 'Analysis',
    question: 'A security interest attaches when:',
    options: [
      'Value is given, debtor has rights in collateral, and authenticated security agreement (or possession)',
      'Creditor takes possession',
      'Default occurs',
      'Filing occurs',
    ],
    correctAnswer: 0,
    explanation: 'Attachment (enforceable against debtor): (1) value given by secured party, (2) debtor has rights in collateral, (3) security agreement authenticated (or possession/control). All three required. After-acquired property clause extends.',
    reference: 'UCC §9-203',
  },
  {
    id: 'reg-mast-015',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-bankruptcy',
    topic: 'Bankruptcy',
    subtopic: 'Chapter 11 Reorganization',
    difficulty: 'hard',
    blueprintArea: 'REG-II',
    skillLevel: 'Analysis',
    question: 'In Chapter 11 bankruptcy, the debtor in possession:',
    options: [
      'Must liquidate',
      'Loses all control',
      'Cannot reject contracts',
      'Continues to operate the business with powers of a trustee',
    ],
    correctAnswer: 3,
    explanation: 'Chapter 11 DIP: debtor retains possession, operates business, has trustee powers (avoid preferences, reject executory contracts, use/sell property). Trustee appointed only for cause (fraud, mismanagement). Creditors\' committee appointed.',
    reference: 'Bankruptcy Code §1101-1129',
  },
  {
    id: 'reg-mast-016',
    courseId: 'cpa',
    section: 'REG',
    blueprintArea: 'REG-II',
    topic: 'Agency Law',
    subtopic: 'Apparent Authority',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A company\'s receptionist, who has no purchasing authority, orders $5,000 worth of office supplies from a vendor the company regularly uses. The vendor has dealt with the receptionist on similar purchases in the past with the company\'s knowledge. Is the company bound by the purchase order?',
    options: [
      'Yes, because the receptionist has apparent authority based on the company\'s prior conduct allowing similar transactions',
      'No, because the receptionist has no actual authority to purchase supplies',
      'Yes, but only if the supplies cost less than $500',
      'No, because receptionists can never have purchasing authority',
    ],
    correctAnswer: 0,
    explanation: 'Apparent authority arises when the principal\'s conduct leads a third party to reasonably believe the agent has authority. The company\'s pattern of allowing the receptionist to place orders — combined with the vendor\'s prior dealings based on this pattern — creates apparent authority under agency law. Even though the receptionist lacks actual authority, the principal\'s manifestations to the third party (accepting prior orders) bind the company.',
    reference: 'Agency Law - Apparent Authority',
  },
  {
    id: 'reg-mast-017',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-individual',
    topic: 'Individual Taxation',
    subtopic: 'Estimated Tax Penalties',
    difficulty: 'medium',
    blueprintArea: 'REG-III',
    skillLevel: 'Application',
    question: 'No estimated tax penalty applies if:',
    options: [
      'First year of filing',
      'Tax owed is less than $1,000 or payments equal 90% of current or 100%/110% of prior year tax',
      'Extensions filed',
      'Any payment is made',
    ],
    correctAnswer: 1,
    explanation: 'Safe harbors: (1) tax owed <$1,000 after withholding/credits, (2) pay 100% prior year (110% if AGI >$150K), (3) pay 90% current year. Calculate quarterly, annualized income method available.',
    reference: 'IRC §6654',
  },
  {
    id: 'reg-mast-018',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-individual',
    topic: 'Individual Taxation',
    subtopic: 'Alimony Pre-2019',
    difficulty: 'medium',
    blueprintArea: 'REG-III',
    skillLevel: 'Application',
    question: 'For divorce agreements executed before 2019, alimony payments:',
    options: [
      'Follow post-2018 rules',
      'Are deductible by payer and includible by recipient',
      'Are partially taxable',
      'Are not deductible',
    ],
    correctAnswer: 1,
    explanation: 'Pre-TCJA divorces (before 2019): alimony deductible above-the-line by payer, ordinary income to recipient. Requirements: written agreement, cash, not child support, not living together, no liability after death. Post-2018: no deduction/inclusion.',
    reference: 'IRC §71, §215 (pre-TCJA)',
  },
  {
    id: 'reg-mast-019',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-ethics',
    topic: 'Professional Ethics',
    subtopic: 'Contingent Fees',
    difficulty: 'hard',
    blueprintArea: 'REG-I',
    skillLevel: 'Analysis',
    question: 'Under Circular 230, contingent fees are prohibited for:',
    options: [
      'Tax planning only',
      'Audit representation',
      'Original tax returns and amended returns claiming refunds unless reasonable belief claim will be sustained',
      'All tax services',
    ],
    correctAnswer: 2,
    explanation: 'Circular 230 §10.27: contingent fees prohibited for: (1) original returns, (2) amended returns/refund claims unless based on reasonable belief and properly disclosed. Allowed for: IRS exam, collections, judicial proceedings, credits.',
    reference: 'Circular 230 §10.27',
  },
  {
    id: 'reg-mast-020',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-procedures',
    topic: 'Tax Procedures',
    subtopic: 'Appeals Process',
    difficulty: 'hard',
    blueprintArea: 'REG-I',
    skillLevel: 'Analysis',
    question: 'The IRS Appeals function:',
    options: [
      'Only handles large cases',
      'Requires Tax Court petition',
      'Provides independent review considering hazards of litigation before trial',
      'Is part of audit',
    ],
    correctAnswer: 2,
    explanation: 'IRS Appeals: independent review, considers hazards of litigation (probability of IRS prevailing). Settlement authority. Taxpayer request after audit via protest. Alternative: Tax Court, District Court, Claims Court.',
    reference: 'IRM 8 - Appeals',
  },
  {
    id: 'reg-mast-021',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-corporate',
    topic: 'Corporate Taxation',
    subtopic: 'Section 336(e)',
    difficulty: 'hard',
    blueprintArea: 'REG-V',
    skillLevel: 'Analysis',
    question: 'A Section 336(e) election allows:',
    options: [
      'Dividend treatment',
      'Treatment of a qualified stock disposition as an asset sale for tax purposes',
      'NOL carryforward',
      'Tax-free stock sale',
    ],
    correctAnswer: 1,
    explanation: '§336(e): if ≥80% stock sold in 12-month period, can elect to treat as asset sale. Target recognizes gain/loss on deemed asset sale. Buyers get stepped-up basis. Alternative to §338(h)(10) for non-purchasing corporation buyers.',
    reference: 'IRC §336(e)',
  },
  {
    id: 'reg-mast-022',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-international',
    topic: 'International Taxation',
    subtopic: 'Form 5471',
    difficulty: 'hard',
    blueprintArea: 'REG-V',
    skillLevel: 'Application',
    question: 'Form 5471 is required when a US person:',
    options: [
      'Travels internationally',
      'Receives foreign dividends only',
      'Has any foreign investment',
      'Is a shareholder, officer, or director of certain foreign corporations meeting filing categories',
    ],
    correctAnswer: 3,
    explanation: 'Form 5471: information return for US persons with interests in CFCs. Categories: 10%+ shareholder of CFC, US persons who acquire/dispose of stock, US persons controlling foreign corp. Substantial penalties for non-filing.',
    reference: 'IRC §6038, §6046',
  },
  {
    id: 'reg-mast-023',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-property',
    topic: 'Property Transactions',
    subtopic: 'QSBS Exclusion',
    difficulty: 'hard',
    blueprintArea: 'REG-IV',
    skillLevel: 'Analysis',
    question: 'The Section 1202 qualified small business stock exclusion allows:',
    options: [
      'Capital gains treatment only',
      '50% exclusion',
      '100% exclusion of gain (for stock acquired after 9/27/2010) up to greater of $10M or 10× basis',
      'Deferral only',
    ],
    correctAnswer: 2,
    explanation: '§1202 QSBS: exclude 100% of gain (post-9/27/2010 acquisitions). Requirements: C corp, ≤$50M assets at issue, active business (not services/finance), hold >5 years, original issuance. Limit: greater of $10M or 10× stock basis.',
    reference: 'IRC §1202',
  },
  {
    id: 'reg-mast-024',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-partnership',
    topic: 'Partnership Taxation',
    subtopic: 'Self-Employment Tax',
    difficulty: 'hard',
    blueprintArea: 'REG-V',
    skillLevel: 'Analysis',
    question: 'Limited partners are generally exempt from self-employment tax except for:',
    options: [
      'All partnership income',
      'Distributed cash',
      'Passive income',
      'Guaranteed payments for services',
    ],
    correctAnswer: 3,
    explanation: 'LP SE tax: limited partner\'s share of partnership ordinary income generally excluded. Exception: guaranteed payments for services subject to SE tax. General partners: all ordinary income subject to SE tax. LLC members: complex rules.',
    reference: 'IRC §1402(a)(13)',
  },
  {
    id: 'reg-mast-025',
    section: 'REG',
    courseId: 'cpa',
    topicId: 'reg-individual',
    topic: 'Individual Taxation',
    subtopic: 'HSA Contributions',
    difficulty: 'medium',
    blueprintArea: 'REG-III',
    skillLevel: 'Application',
    question: 'Health Savings Account (HSA) contributions require:',
    options: [
      'Employer sponsorship',
      'Coverage under a high-deductible health plan and no other disqualifying coverage',
      'Itemizing deductions',
      'Any health insurance',
    ],
    correctAnswer: 1,
    explanation: 'HSA eligibility: (1) HDHP coverage, (2) no other health coverage (except permitted insurance), (3) not enrolled in Medicare, (4) not claimed as dependent. Contributions above-the-line deduction. Triple tax benefit.',
    reference: 'IRC §223',
  },
];
