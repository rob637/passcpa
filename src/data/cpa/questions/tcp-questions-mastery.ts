// TCP - Tax Compliance & Planning Mastery Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Mastery batch

import { Question } from '../../../types';

export const TCP_QUESTIONS_MASTERY: Question[] = [
  {
    id: 'tcp-mast-001',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'Home Office Deduction',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'The home office deduction requires:',
    options: [
      'Rental income',
      'Regular and exclusive use for business as principal place of business or meeting place',
      'Any work from home',
      'Employee status',
    ],
    correctAnswer: 1,
    explanation: 'Home office: (1) regular and exclusive use, (2) principal place of business (admin functions count) OR place to meet clients OR separate structure. Employees can\'t deduct post-TCJA. Self-employed: actual or simplified method ($5/sq ft up to 300).',
    reference: 'IRC §280A',
  },
  {
    id: 'tcp-mast-002',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'Rental Real Estate',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'A real estate professional avoids passive activity loss limitations by:',
    options: [
      'Living in the property',
      'Using a property manager',
      'Owning rental property',
      'Materially participating in real estate activity AND spending >750 hours/50% of time in real property trades',
    ],
    correctAnswer: 3,
    explanation: 'Real estate professional: (1) >50% of personal services in real property trades, (2) >750 hours in real property trades. Must also materially participate in each rental activity (or elect to aggregate). Converts passive to non-passive.',
    reference: 'IRC §469(c)(7)',
  },
  {
    id: 'tcp-mast-003',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'Cryptocurrency Taxation',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'Cryptocurrency is taxed as:',
    options: [
      'Non-taxable',
      'Property, with gain/loss recognized on each disposition including trades and purchases',
      'Currency',
      'Securities only',
    ],
    correctAnswer: 1,
    explanation: 'IRS Notice 2014-21: crypto is property. Each sale, trade (including crypto-to-crypto), or purchase triggers recognition. Basis tracking required (FIFO, specific ID). Mining: ordinary income at FMV when received. Staking: possibly ordinary income.',
    reference: 'IRS Notice 2014-21',
  },
  {
    id: 'tcp-mast-004',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-corporate',
    topic: 'Corporate Taxation',
    subtopic: 'Dividends Received Deduction',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Analysis',
    question: 'The dividends received deduction for corporations is:',
    options: [
      'Always 100%',
      'Not available',
      '50% always',
      '50% for <20% ownership, 65% for 20-80%, 100% for 80%+ (affiliated group members)',
    ],
    correctAnswer: 3,
    explanation: 'DRD: <20% ownership = 50%, 20-80% = 65%, ≥80% affiliated member = 100%. Limitations: taxable income limit (except if creates NOL), debt-financed stock reduction, holding period requirement (46+ days in 91-day window).',
    reference: 'IRC §243',
  },
  {
    id: 'tcp-mast-005',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-corporate',
    topic: 'Corporate Taxation',
    subtopic: 'Stock Redemptions',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Evaluation',
    question: 'A stock redemption qualifies for sale treatment (not dividend) if:',
    options: [
      'Any redemption',
      'It uses cash',
      'It is substantially disproportionate, a complete termination, or not essentially equivalent to a dividend',
      'Shareholder requests',
    ],
    correctAnswer: 2,
    explanation: 'Sale treatment tests: (1) substantially disproportionate (<50% vote, <80% prior vote and value), (2) complete termination (waive family attribution), (3) not essentially equivalent to dividend (meaningful reduction), (4) partial liquidation to non-corporate. Attribution rules apply.',
    reference: 'IRC §302',
  },
  {
    id: 'tcp-mast-006',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-scorp',
    topic: 'S Corporation',
    subtopic: 'Reasonable Compensation',
    difficulty: 'hard',
    blueprintArea: 'TCP-III',
    skillLevel: 'Evaluation',
    question: 'S corporation shareholder-employees must receive reasonable compensation because:',
    options: [
      'It affects stock basis',
      'IRS requires minimum wage',
      'Avoiding employment taxes by characterizing compensation as distributions is abusive',
      'State law requires it',
    ],
    correctAnswer: 2,
    explanation: 'Reasonable comp: IRS scrutinizes S corps paying low salaries + high distributions (avoid employment tax). Factors: training, experience, duties, time, comparable wages, profit history. IRS can recharacterize distributions as wages.',
    reference: 'S Corp Reasonable Compensation',
  },
  {
    id: 'tcp-mast-007',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-scorp',
    topic: 'S Corporation',
    subtopic: 'Loss Limitations Ordering',
    difficulty: 'hard',
    blueprintArea: 'TCP-III',
    skillLevel: 'Analysis',
    question: 'S corporation losses are limited by (in order):',
    options: [
      'Stock and debt basis, then at-risk, then passive activity limitations',
      'Only basis',
      'Passive first',
      'At-risk first',
    ],
    correctAnswer: 0,
    explanation: 'Loss limitation hierarchy: (1) basis limitation (stock then debt), (2) at-risk limitation, (3) passive activity limitation, (4) excess business loss limitation. Each level may suspend losses. Must have basis to deduct.',
    reference: 'IRC §1366, §465, §469, §461(l)',
  },
  {
    id: 'tcp-mast-008',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-partnership',
    topic: 'Partnership Taxation',
    subtopic: 'Hot Assets',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Analysis',
    question: 'Hot assets (§751 property) include:',
    options: [
      'Unrealized receivables (including §1245/1250 recapture) and inventory items',
      'All partnership assets',
      'Capital assets',
      'Cash only',
    ],
    correctAnswer: 0,
    explanation: '§751 hot assets: (1) unrealized receivables (includes depreciation recapture potential), (2) inventory items (including substantially appreciated inventory). Cause ordinary income on sale/exchange of partnership interest or disproportionate distributions.',
    reference: 'IRC §751',
  },
  {
    id: 'tcp-mast-009',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-partnership',
    topic: 'Partnership Taxation',
    subtopic: 'Nonrecourse Debt Allocation',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Analysis',
    question: 'Partnership nonrecourse debt is allocated to partners:',
    options: [
      'To general partners only',
      'By capital accounts',
      'Equally',
      'Based on minimum gain, §704(c) minimum gain, then profit-sharing ratio',
    ],
    correctAnswer: 3,
    explanation: 'Nonrecourse allocation (3-tier): (1) partnership minimum gain (by profit %), (2) partner §704(c) minimum gain (built-in gain from contributed property), (3) remaining by profit-sharing ratio. Recourse: based on economic risk of loss.',
    reference: 'Reg. §1.752-3',
  },
  {
    id: 'tcp-mast-010',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-property',
    topic: 'Property Transactions',
    subtopic: 'Section 179 Limitations',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Application',
    question: 'Section 179 expensing is limited by:',
    options: [
      'Depreciation only',
      'Asset type only',
      'No limitations',
      'Annual dollar limit ($1.16M for 2024), investment ceiling ($2.89M phase-out), and taxable income',
    ],
    correctAnswer: 3,
    explanation: '§179 limits: (1) dollar limit ($1.16M 2024), (2) investment limit (dollar-for-dollar phase-out starts at $2.89M), (3) taxable income limit (can\'t create loss, carryforward excess). Applies to tangible personal property, some real property.',
    reference: 'IRC §179',
  },
  {
    id: 'tcp-mast-011',
    courseId: 'cpa',
    section: 'TCP',
    blueprintArea: 'TCP-IV',
    topic: 'Property Transactions',
    subtopic: 'Like-Kind Exchange Boot',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A taxpayer exchanged an office building (FMV $800,000, adjusted basis $500,000) for another office building (FMV $700,000) plus $100,000 cash in a like-kind exchange. What is the recognized gain and the basis of the new property?',
    options: [
      'Recognized gain of $100,000 (limited to boot received); basis of new property is $500,000',
      'No recognized gain; basis of new property is $500,000',
      'Recognized gain of $300,000; basis of new property is $700,000',
      'Recognized gain of $100,000; basis of new property is $600,000',
    ],
    correctAnswer: 0,
    explanation: 'In a like-kind exchange under IRC §1031, gain is recognized to the extent of boot received. Realized gain = $800,000 FMV given − $500,000 basis = $300,000. Boot received = $100,000 cash. Recognized gain = lesser of realized gain ($300,000) or boot ($100,000) = $100,000. Basis of new property = basis of old ($500,000) + gain recognized ($100,000) − boot received ($100,000) = $500,000. The $200,000 deferred gain is preserved in the lower basis.',
    reference: 'IRC §1031',
  },
  {
    id: 'tcp-mast-012',
    courseId: 'cpa',
    section: 'TCP',
    blueprintArea: 'TCP-IV',
    topic: 'International Taxation',
    subtopic: 'FDII Deduction',
    difficulty: 'hard',
    skillLevel: 'Analysis',
    question: 'A U.S. corporation has a CFC that earns $3,000,000, of which $500,000 is foreign base company sales income (Subpart F) and $2,500,000 is tested income for GILTI. The CFC has QBAI of $5,000,000. What is the total current-year inclusion?',
    options: [
    '$2,500,000 — $500,000 Subpart F plus $2,000,000 GILTI ($2,500,000 tested income minus $500,000 DTIR)',
    '$3,000,000 — the full CFC income',
    '$500,000 — only Subpart F income',
    '$2,000,000 — only GILTI',
    ],
    correctAnswer: 0,
    explanation: 'Subpart F income ($500,000) is included first under IRC §951 — this captures passive and mobile income. GILTI is calculated separately on remaining tested income: $2,500,000 − DTIR (10% × $5,000,000 = $500,000) = $2,000,000. Total inclusion = $500,000 Subpart F + $2,000,000 GILTI = $2,500,000. Subpart F income is not included in tested income (no double counting). The §250 deduction (50% of GILTI for corporations) reduces the effective tax on GILTI.',
    reference: 'IRC §250',
  },
  {
    id: 'tcp-mast-013',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-international',
    topic: 'International Taxation',
    subtopic: 'Treaty Benefits',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Evaluation',
    question: 'Tax treaty benefits typically provide:',
    options: [
      'Elimination of all US tax',
      'Reporting exemptions',
      'Increased taxation',
      'Reduced withholding rates, permanent establishment thresholds, and tie-breaker rules',
    ],
    correctAnswer: 3,
    explanation: 'Treaty benefits: reduced withholding (dividends: 5-15%, interest: 0-10%, royalties: 0-10%), PE definition, business profits exemption without PE, tie-breaker for dual residents, mutual agreement procedures. Must claim on forms.',
    reference: 'US Tax Treaties',
  },
  {
    id: 'tcp-mast-014',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'NUA Treatment',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'Net Unrealized Appreciation (NUA) on employer stock allows:',
    options: [
      'Deferral only',
      'Tax-free distribution',
      'Full capital gain treatment',
      'Distribution of stock with ordinary income on cost basis only; NUA taxed as LTCG when sold',
    ],
    correctAnswer: 3,
    explanation: 'NUA strategy: lump-sum distribution from qualified plan. Ordinary income on cost basis only. NUA not taxed until stock sold (as LTCG regardless of holding period post-distribution). Additional appreciation: short or long-term based on holding.',
    reference: 'IRC §402(e)(4)',
  },
  {
    id: 'tcp-mast-015',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-estate',
    topic: 'Estate & Gift Tax',
    subtopic: 'Portability',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Application',
    question: 'Estate tax portability allows:',
    options: [
      'Unlimited transfers',
      'Transferring estate',
      'Surviving spouse to use deceased spouse\'s unused exclusion amount (DSUE) if elected on timely filed estate return',
      'Avoiding all estate tax',
    ],
    correctAnswer: 2,
    explanation: 'Portability: DSUE transfers to surviving spouse if elected on Form 706 (even if no tax due). Not automatic - must file return. Only last deceased spouse\'s DSUE available. Doesn\'t apply to GST exemption (no GST portability).',
    reference: 'IRC §2010(c)(4)',
  },
  {
    id: 'tcp-mast-016',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-estate',
    topic: 'Estate & Gift Tax',
    subtopic: 'Valuation Discounts',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Evaluation',
    question: 'Valuation discounts for closely held business interests include:',
    options: [
      'Lack of control (minority) discount and lack of marketability discount',
      'No discounts allowed',
      'Only real estate discounts',
      '50% automatic discount',
    ],
    correctAnswer: 0,
    explanation: 'Valuation discounts: (1) lack of control/minority (no control over distributions, operations), (2) lack of marketability (no ready market to sell). Combined can be 25-40%+. IRS scrutinizes. §2704 may limit certain discounts for family entities.',
    reference: 'Estate Valuation Discounts',
  },
  {
    id: 'tcp-mast-017',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-corporate',
    topic: 'Corporate Taxation',
    subtopic: 'Section 338 Election',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Analysis',
    question: 'A Section 338(h)(10) election results in:',
    options: [
      'Tax-free acquisition',
      'Double taxation',
      'No gain recognition',
      'Treatment of stock sale as asset sale, with target recognizing gain and buyer getting stepped-up basis',
    ],
    correctAnswer: 3,
    explanation: '§338(h)(10): joint election by buyer and seller. Stock sale treated as asset sale for tax. Target recognizes gain/loss on deemed asset sale. Buyer gets cost basis in assets. Single level of tax. Requires corporate seller.',
    reference: 'IRC §338(h)(10)',
  },
  {
    id: 'tcp-mast-018',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-qbi',
    topic: 'Qualified Business Income',
    subtopic: 'Aggregation Rules',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Analysis',
    question: 'Taxpayers may elect to aggregate QBI businesses if:',
    options: [
      'Any related businesses',
      'Only SSTBs',
      'Same ownership, commonly controlled, and factors indicate operational/economic integration',
      'IRS approval required',
    ],
    correctAnswer: 2,
    explanation: 'QBI aggregation: same ownership (50%+), businesses share at least 2 of 3: (1) significant centralized functions, (2) significant common goods/services, (3) significant operational interdependence. Once elected, binding. Helps optimize W-2/UBIA limitations.',
    reference: 'IRC §199A Aggregation',
  },
  {
    id: 'tcp-mast-019',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'Charitable Remainder Trust',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'A charitable remainder trust provides:',
    options: [
      'No tax benefits',
      'Estate tax exclusion only',
      'Immediate full deduction',
      'Current deduction for remainder interest, income stream to donor/beneficiary, and no immediate gain on contributed appreciated property',
    ],
    correctAnswer: 3,
    explanation: 'CRT: contribute appreciated property (no immediate gain recognition), receive income stream (CRAT: fixed annuity, CRUT: % of FMV annually), current deduction for PV of remainder. Trust exempt from tax. Four-tier distribution rules.',
    reference: 'IRC §664',
  },
  {
    id: 'tcp-mast-020',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-retirement',
    topic: 'Retirement Planning',
    subtopic: 'Required Minimum Distributions',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Application',
    question: 'Under SECURE 2.0, RMD age for traditional IRAs is:',
    options: [
      '65',
      '70½',
      '73 (born 1951-1959) or 75 (born 1960+)',
      '72 for everyone',
    ],
    correctAnswer: 2,
    explanation: 'RMD ages (SECURE 2.0): born before 1951: 72, 1951-1959: 73, 1960+: 75. Penalty reduced to 25% (10% if corrected timely). Roth 401(k) no longer requires RMDs during owner\'s lifetime starting 2024.',
    reference: 'SECURE 2.0 - RMD Rules',
  },
  {
    id: 'tcp-mast-021',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-credits',
    topic: 'Tax Credits',
    subtopic: 'Employee Retention Credit',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Application',
    question: 'The Employee Retention Credit (ERC) for 2021 provided:',
    options: [
      '70% of qualified wages up to $10,000 per employee per quarter ($7,000 max credit per quarter)',
      'No credit in 2021',
      '50% of wages',
      '100% of wages',
    ],
    correctAnswer: 0,
    explanation: 'ERC 2021: 70% of qualified wages up to $10,000/quarter = $7,000/employee/quarter max. Eligibility: significant decline in gross receipts or government suspension orders. Ended Q3 2021 (Q4 for recovery startups). IRS scrutinizing aggressive claims.',
    reference: 'IRC §3134 (2021)',
  },
  {
    id: 'tcp-mast-022',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-international',
    topic: 'International Taxation',
    subtopic: 'PFIC Taxation',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Analysis',
    question: 'Passive Foreign Investment Company (PFIC) default taxation results in:',
    options: [
      'Excess distributions taxed at highest ordinary rates plus interest charge',
      'Capital gains treatment',
      'Same as domestic investment',
      'Tax exemption',
    ],
    correctAnswer: 0,
    explanation: 'PFIC default (§1291): excess distributions taxed at highest historical rate plus interest. Punitive regime. Elections: QEF (current inclusion of earnings), Mark-to-Market (annual FV adjustment). Form 8621 required. Avoid PFIC status if possible.',
    reference: 'IRC §1291, §1293, §1296',
  },
  {
    id: 'tcp-mast-023',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-property',
    topic: 'Property Transactions',
    subtopic: 'Depreciation Recapture',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Analysis',
    question: 'Section 1250 unrecaptured gain on real property is taxed at:',
    options: [
      '25% maximum rate for straight-line depreciation previously allowed',
      '0% rate',
      'Ordinary rates',
      '15% rate',
    ],
    correctAnswer: 0,
    explanation: '§1250 unrecaptured gain: post-1986 straight-line depreciation on real property taxed at max 25% (not ordinary like §1245). Additional depreciation (accelerated > SL) taxed as ordinary. Remaining gain is §1231 (potentially LTCG).',
    reference: 'IRC §1(h)(1)(E)',
  },
  {
    id: 'tcp-mast-024',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-partnership',
    topic: 'Partnership Taxation',
    subtopic: 'Carried Interest',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Evaluation',
    question: 'Carried interest (profits interest) in investment partnerships:',
    options: [
      'Always ordinary income',
      'May be taxed as LTCG if 3-year holding period met for applicable partnership interests',
      'Immediately taxable',
      'Tax-free',
    ],
    correctAnswer: 1,
    explanation: 'Carried interest: §1061 requires 3-year holding period for LTCG treatment (normally 1 year). Applies to applicable partnership interests in investment partnerships. Short-term gain recharacterized. Doesn\'t affect capital contributed or share of income from capital.',
    reference: 'IRC §1061',
  },
  {
    id: 'tcp-mast-025',
    section: 'TCP',
    courseId: 'cpa',
    topicId: 'tcp-procedures',
    topic: 'Tax Procedures',
    subtopic: 'Voluntary Disclosure',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Evaluation',
    question: 'IRS voluntary disclosure practice:',
    options: [
      'Provides opportunity to become compliant without criminal prosecution if requirements met before IRS contact',
      'Guarantees no penalties',
      'Eliminates all tax',
      'Is automatic',
    ],
    correctAnswer: 0,
    explanation: 'Voluntary disclosure: taxpayer comes forward before IRS contact/investigation. No guarantee of no prosecution but significant consideration. Requirements: timely, truthful, cooperative, full payment. Civil penalties still apply. Streamlined procedures for certain foreign issues.',
    reference: 'IRM 9.5.11.9',
  },
];
