/**
 * EA SEE Part 1: Individuals - Flashcard Formulas
 * Key calculations and formulas for the Individuals section
 */

import { EAFlashcard } from './types';

export const SEE1_FORMULAS: EAFlashcard[] = [
  // ============================================
  // Income Calculations
  // ============================================
  {
    id: 'see1-form-001',
    section: 'SEE1',
    type: 'formula',
    topic: 'Income',
    subtopic: 'Tax Calculation Flow',
    blueprintArea: 'SEE1-4',
    front: 'What is the formula for calculating taxable income?',
    back: 'Gross Income\n  − Above-the-line deductions\n= **Adjusted Gross Income (AGI)**\n  − Greater of (Standard OR Itemized Deductions)\n  − QBI Deduction (if applicable)\n= **Taxable Income**',
    formula: 'Taxable Income = GI - Above-line - (Std or Itemized) - QBI',
    difficulty: 'easy',
    tags: ['income', 'taxable income'],
    irsReference: 'IRC §63',
  },
  {
    id: 'see1-form-002',
    section: 'SEE1',
    type: 'formula',
    topic: 'Self-Employment',
    subtopic: 'SE Tax',
    blueprintArea: 'SEE1-4',
    front: 'How do you calculate Self-Employment Tax?',
    back: '**Step 1:** Net SE Income × 92.35% = SE Tax Base\n\n**Step 2:** SE Tax Base × 15.3% = SE Tax\n(12.4% Social Security + 2.9% Medicare)\n\n**Note:** SS wage base for 2024: $168,600\nAdditional Medicare: 0.9% on earned income > $200K (S) / $250K (MFJ)',
    formula: 'SE Tax = (Net SE Income × 0.9235) × 0.153',
    example: '$100,000 SE income → $100,000 × 0.9235 × 0.153 = $14,130 SE tax',
    difficulty: 'medium',
    tags: ['self-employment', 'SE tax'],
    irsReference: 'IRC §1401',
  },
  {
    id: 'see1-form-003',
    section: 'SEE1',
    type: 'formula',
    topic: 'Self-Employment',
    subtopic: 'SE Tax Deduction',
    blueprintArea: 'SEE1-3',
    front: 'What is the above-the-line deduction for Self-Employment Tax?',
    back: '**Deduction = 50% of Self-Employment Tax**\n\nThis is an adjustment to income (above-the-line), reducing AGI.\n\nPurpose: Mirrors the employer portion of FICA that employees don\'t pay.',
    formula: 'SE Tax Deduction = SE Tax × 0.50',
    example: 'SE Tax of $14,130 → Deduction of $7,065',
    difficulty: 'easy',
    tags: ['self-employment', 'deductions'],
    irsReference: 'IRC §164(f)',
  },
  {
    id: 'see1-form-004',
    section: 'SEE1',
    type: 'formula',
    topic: 'Capital Gains',
    subtopic: 'Gain/Loss Calculation',
    blueprintArea: 'SEE1-2',
    front: 'How do you calculate capital gain or loss on sale of property?',
    back: '**Amount Realized**\n  (Sale price − selling expenses)\n− **Adjusted Basis**\n  (Cost + improvements − depreciation)\n= **Gain or Loss**\n\nIf AR > AB = Gain\nIf AR < AB = Loss',
    formula: 'Gain/Loss = Amount Realized − Adjusted Basis',
    example: 'Sold stock for $15,000 (cost $10,000) → Gain of $5,000',
    difficulty: 'easy',
    tags: ['capital gains', 'basis'],
    irsReference: 'IRC §1001',
  },
  {
    id: 'see1-form-005',
    section: 'SEE1',
    type: 'formula',
    topic: 'Capital Gains',
    subtopic: 'Net Capital Gain',
    blueprintArea: 'SEE1-2',
    front: 'How do you calculate Net Capital Gain for tax purposes?',
    back: '**Step 1:** Net ST gains and losses together\n**Step 2:** Net LT gains and losses together\n**Step 3:** Net the two results\n\n**Net Capital Gain formula:**\nNet LT Capital Gain − Net ST Capital Loss\n\n**Capital Loss Limit:** $3,000/year deductible against ordinary income, excess carries forward',
    formula: 'Net Capital Gain = NLTCG − NSTCL (if positive)',
    difficulty: 'medium',
    tags: ['capital gains', 'netting'],
    irsReference: 'IRC §1222',
  },
  {
    id: 'see1-form-006',
    section: 'SEE1',
    type: 'formula',
    topic: 'Depreciation',
    subtopic: 'Straight-Line',
    blueprintArea: 'SEE1-2',
    front: 'What is the Straight-Line Depreciation formula?',
    back: '**Annual Depreciation = (Cost − Salvage Value) ÷ Useful Life**\n\nFor tax purposes (MACRS), salvage value is $0.\n\n**Half-Year Convention:** First and last year get half depreciation\n**Mid-Month Convention:** Real property - depreciation starts mid-month of placed in service',
    formula: 'Depreciation = Cost ÷ Recovery Period',
    example: '$10,000 asset, 5-year life → $2,000/year (straight-line)',
    difficulty: 'easy',
    tags: ['depreciation'],
    irsReference: 'IRC §167; §168',
  },
  {
    id: 'see1-form-007',
    section: 'SEE1',
    type: 'formula',
    topic: 'Retirement',
    subtopic: 'Early Distribution Penalty',
    blueprintArea: 'SEE1-2',
    front: 'How is the early withdrawal penalty calculated for retirement accounts?',
    back: '**Penalty = Taxable Distribution × 10%**\n\nApplies to distributions before age 59½ from:\n• IRAs (Traditional and Roth earnings)\n• 401(k), 403(b), etc.\n\n**Exceptions:** Death, disability, SEPP, medical expenses > 7.5% AGI, first home ($10K IRA), education, health insurance while unemployed',
    formula: 'Early Withdrawal Penalty = Distribution × 0.10',
    example: '$20,000 early withdrawal → $2,000 penalty (plus income tax)',
    difficulty: 'easy',
    tags: ['retirement', 'penalties'],
    irsReference: 'IRC §72(t)',
  },
  {
    id: 'see1-form-008',
    section: 'SEE1',
    type: 'formula',
    topic: 'Credits',
    subtopic: 'AOTC Calculation',
    blueprintArea: 'SEE1-5',
    front: 'How is the American Opportunity Tax Credit calculated?',
    back: '**AOTC = 100% of first $2,000 + 25% of next $2,000**\n\nMaximum credit: $2,500\nRefundable portion: 40% ($1,000 max)\n\n**Phaseout:**\n• Single: $80,000-$90,000\n• MFJ: $160,000-$180,000',
    formula: 'AOTC = $2,000 + (0.25 × next $2,000) = $2,500 max',
    example: '$3,000 qualified expenses → $2,000 + $250 = $2,250 credit',
    difficulty: 'medium',
    tags: ['credits', 'education'],
    irsReference: 'IRC §25A',
  },
  {
    id: 'see1-form-009',
    section: 'SEE1',
    type: 'formula',
    topic: 'Itemized Deductions',
    subtopic: 'Medical Expenses',
    blueprintArea: 'SEE1-3',
    front: 'How are medical expense deductions calculated?',
    back: '**Deductible Medical Expenses = Total Medical − (7.5% × AGI)**\n\nOnly the amount EXCEEDING 7.5% of AGI is deductible.\n\n**Qualified expenses:** Doctors, dentists, prescriptions, medical equipment, insurance premiums (not pretax), mileage for medical, long-term care (limits apply)',
    formula: 'Medical Deduction = Total Medical − (AGI × 0.075)',
    example: 'AGI $100,000, Medical $10,000 → $10,000 − $7,500 = $2,500 deductible',
    difficulty: 'easy',
    tags: ['deductions', 'medical'],
    irsReference: 'IRC §213',
  },
  {
    id: 'see1-form-010',
    section: 'SEE1',
    type: 'formula',
    topic: 'Itemized Deductions',
    subtopic: 'Casualty Loss',
    blueprintArea: 'SEE1-3',
    front: 'How is the personal casualty loss deduction calculated?',
    back: '**Currently limited to federally declared disasters**\n\n**Formula:**\nLoss = Lesser of (Decline in FMV OR Adjusted Basis)\n  − Insurance/reimbursement\n  − $100 per event\n  − 10% of AGI\n\n**For 2018-2025:** Only federally declared disaster losses are deductible',
    formula: 'Net Loss = (Lesser of ΔFMV or Basis) − Insurance − $100 − (10% × AGI)',
    difficulty: 'hard',
    tags: ['deductions', 'casualty'],
    irsReference: 'IRC §165(c)(3); §165(h)',
  },
  {
    id: 'see1-form-011',
    section: 'SEE1',
    type: 'formula',
    topic: 'Estimated Taxes',
    subtopic: 'Safe Harbor',
    blueprintArea: 'SEE1-4',
    front: 'What are the safe harbor rules for estimated tax payments?',
    back: '**No Penalty if payments ≥:**\n• 90% of current year tax, OR\n• 100% of prior year tax (110% if prior year AGI > $150,000)\n\n**Due Dates:** April 15, June 15, Sept 15, Jan 15\n\n**Annualized Income Method:** Alternative if income uneven throughout year',
    formula: 'Safe Harbor = Greater of (90% current) or (100%/110% prior)',
    difficulty: 'medium',
    tags: ['estimated taxes', 'safe harbor'],
    irsReference: 'IRC §6654',
  },
  {
    id: 'see1-form-012',
    section: 'SEE1',
    type: 'formula',
    topic: 'Credits',
    subtopic: 'Child & Dependent Care',
    blueprintArea: 'SEE1-5',
    front: 'How is the Child and Dependent Care Credit calculated?',
    back: '**Credit = Qualifying Expenses × Credit Percentage**\n\n**Expense Limit:**\n• 1 qualifying person: $3,000\n• 2+ qualifying persons: $6,000\n\n**Credit Percentage:** 20%-35% based on AGI\n• 35% for AGI ≤ $15,000\n• Declines 1% per $2,000 to 20% at $43,000+\n\n**Must have earned income** (expenses limited to lower-earning spouse)',
    formula: 'Credit = Min(Expenses, Limit, Earned Income) × Rate%',
    example: '$5,000 expenses, 2 kids, $50K AGI → $5,000 × 20% = $1,000',
    difficulty: 'medium',
    tags: ['credits', 'dependent care'],
    irsReference: 'IRC §21',
  },
  {
    id: 'see1-form-013',
    section: 'SEE1',
    type: 'formula',
    topic: 'Basis',
    subtopic: 'Gift Basis',
    blueprintArea: 'SEE1-2',
    front: 'What is the basis of property received as a gift?',
    back: '**General Rule:** Carryover basis (donor\'s basis)\n\n**Exception for Loss Property:**\nIf FMV at gift < donor\'s basis:\n• For gain: Use donor\'s basis\n• For loss: Use FMV at gift date\n• If sale between: No gain, no loss\n\n**Add gift tax paid** that relates to net appreciation (proportional)',
    formula: 'Gift Basis = Donor\'s Basis (or FMV if lower, for losses)',
    example: 'Donor basis $10K, FMV at gift $7K, sold for $8K → No gain/loss',
    difficulty: 'hard',
    tags: ['basis', 'gifts'],
    irsReference: 'IRC §1015',
  },
  {
    id: 'see1-form-014',
    section: 'SEE1',
    type: 'formula',
    topic: 'Basis',
    subtopic: 'Inherited Property Basis',
    blueprintArea: 'SEE1-2',
    front: 'What is the basis of property received by inheritance?',
    back: '**General Rule:** Stepped-up (or down) basis to FMV at date of death\n\n**Alternative Valuation Date:** 6 months after death (if reduces estate value)\n\n**Community Property:** Both halves get step-up\n\n**Exception:** Income in Respect of Decedent (IRD) - no step-up',
    formula: 'Inherited Basis = FMV at Death (or AVD)',
    example: 'Decedent\'s basis $10K, FMV at death $100K → Heir\'s basis = $100K',
    difficulty: 'medium',
    tags: ['basis', 'inheritance'],
    irsReference: 'IRC §1014',
  },
  {
    id: 'see1-form-015',
    section: 'SEE1',
    type: 'formula',
    topic: 'Self-Employment',
    subtopic: 'Net SE Income',
    blueprintArea: 'SEE1-4',
    front: 'How do you calculate Net Earnings from Self-Employment?',
    back: '**Net SE Income = Gross SE Income − SE Business Expenses**\n\nIncludes:\n• Schedule C net profit\n• Partner\'s distributive share (if active)\n• Director fees\n\n**Does NOT include:**\n• Rental income (unless RE dealer)\n• Dividends, interest\n• Capital gains\n• Limited partner income',
    formula: 'Net SE Income = Business Revenue − Business Expenses',
    difficulty: 'easy',
    tags: ['self-employment'],
    irsReference: 'IRC §1402',
  },
];
