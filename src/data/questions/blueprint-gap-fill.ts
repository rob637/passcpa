// Blueprint Gap Fill - AUD-VII and ISC-V
// AUD-VII: Quality control, ethics enforcement, professional responsibilities
// ISC-V: SOC engagements, IT audit procedures, system examinations

import { Question } from '../../types';

// ==========================================
// AUD-VII - QUALITY CONTROL & ETHICS
// ==========================================
export const AUD_VII_GAP_QUESTIONS: Question[] = [
  // Quality Control Standards
  {
    id: 'aud-gap-vii-001',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'qm-standards',
    topic: 'Quality Management',
    subtopic: 'SQMS 1 Requirements',
    difficulty: 'medium',
    question: 'Under SQMS 1, which component addresses the firm\'s policies for client acceptance and continuance?',
    options: [
      'Risk assessment process',
      'Governance and leadership',
      'Relevant ethical requirements',
      'Acceptance and continuance of client relationships'
    ],
    correctAnswer: 3,
    explanation: 'SQMS 1 includes a specific component for "Acceptance and Continuance of Client Relationships and Specific Engagements" which requires firms to establish policies and procedures for evaluating prospective clients and engagements.',
    reference: 'SQMS 1.30-.33',
    skillLevel: 'Application',
  },
  {
    id: 'aud-gap-vii-002',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'qm-standards',
    topic: 'Quality Management',
    subtopic: 'Engagement Quality Review',
    difficulty: 'medium',
    question: 'For which types of engagements is an engagement quality review (EQR) always required?',
    options: [
      'All compilation engagements',
      'All audit engagements of public entities',
      'All review engagements',
      'Only engagements with significant deficiencies'
    ],
    correctAnswer: 1,
    explanation: 'An engagement quality review is required for all audit engagements of public entities (issuers). For non-issuers, the firm determines criteria based on its risk assessment.',
    reference: 'SQMS 2, AS 1220',
    skillLevel: 'Remembering',
  },
  {
    id: 'aud-gap-vii-003',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'qm-monitoring',
    topic: 'Quality Management',
    subtopic: 'Monitoring and Remediation',
    difficulty: 'hard',
    question: 'Under SQMS 1, when a deficiency in the system of quality management is identified, the firm must:',
    options: [
      'Report the deficiency to the PCAOB within 30 days',
      'Evaluate the root cause, design remedial actions, and evaluate whether similar deficiencies exist',
      'Immediately terminate all affected engagements',
      'Notify all affected clients within 60 days'
    ],
    correctAnswer: 1,
    explanation: 'SQMS 1 requires firms to investigate identified deficiencies, evaluate root causes, design and implement remedial actions, and evaluate whether similar deficiencies exist or could occur elsewhere.',
    reference: 'SQMS 1.49-.51',
    skillLevel: 'Application',
  },
  {
    id: 'aud-gap-vii-004',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Ethics Enforcement',
    topicId: 'aicpa-enforcement',
    topic: 'Professional Ethics',
    subtopic: 'AICPA Disciplinary Actions',
    difficulty: 'medium',
    question: 'Which AICPA committee has the authority to investigate potential ethics violations and recommend disciplinary action?',
    options: [
      'Auditing Standards Board',
      'Professional Ethics Executive Committee',
      'Peer Review Board',
      'Board of Directors'
    ],
    correctAnswer: 1,
    explanation: 'The Professional Ethics Executive Committee (PEEC) is responsible for investigating potential ethics violations, issuing ethics interpretations, and recommending disciplinary actions against members.',
    reference: 'AICPA Bylaws Section 7',
    skillLevel: 'Remembering',
  },
  {
    id: 'aud-gap-vii-005',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Ethics Enforcement',
    topicId: 'joint-trial-board',
    topic: 'Professional Ethics',
    subtopic: 'Joint Trial Board',
    difficulty: 'hard',
    question: 'Under the AICPA Joint Ethics Enforcement Program, automatic expulsion from membership occurs when a CPA:',
    options: [
      'Fails to complete required CPE hours for two consecutive years',
      'Is convicted of a felony defined in the AICPA bylaws as a crime punishable by imprisonment for more than one year',
      'Receives an adverse peer review report',
      'Is named in three or more malpractice lawsuits'
    ],
    correctAnswer: 1,
    explanation: 'Under AICPA Bylaws Section 7.3, automatic expulsion occurs when a member is convicted of a crime punishable by imprisonment for more than one year, including tax fraud, embezzlement, or other financial crimes.',
    reference: 'AICPA Bylaws Section 7.3',
    skillLevel: 'Remembering',
  },
  {
    id: 'aud-gap-vii-006',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'peer-review',
    topic: 'Quality Management',
    subtopic: 'Peer Review Requirements',
    difficulty: 'medium',
    question: 'For a CPA firm performing audits, how often must the firm undergo a peer review?',
    options: [
      'Annually',
      'Every two years',
      'Every three years',
      'Every five years'
    ],
    correctAnswer: 2,
    explanation: 'Firms enrolled in the AICPA Peer Review Program that perform audit, review, or certain attestation engagements must have a peer review at least once every three years.',
    reference: 'AICPA Peer Review Standards',
    skillLevel: 'Remembering',
  },
  {
    id: 'aud-gap-vii-007',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'peer-review-types',
    topic: 'Quality Management',
    subtopic: 'Types of Peer Reviews',
    difficulty: 'medium',
    question: 'A firm that only performs compilation engagements (no audit or review engagements) would receive which type of peer review?',
    options: [
      'System review',
      'Engagement review',
      'No peer review is required',
      'Limited review'
    ],
    correctAnswer: 1,
    explanation: 'Firms performing only compilation engagements undergo an Engagement Review. Firms performing audits, reviews, or examinations undergo a System Review which evaluates the firm\'s system of quality control.',
    reference: 'AICPA Peer Review Standards',
    skillLevel: 'Application',
  },
  {
    id: 'aud-gap-vii-008',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Ethics Enforcement',
    topicId: 'state-board-actions',
    topic: 'Professional Ethics',
    subtopic: 'State Board Enforcement',
    difficulty: 'medium',
    question: 'What is the relationship between state board of accountancy disciplinary actions and AICPA membership?',
    options: [
      'State board actions have no effect on AICPA membership',
      'State license suspension automatically suspends AICPA membership',
      'AICPA can discipline members based on state board actions without conducting its own investigation',
      'State board actions must be reviewed by the AICPA before taking effect'
    ],
    correctAnswer: 2,
    explanation: 'Under the Joint Ethics Enforcement Program, the AICPA can impose discipline based on state board findings without a separate investigation, as long as the state board\'s proceedings provided due process.',
    reference: 'AICPA/State CPA Society Joint Ethics Enforcement Program',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'aud-gap-vii-009',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'eqr-completion',
    topic: 'Quality Management',
    subtopic: 'Engagement Quality Review Timing',
    difficulty: 'hard',
    question: 'The engagement quality reviewer must complete the review before:',
    options: [
      'The audit planning phase is finalized',
      'Fieldwork begins',
      'The auditor\'s report is dated',
      'The financial statements are filed with regulators'
    ],
    correctAnswer: 2,
    explanation: 'The engagement quality review must be completed, and all questions resolved, before the auditor\'s report is dated. This ensures the review is completed before the report is released.',
    reference: 'SQMS 2.27, AS 1220',
    skillLevel: 'Application',
  },
  {
    id: 'aud-gap-vii-010',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Ethics Enforcement',
    topicId: 'sec-sanctions',
    topic: 'Professional Ethics',
    subtopic: 'SEC Enforcement Actions',
    difficulty: 'hard',
    question: 'Under SEC Rule 102(e), the Commission may temporarily or permanently deny an accountant the privilege of appearing or practicing before it for all of the following reasons EXCEPT:',
    options: [
      'Lacking the requisite qualifications to represent others',
      'Lacking character or integrity',
      'Having engaged in unethical or improper professional conduct',
      'Having been suspended from membership in a professional organization for failure to pay dues'
    ],
    correctAnswer: 3,
    explanation: 'SEC Rule 102(e) allows denial of practice privileges for lack of qualifications, lack of character or integrity, unethical conduct, or willful violations of securities laws. Suspension for non-payment of dues is not a grounds for SEC sanction.',
    reference: 'SEC Rule 102(e), SOX Section 602',
    skillLevel: 'Remembering and Understanding',
  },
  // Additional Quality Control questions
  {
    id: 'aud-gap-vii-011',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'independence-policies',
    topic: 'Quality Management',
    subtopic: 'Firm Independence Policies',
    difficulty: 'medium',
    question: 'A firm\'s system of quality management must include policies requiring personnel to promptly notify the firm when they become aware of:',
    options: [
      'Any changes in audit client management',
      'Breaches of independence requirements',
      'Decreases in client revenue',
      'Changes in industry regulations'
    ],
    correctAnswer: 1,
    explanation: 'SQMS 1 requires firms to have policies for personnel to promptly notify the firm of independence breaches so appropriate action can be taken, including evaluating the significance and impact on engagements.',
    reference: 'SQMS 1.29',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'aud-gap-vii-012',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'documentation-retention',
    topic: 'Quality Management',
    subtopic: 'Documentation Retention',
    difficulty: 'medium',
    question: 'Under auditing standards, the minimum retention period for audit documentation after the report release date is:',
    options: [
      '3 years',
      '5 years',
      '7 years',
      '10 years'
    ],
    correctAnswer: 2,
    explanation: 'AU-C 230 requires audit documentation to be retained for at least 5 years after the report release date. For SEC audits, documentation must be retained for 7 years under PCAOB rules.',
    reference: 'AU-C 230, AS 1215',
    skillLevel: 'Remembering',
  },
  {
    id: 'aud-gap-vii-013',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Ethics Enforcement',
    topicId: 'pcaob-sanctions',
    topic: 'Professional Ethics',
    subtopic: 'PCAOB Enforcement',
    difficulty: 'hard',
    question: 'The PCAOB has authority to impose sanctions on registered firms and associated persons. Which of the following is NOT a sanction the PCAOB can impose?',
    options: [
      'Civil monetary penalties',
      'Revocation of firm registration',
      'Suspension from association with registered firms',
      'Criminal prosecution'
    ],
    correctAnswer: 3,
    explanation: 'The PCAOB can impose civil monetary penalties, revoke registration, suspend individuals, and require remedial measures. Criminal prosecution authority rests with the Department of Justice, not the PCAOB.',
    reference: 'SOX Section 105(c)',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'aud-gap-vii-014',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'hot-review',
    topic: 'Quality Management',
    subtopic: 'Concurring Partner Review',
    difficulty: 'medium',
    question: 'For non-issuer audits, a firm determines the criteria for requiring an engagement quality review. Which factor would most likely indicate the need for such a review?',
    options: [
      'The engagement has been performed for more than three consecutive years',
      'The entity is a first-year audit client in a high-risk industry',
      'The client has elected to change its fiscal year-end',
      'The audit fee exceeds $50,000'
    ],
    correctAnswer: 1,
    explanation: 'First-year audits, high-risk industries, and entities of public interest are factors that would typically indicate the need for an engagement quality review under firm policies.',
    reference: 'SQMS 2.25-.26',
    skillLevel: 'Application',
  },
  {
    id: 'aud-gap-vii-015',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Ethics Enforcement',
    topicId: 'reporting-violations',
    topic: 'Professional Ethics',
    subtopic: 'Reporting Ethics Violations',
    difficulty: 'hard',
    question: 'Under the AICPA Code of Professional Conduct, a CPA who becomes aware that another CPA may have committed an act discreditable to the profession should:',
    options: [
      'Immediately report the violation to the AICPA ethics division',
      'Report the violation to the appropriate regulatory authority and consider consulting with legal counsel',
      'Confront the other CPA directly before taking any action',
      'Take no action unless the violation directly affects the CPA\'s own clients'
    ],
    correctAnswer: 1,
    explanation: 'CPAs may have reporting obligations under state accountancy laws and should consider consulting with legal counsel. The Code encourages ethical behavior but specific reporting requirements vary by jurisdiction.',
    reference: 'AICPA Code of Professional Conduct 1.700',
    skillLevel: 'Application',
  },
  // Easy questions for AUD-VII
  {
    id: 'aud-gap-vii-016',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'qm-basics',
    topic: 'Quality Management',
    subtopic: 'SQMS Overview',
    difficulty: 'easy',
    question: 'What does SQMS stand for in the context of quality management standards?',
    options: [
      'Standard Quality Measurement System',
      'Statements on Quality Management Standards',
      'Strategic Quality Management Services',
      'Systematic Quality Monitoring Standards'
    ],
    correctAnswer: 1,
    explanation: 'SQMS stands for Statements on Quality Management Standards, issued by the AICPA to establish standards for firms providing audit, review, and attestation services.',
    reference: 'SQMS 1',
    skillLevel: 'Remembering',
  },
  {
    id: 'aud-gap-vii-017',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Ethics Enforcement',
    topicId: 'cpe-requirements',
    topic: 'Professional Ethics',
    subtopic: 'Continuing Education',
    difficulty: 'easy',
    question: 'The purpose of mandatory CPE requirements for CPAs is to:',
    options: [
      'Generate revenue for state boards',
      'Maintain professional competence and stay current with changes in the profession',
      'Limit the number of practicing CPAs',
      'Satisfy IRS requirements for tax preparers'
    ],
    correctAnswer: 1,
    explanation: 'CPE requirements ensure that CPAs maintain and improve their professional competence, staying current with changes in standards, regulations, and best practices.',
    reference: 'AICPA Code 1.400',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'aud-gap-vii-018',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'engagement-partner',
    topic: 'Quality Management',
    subtopic: 'Engagement Partner Responsibilities',
    difficulty: 'easy',
    question: 'The engagement partner is ultimately responsible for:',
    options: [
      'Preparing all audit documentation',
      'The overall quality of the engagement',
      'Calculating the audit fee',
      'Selecting all engagement team members'
    ],
    correctAnswer: 1,
    explanation: 'The engagement partner has overall responsibility for managing and achieving quality on the engagement, including direction and supervision of the engagement team.',
    reference: 'AU-C 220.14',
    skillLevel: 'Remembering',
  },
  {
    id: 'aud-gap-vii-019',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Ethics Enforcement',
    topicId: 'independence-basics',
    topic: 'Professional Ethics',
    subtopic: 'Independence Requirement',
    difficulty: 'easy',
    question: 'Independence in auditing consists of:',
    options: [
      'Independence in fact only',
      'Independence in appearance only',
      'Independence in fact and in appearance',
      'Independence from management decisions'
    ],
    correctAnswer: 2,
    explanation: 'Auditors must maintain both independence in fact (actual objectivity) and independence in appearance (others\' perception of objectivity) to serve the public interest.',
    reference: 'AICPA Code ET 1.200',
    skillLevel: 'Remembering',
  },
  {
    id: 'aud-gap-vii-020',
    section: 'AUD',
    blueprintArea: 'AUD-VII',
    blueprintGroup: 'Quality Management',
    topicId: 'supervision-basics',
    topic: 'Quality Management',
    subtopic: 'Supervision Requirements',
    difficulty: 'easy',
    question: 'Proper supervision during an audit includes:',
    options: [
      'Only reviewing workpapers after the audit is complete',
      'Directing, supervising, and reviewing the work of engagement team members',
      'Delegating all work to staff accountants',
      'Allowing team members to work independently without oversight'
    ],
    correctAnswer: 1,
    explanation: 'AU-C 220 requires the engagement partner to direct, supervise, and review the work performed by engagement team members on a timely basis throughout the engagement.',
    reference: 'AU-C 220.16',
    skillLevel: 'Remembering and Understanding',
  },
];

// ==========================================
// ISC-V - SOC ENGAGEMENTS & IT AUDIT
// ==========================================
export const ISC_V_GAP_QUESTIONS: Question[] = [
  // SOC 1 Engagements
  {
    id: 'isc-gap-v-001',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc1-purpose',
    topic: 'SOC Reports',
    subtopic: 'SOC 1 Purpose',
    difficulty: 'medium',
    question: 'A SOC 1Â® report is primarily designed to address controls at a service organization that are relevant to:',
    options: [
      'User entities\' internal control over financial reporting',
      'Security, availability, and privacy',
      'Compliance with data protection regulations',
      'IT general controls only'
    ],
    correctAnswer: 0,
    explanation: 'SOC 1 reports are designed for user entities and their auditors to evaluate controls at a service organization that are relevant to user entities\' internal control over financial reporting (ICFR).',
    reference: 'SSAE 18, AT-C 320',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-gap-v-002',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc1-types',
    topic: 'SOC Reports',
    subtopic: 'Type 1 vs Type 2',
    difficulty: 'medium',
    question: 'The key difference between a SOC 1 Type 1 and Type 2 report is:',
    options: [
      'Type 1 is for financial services; Type 2 is for technology companies',
      'Type 1 covers design only at a point in time; Type 2 covers design and operating effectiveness over a period',
      'Type 1 is restricted use; Type 2 is general use',
      'Type 1 requires testing all controls; Type 2 only tests key controls'
    ],
    correctAnswer: 1,
    explanation: 'Type 1 reports cover the description of controls and their suitability of design at a specific point in time. Type 2 reports also include testing of operating effectiveness over a specified period (typically 6-12 months).',
    reference: 'AT-C 320',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-gap-v-003',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc2-criteria',
    topic: 'SOC Reports',
    subtopic: 'SOC 2 Trust Services Criteria',
    difficulty: 'hard',
    question: 'Which of the following is NOT one of the Trust Services Criteria categories used in SOC 2 examinations?',
    options: [
      'Security',
      'Availability',
      'Auditability',
      'Confidentiality'
    ],
    correctAnswer: 2,
    explanation: 'The five Trust Services Criteria categories are: Security (required), Availability, Processing Integrity, Confidentiality, and Privacy. Auditability is not a TSC category.',
    reference: 'AICPA Trust Services Criteria',
    skillLevel: 'Remembering',
  },
  {
    id: 'isc-gap-v-004',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc2-security',
    topic: 'SOC Reports',
    subtopic: 'Security Criteria',
    difficulty: 'medium',
    question: 'The Security principle (also known as Common Criteria) in a SOC 2 report addresses:',
    options: [
      'Only access controls to prevent unauthorized access',
      'Protection against unauthorized access, use, or modification of the system',
      'Only network security and encryption',
      'Physical security of data centers exclusively'
    ],
    correctAnswer: 1,
    explanation: 'The Security criteria address protection against unauthorized access, unauthorized disclosure, and damage that could compromise availability, integrity, confidentiality, and privacy of information.',
    reference: 'TSC CC1.0-CC9.0',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-gap-v-005',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc-carve-out',
    topic: 'SOC Reports',
    subtopic: 'Subservice Organizations',
    difficulty: 'hard',
    question: 'In a SOC 1 report, when a service organization uses the "carve-out" method for a subservice organization:',
    options: [
      'The subservice organization\'s controls are included in the service organization\'s description and testing',
      'The service organization\'s description excludes the subservice organization\'s controls, and user entities must obtain a separate report',
      'Only financial controls of the subservice organization are included',
      'The subservice organization is not mentioned in the report'
    ],
    correctAnswer: 1,
    explanation: 'Under the carve-out method, the service organization\'s description excludes the subservice organization\'s controls. User entities and their auditors must obtain and evaluate a separate report from the subservice organization.',
    reference: 'AT-C 320.A14-.A16',
    skillLevel: 'Application',
  },
  {
    id: 'isc-gap-v-006',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc-inclusive',
    topic: 'SOC Reports',
    subtopic: 'Inclusive Method',
    difficulty: 'hard',
    question: 'When a service organization uses the "inclusive" method for a subservice organization in a SOC report:',
    options: [
      'Only the subservice organization\'s controls are tested',
      'The service auditor tests both the service organization\'s and subservice organization\'s controls',
      'The subservice organization must issue its own separate SOC report',
      'No testing is performed on the subservice organization\'s controls'
    ],
    correctAnswer: 1,
    explanation: 'Under the inclusive method, the service organization includes the subservice organization\'s description and controls in the system description. The service auditor tests both organizations\' relevant controls.',
    reference: 'AT-C 320.A14-.A16',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-gap-v-007',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'IT Audit',
    topicId: 'itgc-categories',
    topic: 'IT General Controls',
    subtopic: 'ITGC Categories',
    difficulty: 'medium',
    question: 'IT General Controls (ITGCs) typically include all of the following categories EXCEPT:',
    options: [
      'Access to programs and data',
      'Program change management',
      'Customer relationship management',
      'Computer operations'
    ],
    correctAnswer: 2,
    explanation: 'ITGCs typically include: Access to programs and data, Program development, Program change management, and Computer operations. Customer relationship management is a business process, not an ITGC.',
    reference: 'PCAOB AS 2110, COSO',
    skillLevel: 'Remembering',
  },
  {
    id: 'isc-gap-v-008',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'IT Audit',
    topicId: 'access-controls',
    topic: 'IT General Controls',
    subtopic: 'Access Control Testing',
    difficulty: 'medium',
    question: 'When testing access controls during an IT audit, the auditor would most likely:',
    options: [
      'Only review the access control policy document',
      'Test whether terminated employees have had access promptly removed and review user access listings for appropriateness',
      'Assume controls are effective if no security breaches occurred',
      'Only test administrative user accounts'
    ],
    correctAnswer: 1,
    explanation: 'Testing access controls includes reviewing timely removal of terminated employee access, periodic user access reviews, appropriate segregation of duties, and ensuring access is commensurate with job responsibilities.',
    reference: 'COBIT, COSO',
    skillLevel: 'Application',
  },
  {
    id: 'isc-gap-v-009',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc3-use',
    topic: 'SOC Reports',
    subtopic: 'SOC 3 General Use',
    difficulty: 'medium',
    question: 'A SOC 3 report differs from a SOC 2 report primarily because SOC 3:',
    options: [
      'Covers a longer time period',
      'Is designed for general use and may be freely distributed (e.g., on a website)',
      'Includes more detailed testing results',
      'Only covers the security criteria'
    ],
    correctAnswer: 1,
    explanation: 'SOC 3 reports are general use reports that can be freely distributed. They contain the same information as SOC 2 but without detailed descriptions of tests and results, making them suitable for marketing purposes.',
    reference: 'AT-C 205',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-gap-v-010',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'IT Audit',
    topicId: 'change-management',
    topic: 'IT General Controls',
    subtopic: 'Change Management Testing',
    difficulty: 'hard',
    question: 'When testing IT change management controls, an auditor would be most concerned if:',
    options: [
      'All changes were documented in a ticketing system',
      'Emergency changes bypassed normal approval processes without subsequent review',
      'Users were required to test changes in a staging environment',
      'Changes required approval from both IT and business owners'
    ],
    correctAnswer: 1,
    explanation: 'While emergency changes may occasionally bypass normal processes, they should be subject to subsequent review and documentation. Lack of any review of emergency changes represents a control deficiency.',
    reference: 'COBIT, ITIL',
    skillLevel: 'Evaluation',
  },
  {
    id: 'isc-gap-v-011',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'complementary-controls',
    topic: 'SOC Reports',
    subtopic: 'Complementary User Entity Controls',
    difficulty: 'medium',
    question: 'Complementary user entity controls (CUECs) in a SOC report are:',
    options: [
      'Controls at the service organization that complement its primary controls',
      'Controls that user entities are expected to implement for the service organization\'s controls to be effective',
      'Optional controls that service organizations may implement',
      'Controls required by regulatory bodies'
    ],
    correctAnswer: 1,
    explanation: 'CUECs are controls that user entities must implement for the service organization\'s control objectives to be achieved. The service organization\'s controls alone may not be sufficient without these complementary controls.',
    reference: 'AT-C 320',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-gap-v-012',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'IT Audit',
    topicId: 'backup-recovery',
    topic: 'IT General Controls',
    subtopic: 'Backup and Recovery',
    difficulty: 'medium',
    question: 'Testing backup and recovery controls would most likely include:',
    options: [
      'Only verifying that backups are performed automatically',
      'Reviewing backup schedules and testing restore procedures to verify data can be recovered',
      'Assuming backups are effective if no data loss has occurred',
      'Only testing full backups, not incremental backups'
    ],
    correctAnswer: 1,
    explanation: 'Complete testing includes reviewing backup schedules, storage locations (offsite/cloud), retention policies, encryption of backup media, and most importantly, periodic testing of restore procedures.',
    reference: 'COBIT DS11',
    skillLevel: 'Application',
  },
  {
    id: 'isc-gap-v-013',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc-opinion',
    topic: 'SOC Reports',
    subtopic: 'SOC Report Opinions',
    difficulty: 'hard',
    question: 'In a SOC 2 Type 2 report, a qualified opinion would most likely be issued when:',
    options: [
      'The service organization uses a subservice organization',
      'One or more controls were not operating effectively during the review period',
      'The service organization experienced a security incident',
      'Management\'s description of the system is inaccurate or incomplete in a material respect'
    ],
    correctAnswer: 3,
    explanation: 'A qualified opinion is issued when management\'s description is not fairly presented in all material respects, or the controls were not suitably designed. Control exceptions result in listing in Section IV but typically not a qualified opinion.',
    reference: 'AT-C 320.A43',
    skillLevel: 'Evaluation',
  },
  {
    id: 'isc-gap-v-014',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'IT Audit',
    topicId: 'segregation-duties',
    topic: 'IT General Controls',
    subtopic: 'Segregation of Duties',
    difficulty: 'medium',
    question: 'In IT environments, which combination of duties should be segregated?',
    options: [
      'Help desk support and user training',
      'Application development and moving code to production',
      'Network monitoring and security awareness training',
      'Hardware maintenance and software licensing'
    ],
    correctAnswer: 1,
    explanation: 'A key IT segregation of duties is between application development and production migration. Developers should not have the ability to move their own code to production without independent review and approval.',
    reference: 'COSO, COBIT',
    skillLevel: 'Application',
  },
  {
    id: 'isc-gap-v-015',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc-for-cybersecurity',
    topic: 'SOC Reports',
    subtopic: 'SOC for Cybersecurity',
    difficulty: 'hard',
    question: 'A SOC for Cybersecurity examination differs from a SOC 2 examination in that SOC for Cybersecurity:',
    options: [
      'Is only available as a Type 1 report',
      'Evaluates an entity\'s cybersecurity risk management program against criteria, not specific controls',
      'Does not require an independent CPA to perform the examination',
      'Only covers organizations in the financial services industry'
    ],
    correctAnswer: 1,
    explanation: 'SOC for Cybersecurity examines an entity\'s cybersecurity risk management program at an entity-wide level, evaluating it against descriptive criteria rather than specific controls as in SOC 2.',
    reference: 'AICPA SOC for Cybersecurity',
    skillLevel: 'Remembering and Understanding',
  },
  // Easy questions for ISC-V
  {
    id: 'isc-gap-v-016',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc-basics',
    topic: 'SOC Reports',
    subtopic: 'SOC Report Overview',
    difficulty: 'easy',
    question: 'What does "SOC" stand for in SOC 1, SOC 2, and SOC 3 reports?',
    options: [
      'Security Operations Center',
      'System and Organization Controls',
      'Service Organization Compliance',
      'Security Oversight Committee'
    ],
    correctAnswer: 1,
    explanation: 'SOC stands for System and Organization Controls. These reports are examination reports performed by independent CPAs that assess controls at service organizations.',
    reference: 'AICPA SOC Suite of Services',
    skillLevel: 'Remembering',
  },
  {
    id: 'isc-gap-v-017',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc-users',
    topic: 'SOC Reports',
    subtopic: 'SOC Report Users',
    difficulty: 'easy',
    question: 'Who are the primary users of a SOC 1 report?',
    options: [
      'The general public',
      'User entities and their auditors',
      'The service organization\'s marketing department',
      'Government regulators only'
    ],
    correctAnswer: 1,
    explanation: 'SOC 1 reports are restricted use reports intended for user entities (customers of the service organization) and their auditors who need to understand and rely on controls at the service organization.',
    reference: 'AT-C 320.08',
    skillLevel: 'Remembering',
  },
  {
    id: 'isc-gap-v-018',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'IT Audit',
    topicId: 'itgc-overview',
    topic: 'IT General Controls',
    subtopic: 'ITGC Purpose',
    difficulty: 'easy',
    question: 'The primary purpose of IT General Controls (ITGCs) is to:',
    options: [
      'Replace all manual controls',
      'Ensure that application controls continue to operate effectively',
      'Eliminate the need for financial audits',
      'Automate all business processes'
    ],
    correctAnswer: 1,
    explanation: 'ITGCs support the effective operation of application controls. If ITGCs are weak, application controls may not be reliable even if designed correctly.',
    reference: 'COSO, AS 2110',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-gap-v-019',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'IT Audit',
    topicId: 'testing-basics',
    topic: 'IT General Controls',
    subtopic: 'Control Testing Basics',
    difficulty: 'easy',
    question: 'When testing IT controls, auditors select a sample of transactions to:',
    options: [
      'Avoid looking at all transactions because it takes too long',
      'Obtain evidence about whether controls operated effectively throughout the period',
      'Only test controls that failed in prior periods',
      'Focus exclusively on controls over cash'
    ],
    correctAnswer: 1,
    explanation: 'Auditors test samples to obtain sufficient appropriate evidence about whether controls operated effectively throughout the audit period. Sample size depends on assessed risk and control frequency.',
    reference: 'AU-C 330, AS 2301',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-gap-v-020',
    section: 'ISC',
    blueprintArea: 'ISC-V',
    blueprintGroup: 'SOC Engagements',
    topicId: 'soc-period',
    topic: 'SOC Reports',
    subtopic: 'Report Period',
    difficulty: 'easy',
    question: 'A SOC 2 Type 2 report typically covers a period of:',
    options: [
      'A single point in time',
      'At least 6 months',
      'Exactly 1 year',
      'At least 3 years'
    ],
    correctAnswer: 1,
    explanation: 'SOC 2 Type 2 reports cover a period of time (typically 6 to 12 months) during which controls are tested for operating effectiveness. Type 1 reports cover a single point in time.',
    reference: 'AT-C 205',
    skillLevel: 'Remembering',
  },
];

// Combined exports
export const BLUEPRINT_GAP_QUESTIONS: Question[] = [
  ...AUD_VII_GAP_QUESTIONS,
  ...ISC_V_GAP_QUESTIONS,
];

export default BLUEPRINT_GAP_QUESTIONS;
