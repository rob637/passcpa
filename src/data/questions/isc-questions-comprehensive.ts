// ISC - Information Systems & Controls Comprehensive Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Final batch

import { Question } from '../../types';

export const ISC_QUESTIONS_COMPREHENSIVE: Question[] = [
  {
    id: 'isc-comp-001',
    section: 'ISC',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'Database Normalization',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'Third normal form (3NF) eliminates:',
    options: [
      'Repeating groups',
      'Transitive dependencies where non-key attributes depend on other non-key attributes',
      'All redundancy',
      'Primary keys',
    ],
    correctAnswer: 1,
    explanation: '3NF: no transitive dependencies. Non-key attributes must depend ONLY on the primary key, not on other non-key attributes. 1NF = no repeating groups. 2NF = no partial dependencies. 3NF reduces update anomalies.',
    reference: 'Database Design - Normalization',
  },
  {
    id: 'isc-comp-002',
    section: 'ISC',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'ERP Implementation',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Evaluation',
    question: 'The "big bang" approach to ERP implementation:',
    options: [
      'Implements modules gradually',
      'Replaces all legacy systems simultaneously across the organization',
      'Uses parallel processing indefinitely',
      'Avoids customization',
    ],
    correctAnswer: 1,
    explanation: 'Big bang: full implementation at once. Higher risk but faster realization of benefits. Alternative approaches: phased (by module/location), parallel (run both systems), pilot (test site first). Risk factors: complexity, change management.',
    reference: 'ERP Implementation Strategies',
  },
  {
    id: 'isc-comp-003',
    section: 'ISC',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'DevOps',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'DevOps practices integrate:',
    options: [
      'Only development activities',
      'Development and operations teams for continuous integration, delivery, and deployment',
      'Hardware only',
      'End user support only',
    ],
    correctAnswer: 1,
    explanation: 'DevOps: culture/practice merging development and operations. Continuous integration (CI), continuous delivery (CD), automated testing, infrastructure as code, monitoring. Faster delivery, improved collaboration, reduced silos.',
    reference: 'DevOps Practices',
  },
  {
    id: 'isc-comp-004',
    section: 'ISC',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Change Management',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'Effective IT change management should include:',
    options: [
      'Immediate implementation without approval',
      'Request, impact assessment, approval, testing, implementation, and documentation',
      'Only programmer changes',
      'Monthly reviews only',
    ],
    correctAnswer: 1,
    explanation: 'Change management: (1) formal request, (2) impact/risk assessment, (3) appropriate approval, (4) testing, (5) scheduled implementation, (6) back-out plan, (7) documentation, (8) post-implementation review. Prevents unauthorized changes.',
    reference: 'ITIL Change Management',
  },
  {
    id: 'isc-comp-005',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Cybersecurity',
    subtopic: 'Zero Trust Architecture',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Zero Trust security architecture operates on the principle:',
    options: [
      'Trust internal networks',
      'Never trust, always verify - assume breach and verify explicitly regardless of location',
      'Trust verified users',
      'Perimeter security is sufficient',
    ],
    correctAnswer: 1,
    explanation: 'Zero Trust: "never trust, always verify." No implicit trust based on network location. Principles: verify explicitly, least privilege access, assume breach. Micro-segmentation, MFA, continuous validation, encrypt everything.',
    reference: 'Zero Trust Architecture - NIST SP 800-207',
  },
  {
    id: 'isc-comp-006',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Cybersecurity',
    subtopic: 'Penetration Testing',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Black box penetration testing means:',
    options: [
      'Tester has full system knowledge',
      'Tester has no prior knowledge of the target system, simulating external attacker',
      'Testing is automated only',
      'Testing internal threats only',
    ],
    correctAnswer: 1,
    explanation: 'Black box: no prior knowledge (external attacker simulation). White box: full knowledge (source code, architecture). Gray box: partial knowledge (user-level access). Each has different use cases and cost/time implications.',
    reference: 'Penetration Testing Methodologies',
  },
  {
    id: 'isc-comp-007',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Cryptography',
    subtopic: 'Digital Certificates',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'A digital certificate binds:',
    options: [
      'Two passwords together',
      'A public key to an identity, verified by a trusted certificate authority',
      'Private keys to users',
      'Encryption algorithms',
    ],
    correctAnswer: 1,
    explanation: 'Digital certificate: contains public key + identity information, signed by CA. X.509 standard format. Chain of trust: root CA → intermediate CA → end entity. Certificate contains: public key, subject name, issuer, validity period, signature.',
    reference: 'PKI - Digital Certificates',
  },
  {
    id: 'isc-comp-008',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Network Security',
    subtopic: 'SIEM',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'A Security Information and Event Management (SIEM) system:',
    options: [
      'Only stores logs',
      'Aggregates and analyzes security data from multiple sources for real-time threat detection',
      'Manages user passwords',
      'Encrypts network traffic',
    ],
    correctAnswer: 1,
    explanation: 'SIEM: collect logs from multiple sources, normalize data, correlate events, real-time analysis, alerting, reporting, forensic investigation support. Key for security monitoring and incident detection. Requires tuning to reduce false positives.',
    reference: 'SIEM Solutions',
  },
  {
    id: 'isc-comp-009',
    section: 'ISC',
    topicId: 'isc-controls',
    topic: 'IT Controls',
    subtopic: 'Segregation of Duties',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'IT segregation of duties should separate:',
    options: [
      'All IT functions',
      'Development, operations, and security administration to prevent unauthorized changes or fraud',
      'Programming languages only',
      'Hardware and software',
    ],
    correctAnswer: 1,
    explanation: 'IT SoD: separate conflicting duties. Key separations: development vs. production, operations vs. security admin, DBA vs. users, change approval vs. implementation. Compensating controls if separation impractical (small IT shops).',
    reference: 'IT Controls - SoD',
  },
  {
    id: 'isc-comp-010',
    section: 'ISC',
    topicId: 'isc-controls',
    topic: 'IT General Controls',
    subtopic: 'Access Reviews',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Application',
    question: 'Periodic access reviews should:',
    options: [
      'Be performed by IT only',
      'Have data owners verify appropriateness of user access rights on a regular basis',
      'Occur only at year-end',
      'Focus on new employees only',
    ],
    correctAnswer: 1,
    explanation: 'Access reviews: data owners review and certify appropriateness of access. Frequency based on risk. Review terminated employees, transfers, privilege changes. Detect access creep. Document reviews and remediation.',
    reference: 'Access Control - User Access Reviews',
  },
  {
    id: 'isc-comp-011',
    section: 'ISC',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Subject Rights',
    difficulty: 'hard',
    blueprintArea: 'ISC-IV',
    skillLevel: 'Analysis',
    question: 'Under GDPR, data subjects have the right to:',
    options: [
      'Unlimited data storage',
      'Access, rectification, erasure, restriction, portability, and objection to processing',
      'Control other people\'s data',
      'Avoid all data collection',
    ],
    correctAnswer: 1,
    explanation: 'GDPR data subject rights: access, rectification, erasure (right to be forgotten), restrict processing, data portability, object to processing, not be subject to automated decision-making. Organizations must respond within 1 month.',
    reference: 'GDPR Articles 15-22',
  },
  {
    id: 'isc-comp-012',
    section: 'ISC',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Data Minimization',
    difficulty: 'medium',
    blueprintArea: 'ISC-IV',
    skillLevel: 'Application',
    question: 'Data minimization requires organizations to:',
    options: [
      'Collect all available data',
      'Collect only data that is adequate, relevant, and limited to what is necessary',
      'Delete all data immediately',
      'Encrypt everything',
    ],
    correctAnswer: 1,
    explanation: 'Data minimization: core privacy principle. Collect minimum necessary for stated purpose. Also implies retention limits - don\'t keep longer than necessary. Reduces risk from breaches. GDPR Article 5(1)(c).',
    reference: 'Privacy Principles - Data Minimization',
  },
  {
    id: 'isc-comp-013',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'SOC 2 Trust Services Criteria',
    difficulty: 'hard',
    blueprintArea: 'ISC-V',
    skillLevel: 'Analysis',
    question: 'The SOC 2 Trust Services Criteria include:',
    options: [
      'Financial reporting controls only',
      'Security, availability, processing integrity, confidentiality, and privacy',
      'Marketing effectiveness',
      'Employee satisfaction',
    ],
    correctAnswer: 1,
    explanation: 'SOC 2 TSC: (1) Security (mandatory), (2) Availability, (3) Processing integrity, (4) Confidentiality, (5) Privacy. Organization selects criteria. Security (common criteria) required. Focus on operational controls.',
    reference: 'AICPA SOC 2 - Trust Services Criteria',
  },
  {
    id: 'isc-comp-014',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'SOC 3',
    difficulty: 'medium',
    blueprintArea: 'ISC-V',
    skillLevel: 'Application',
    question: 'A SOC 3 report differs from SOC 2 by:',
    options: [
      'Being more detailed',
      'Being a general use report suitable for public distribution without detailed control descriptions',
      'Covering financial reporting',
      'Being restricted use',
    ],
    correctAnswer: 1,
    explanation: 'SOC 3: general use, publicly distributable, same scope as SOC 2 but without detailed control descriptions or test results. Used for marketing, website display. SOC 2 is restricted use (specified parties).',
    reference: 'AICPA SOC 3 Reports',
  },
  {
    id: 'isc-comp-015',
    section: 'ISC',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Smart Contracts',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Analysis',
    question: 'Smart contracts on blockchain:',
    options: [
      'Replace legal contracts entirely',
      'Self-execute when predefined conditions are met, with terms directly written into code',
      'Require manual approval',
      'Are easily modified',
    ],
    correctAnswer: 1,
    explanation: 'Smart contracts: code that auto-executes when conditions met. Stored on blockchain (immutable). Benefits: automation, trust, transparency, efficiency. Risks: bugs are permanent, oracle dependency, legal enforceability questions.',
    reference: 'Blockchain - Smart Contracts',
  },
  {
    id: 'isc-comp-016',
    section: 'ISC',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Machine Learning Governance',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Evaluation',
    question: 'AI/ML governance should address:',
    options: [
      'Technical performance only',
      'Bias, explainability, data quality, model risk, ethics, and regulatory compliance',
      'Cost only',
      'Speed of processing',
    ],
    correctAnswer: 1,
    explanation: 'ML governance: model validation, bias detection/mitigation, explainability (black box concern), data quality, drift monitoring, ethical use, regulatory compliance (fair lending, etc.), documentation, accountability.',
    reference: 'AI/ML Governance',
  },
  {
    id: 'isc-comp-017',
    section: 'ISC',
    topicId: 'isc-emerging',
    topic: 'Cloud Computing',
    subtopic: 'Cloud Security',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Analysis',
    question: 'In the cloud shared responsibility model, the customer is always responsible for:',
    options: [
      'Physical security',
      'Data classification, access management, and configuration of customer-controlled resources',
      'Network infrastructure',
      'Hypervisor security',
    ],
    correctAnswer: 1,
    explanation: 'Shared responsibility: cloud provider secures infrastructure. Customer always responsible for: data classification, IAM, application security, OS patching (IaaS), configuration. Varies by service model (IaaS/PaaS/SaaS).',
    reference: 'Cloud Security - Shared Responsibility',
  },
  {
    id: 'isc-comp-018',
    section: 'ISC',
    topicId: 'isc-bcp',
    topic: 'Business Continuity',
    subtopic: 'RTO and RPO',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Recovery Point Objective (RPO) defines:',
    options: [
      'How fast to recover',
      'Maximum acceptable data loss measured in time - how far back to restore',
      'Recovery cost',
      'Testing frequency',
    ],
    correctAnswer: 1,
    explanation: 'RPO: maximum data loss tolerance (time). Drives backup frequency. RPO = 1 hour means backup at least hourly. RTO = maximum downtime tolerable. Both drive BCP/DR strategy and investment.',
    reference: 'Business Continuity - RPO/RTO',
  },
  {
    id: 'isc-comp-019',
    section: 'ISC',
    topicId: 'isc-bcp',
    topic: 'Disaster Recovery',
    subtopic: 'DR Site Types',
    difficulty: 'medium',
    blueprintArea: 'ISC-III',
    skillLevel: 'Application',
    question: 'A warm site provides:',
    options: [
      'No equipment',
      'Pre-installed hardware and connectivity but requires data restoration from backups',
      'Full real-time data replication',
      'Empty building only',
    ],
    correctAnswer: 1,
    explanation: 'DR sites: Cold = building/power, no equipment. Warm = hardware installed, needs data. Hot = fully operational, real-time replication. Trade-off: cost vs. recovery time. Hot site most expensive, fastest recovery.',
    reference: 'Disaster Recovery Sites',
  },
  {
    id: 'isc-comp-020',
    section: 'ISC',
    topicId: 'isc-frameworks',
    topic: 'Control Frameworks',
    subtopic: 'COBIT',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'COBIT 2019 governance objectives include:',
    options: [
      'Technical specifications only',
      'Evaluate, Direct, and Monitor (EDM) covering IT governance alignment with enterprise goals',
      'Programming standards',
      'Hardware requirements',
    ],
    correctAnswer: 1,
    explanation: 'COBIT 2019: IT governance framework. Governance objectives: Evaluate, Direct, Monitor. Management objectives: APO (Align, Plan, Organize), BAI (Build, Acquire, Implement), DSS (Deliver, Service, Support), MEA (Monitor, Evaluate, Assess).',
    reference: 'COBIT 2019 Framework',
  },
  {
    id: 'isc-comp-021',
    section: 'ISC',
    topicId: 'isc-frameworks',
    topic: 'Control Frameworks',
    subtopic: 'NIST CSF',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'The NIST Cybersecurity Framework core functions are:',
    options: [
      'Plan, Do, Check, Act',
      'Identify, Protect, Detect, Respond, Recover',
      'Security, Availability, Integrity',
      'Design, Implement, Test',
    ],
    correctAnswer: 1,
    explanation: 'NIST CSF core: Identify (asset management, risk), Protect (access, training, maintenance), Detect (monitoring, anomalies), Respond (planning, communications, mitigation), Recover (planning, improvements). Widely adopted.',
    reference: 'NIST Cybersecurity Framework',
  },
  {
    id: 'isc-comp-022',
    section: 'ISC',
    topicId: 'isc-audit',
    topic: 'IT Audit',
    subtopic: 'CAATs',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Computer-assisted audit techniques (CAATs) include:',
    options: [
      'Manual testing only',
      'Test data, integrated test facility, parallel simulation, and data analytics',
      'Interviewing users',
      'Observation only',
    ],
    correctAnswer: 1,
    explanation: 'CAATs: test data (dummy transactions), ITF (embed test in live system), parallel simulation (auditor program processes live data), generalized audit software, embedded audit modules, data analytics. Efficient for large volumes.',
    reference: 'IT Audit - CAATs',
  },
  {
    id: 'isc-comp-023',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Incident Response',
    subtopic: 'IR Phases',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'The incident response lifecycle includes:',
    options: [
      'Detection and removal only',
      'Preparation, detection/analysis, containment/eradication/recovery, and post-incident activity',
      'Notification only',
      'Insurance claims',
    ],
    correctAnswer: 1,
    explanation: 'NIST IR phases: (1) Preparation (plans, tools, training), (2) Detection & Analysis (identify, validate, prioritize), (3) Containment, Eradication, Recovery (stop spread, remove threat, restore), (4) Post-incident (lessons learned).',
    reference: 'NIST SP 800-61 - Incident Response',
  },
  {
    id: 'isc-comp-024',
    section: 'ISC',
    topicId: 'isc-data',
    topic: 'Data Management',
    subtopic: 'Data Lake vs Warehouse',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'A data lake differs from a data warehouse by:',
    options: [
      'Being smaller',
      'Storing raw data in native format (schema-on-read) rather than structured, transformed data (schema-on-write)',
      'Having faster queries',
      'Requiring less storage',
    ],
    correctAnswer: 1,
    explanation: 'Data lake: raw data, multiple formats, schema-on-read, flexible, good for data science/exploration. Data warehouse: structured, cleaned, schema-on-write, optimized for BI/reporting. Often used together (lakehouse architecture).',
    reference: 'Data Architecture - Lake vs Warehouse',
  },
  {
    id: 'isc-comp-025',
    section: 'ISC',
    topicId: 'isc-automation',
    topic: 'Process Automation',
    subtopic: 'RPA Controls',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Analysis',
    question: 'Robotic Process Automation (RPA) introduces risks including:',
    options: [
      'Lower efficiency',
      'Bot credentials management, change control, error handling, and process dependency',
      'Increased manual errors',
      'Physical security only',
    ],
    correctAnswer: 1,
    explanation: 'RPA risks: credential/access management for bots, change control (process changes break bots), exception handling, governance, dependency on underlying systems, audit trail, segregation of duties around bot management.',
    reference: 'RPA Governance and Controls',
  },
];
