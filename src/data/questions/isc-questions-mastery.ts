// ISC - Information Systems Mastery Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Mastery batch

import { Question } from '../../types';

export const ISC_QUESTIONS_MASTERY: Question[] = [
  {
    id: 'isc-mast-001',
    section: 'ISC',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'Data Warehouse Architecture',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'The star schema in data warehouse design uses:',
    options: [
      'Highly normalized tables',
      'Flat files only',
      'Central fact table surrounded by denormalized dimension tables',
      'Linked lists'
    ],
    correctAnswer: 2,
    explanation: 'Star schema: central fact table (measures, foreign keys) surrounded by dimension tables (descriptive attributes). Denormalized for query performance. Snowflake schema normalizes dimensions further. Fact tables can be very large.',
    reference: 'Data Warehouse - Dimensional Modeling',
  },
  {
    id: 'isc-mast-002',
    section: 'ISC',
    topicId: 'isc-systems',
    topic: 'Information Systems',
    subtopic: 'API Security',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'API security best practices include:',
    options: [
      'Authentication (OAuth/API keys), rate limiting, input validation, encryption, and logging',
      'Open access for flexibility',
      'Password sharing',
      'Disabling HTTPS'
    ],
    correctAnswer: 0,
    explanation: 'API security: authentication (OAuth 2.0, API keys), authorization, rate limiting/throttling, input validation (prevent injection), TLS/HTTPS, comprehensive logging, API gateway, versioning, least privilege.',
    reference: 'API Security Best Practices',
  },
  {
    id: 'isc-mast-003',
    section: 'ISC',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Agile Scrum',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
    question: 'In Scrum methodology, the Sprint Retrospective:',
    options: [
      'Reviews team processes to identify improvements for the next sprint',
      'Demonstrates completed work',
      'Plans sprint backlog',
      'Gathers requirements'
    ],
    correctAnswer: 0,
    explanation: 'Sprint Retrospective: team reflects on sprint - what went well, what to improve, action items. After Sprint Review. Sprint ceremonies: Planning, Daily Standup, Review (demo), Retrospective. Continuous improvement focus.',
    reference: 'Agile - Scrum Ceremonies',
  },
  {
    id: 'isc-mast-004',
    section: 'ISC',
    topicId: 'isc-sdlc',
    topic: 'Systems Development',
    subtopic: 'Version Control',
    difficulty: 'hard',
    blueprintArea: 'ISC-I',
    skillLevel: 'Application',
    question: 'Version control systems provide:',
    options: [
      'Backup only',
      'Complete change history, branching, merging, collaboration, and ability to revert changes',
      'Encryption',
      'Testing automation',
    ],
    correctAnswer: 1,
    explanation: 'Version control (Git, etc.): track all changes, who/when/why, branching for parallel development, merging, revert to any point, collaboration, audit trail. Essential for SDLC. Supports DevOps practices.',
    reference: 'Software Development - Version Control',
  },
  {
    id: 'isc-mast-005',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Cybersecurity',
    subtopic: 'Endpoint Detection and Response',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Endpoint Detection and Response (EDR) solutions:',
    options: [
      'Replace antivirus entirely',
      'Manage patches',
      'Only scan for viruses',
      'Continuously monitor endpoints for threats, provide behavioral analysis, and enable rapid response'
    ],
    correctAnswer: 3,
    explanation: 'EDR: continuous endpoint monitoring, behavioral analysis (not just signatures), threat detection, investigation capabilities, response actions (isolate, remediate). Advanced from traditional AV. Part of defense in depth.',
    reference: 'Endpoint Security - EDR',
  },
  {
    id: 'isc-mast-006',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Cybersecurity',
    subtopic: 'Social Engineering',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Evaluation',
    question: 'Spear phishing differs from regular phishing by:',
    options: [
      'Using malware',
      'Avoiding email',
      'Being less effective',
      'Targeting specific individuals with personalized, researched content'
    ],
    correctAnswer: 3,
    explanation: 'Spear phishing: highly targeted, uses personal information (name, role, colleagues, interests) for credibility. More dangerous than mass phishing. Whaling targets executives specifically. Defense: training, email filtering, MFA.',
    reference: 'Social Engineering - Phishing Types',
  },
  {
    id: 'isc-mast-007',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Cryptography',
    subtopic: 'Key Management',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Effective cryptographic key management includes:',
    options: [
      'Storing keys with data',
      'Using same key forever',
      'Secure generation, storage, distribution, rotation, revocation, and destruction of keys',
      'Sharing keys openly'
    ],
    correctAnswer: 2,
    explanation: 'Key management lifecycle: generation (secure random), storage (HSM, vault), distribution (secure channel), usage (access control), rotation (periodic change), revocation (compromise), destruction (secure erase). Keys separate from data.',
    reference: 'Cryptography - Key Management',
  },
  {
    id: 'isc-mast-008',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Network Security',
    subtopic: 'DDoS Mitigation',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'DDoS attack mitigation strategies include:',
    options: [
      'Ignoring the attack',
      'Increasing bandwidth only',
      'Rate limiting, traffic filtering, CDN distribution, and scrubbing centers',
      'Reducing services'
    ],
    correctAnswer: 2,
    explanation: 'DDoS mitigation: rate limiting, IP blocking, traffic analysis/filtering, Anycast CDN distribution, cloud-based scrubbing centers, over-provisioning, WAF rules, BGP Flowspec. Layered defense necessary.',
    reference: 'Network Security - DDoS Protection',
  },
  {
    id: 'isc-mast-009',
    section: 'ISC',
    topicId: 'isc-controls',
    topic: 'IT Controls',
    subtopic: 'Automated Controls',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Automated controls are generally more reliable because:',
    options: [
      'They cost less',
      'They operate consistently without human variability when properly programmed and tested',
      'They never fail',
      'They don\'t need testing',
    ],
    correctAnswer: 1,
    explanation: 'Automated controls: consistent execution, no fatigue/distraction, operate every transaction, efficient. BUT: depend on proper programming, need testing, depend on ITGCs. Still need periodic validation. One test may suffice if ITGCs strong.',
    reference: 'IT Controls - Automated vs Manual',
  },
  {
    id: 'isc-mast-010',
    section: 'ISC',
    topicId: 'isc-controls',
    topic: 'IT General Controls',
    subtopic: 'Privileged Access',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Evaluation',
    question: 'Privileged access management (PAM) should include:',
    options: [
      'Shared admin accounts',
      'Self-service password reset only',
      'Permanent admin rights',
      'Just-in-time access, session recording, credential vaulting, and least privilege enforcement'
    ],
    correctAnswer: 3,
    explanation: 'PAM: credential vaulting (no standing passwords), just-in-time elevation, session recording, least privilege, approval workflows, automatic password rotation, separation of duties for admin functions. Critical for security.',
    reference: 'Access Control - Privileged Access',
  },
  {
    id: 'isc-mast-011',
    section: 'ISC',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'CCPA Rights',
    difficulty: 'hard',
    blueprintArea: 'ISC-IV',
    skillLevel: 'Application',
    question: 'Under the California Consumer Privacy Act (CCPA/CPRA), consumers have:',
    options: [
      'Limited rights',
      'Rights to know, delete, opt-out of sale, and non-discrimination for exercising rights',
      'No privacy rights',
      'Only deletion rights',
    ],
    correctAnswer: 1,
    explanation: 'CCPA/CPRA rights: know what personal info collected, delete personal info, opt-out of sale/sharing, non-discrimination, correct inaccurate info, limit use of sensitive info. Applies to businesses meeting thresholds.',
    reference: 'CCPA/CPRA Consumer Rights',
  },
  {
    id: 'isc-mast-012',
    section: 'ISC',
    topicId: 'isc-privacy',
    topic: 'Data Privacy',
    subtopic: 'Privacy Impact Assessment',
    difficulty: 'hard',
    blueprintArea: 'ISC-IV',
    skillLevel: 'Analysis',
    question: 'A Privacy Impact Assessment (PIA) should be conducted:',
    options: [
      'Before implementing new systems or processes that collect or process personal data',
      'Only after breach',
      'Annually only',
      'Never'
    ],
    correctAnswer: 0,
    explanation: 'PIA: assess privacy risks before new system/process implementation. Identify: data collected, purposes, risks, mitigations. GDPR requires Data Protection Impact Assessment (DPIA) for high-risk processing. Document and review.',
    reference: 'Privacy - Impact Assessments',
  },
  {
    id: 'isc-mast-013',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'Complementary User Entity Controls',
    difficulty: 'hard',
    blueprintArea: 'ISC-V',
    skillLevel: 'Evaluation',
    question: 'Complementary User Entity Controls (CUECs) in SOC reports:',
    options: [
      'Are tested by service auditor',
      'Are controls the user organization must implement for service organization controls to be effective',
      'Replace service organization controls',
      'Are optional',
    ],
    correctAnswer: 1,
    explanation: 'CUECs: controls service organization assumes user implements. Listed in SOC report. User auditor must evaluate if user implemented CUECs. Examples: user access reviews, input validation, output reconciliation. Critical for reliance.',
    reference: 'SOC Reports - CUECs',
  },
  {
    id: 'isc-mast-014',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Reporting',
    subtopic: 'SOC for Cybersecurity',
    difficulty: 'hard',
    blueprintArea: 'ISC-V',
    skillLevel: 'Analysis',
    question: 'SOC for Cybersecurity reports focus on:',
    options: [
      'Organization-wide cybersecurity risk management program effectiveness',
      'Financial controls only',
      'Individual transactions',
      'Compliance with tax laws'
    ],
    correctAnswer: 0,
    explanation: 'SOC for Cybersecurity: organization-wide exam of cybersecurity risk management program. Uses AICPA description criteria. Evaluates design and effectiveness. Voluntary. Broader than SOC 2. Useful for board, management, stakeholders.',
    reference: 'AICPA SOC for Cybersecurity',
  },
  {
    id: 'isc-mast-015',
    section: 'ISC',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'Quantum Computing Impact',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Evaluation',
    question: 'Quantum computing poses a threat to:',
    options: [
      'Current public key cryptography like RSA and ECC when sufficiently powerful',
      'All computing',
      'Symmetric encryption only',
      'Hardware only'
    ],
    correctAnswer: 0,
    explanation: 'Quantum threat: Shor\'s algorithm can factor large numbers efficiently, breaking RSA/ECC public key crypto. Timeline uncertain but "harvest now, decrypt later" risk exists. Post-quantum cryptography standards being developed (NIST).',
    reference: 'Quantum Computing - Cryptography Impact',
  },
  {
    id: 'isc-mast-016',
    section: 'ISC',
    topicId: 'isc-emerging',
    topic: 'Emerging Technologies',
    subtopic: 'IoT Security',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Analysis',
    question: 'IoT security challenges include:',
    options: [
      'Limited resources for security, default credentials, lack of updates, and massive attack surface',
      'Too much processing power',
      'Easy patching',
      'Strong authentication'
    ],
    correctAnswer: 0,
    explanation: 'IoT challenges: constrained devices (limited CPU/memory for security), default credentials, infrequent updates, long lifespans, heterogeneous systems, massive scale, physical access risk. Need: network segmentation, monitoring, secure defaults.',
    reference: 'IoT Security Challenges',
  },
  {
    id: 'isc-mast-017',
    section: 'ISC',
    topicId: 'isc-emerging',
    topic: 'Cloud Computing',
    subtopic: 'Multi-Cloud Strategy',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Evaluation',
    question: 'Benefits of multi-cloud strategy include:',
    options: [
      'Simplified management',
      'Lower costs always',
      'Avoiding vendor lock-in, leveraging best-of-breed services, and improving resilience',
      'Less complexity'
    ],
    correctAnswer: 2,
    explanation: 'Multi-cloud benefits: avoid lock-in, use best services from each provider, regulatory compliance (data residency), disaster recovery, negotiating leverage. Challenges: complexity, skill requirements, data integration, security consistency.',
    reference: 'Cloud Strategy - Multi-Cloud',
  },
  {
    id: 'isc-mast-018',
    section: 'ISC',
    topicId: 'isc-bcp',
    topic: 'Business Continuity',
    subtopic: 'BIA Components',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'A Business Impact Analysis (BIA) identifies:',
    options: [
      'Critical processes, dependencies, recovery priorities, and acceptable downtime/data loss',
      'Technical solutions only',
      'Vendor contracts',
      'Insurance needs only'
    ],
    correctAnswer: 0,
    explanation: 'BIA: identify critical business processes, dependencies (systems, people, vendors), impact of disruption over time, recovery time objectives (RTO), recovery point objectives (RPO), resource requirements. Foundation for BCP/DR planning.',
    reference: 'Business Continuity - BIA',
  },
  {
    id: 'isc-mast-019',
    section: 'ISC',
    topicId: 'isc-bcp',
    topic: 'Disaster Recovery',
    subtopic: 'DR Testing',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'DR plan testing methods include:',
    options: [
      'Only documentation review',
      'Production testing only',
      'Tabletop exercises, walkthrough tests, simulation tests, parallel tests, and full interruption tests',
      'No testing needed'
    ],
    correctAnswer: 2,
    explanation: 'DR testing progression: checklist/documentation review, tabletop exercise (discussion), walkthrough (step-by-step), simulation (mock disaster), parallel (recover to DR site while production runs), full interruption (actual switchover). Regular testing essential.',
    reference: 'Disaster Recovery Testing',
  },
  {
    id: 'isc-mast-020',
    section: 'ISC',
    topicId: 'isc-frameworks',
    topic: 'Control Frameworks',
    subtopic: 'ISO 27001',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'ISO 27001 certification requires:',
    options: [
      'Self-assessment only',
      'Buying software',
      'Implementing an Information Security Management System with risk assessment and controls, verified by external audit',
      'Training only'
    ],
    correctAnswer: 2,
    explanation: 'ISO 27001: ISMS framework. Requires: risk assessment, risk treatment, statement of applicability (Annex A controls), documentation, management review, internal audit, external certification audit. 3-year certification cycle.',
    reference: 'ISO/IEC 27001',
  },
  {
    id: 'isc-mast-021',
    section: 'ISC',
    topicId: 'isc-audit',
    topic: 'IT Audit',
    subtopic: 'Data Analytics in Audit',
    difficulty: 'hard',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
    question: 'Using data analytics in IT audit enables:',
    options: [
      'Smaller sample sizes only',
      'Reducing documentation',
      'Eliminating all manual work',
      'Full population testing, anomaly detection, pattern recognition, and continuous monitoring'
    ],
    correctAnswer: 3,
    explanation: 'Audit analytics: 100% population testing, identify anomalies/outliers, pattern/trend analysis, continuous auditing/monitoring, risk assessment enhancement, fraud detection. Tools: ACL, IDEA, SQL, Python. Requires data quality.',
    reference: 'IT Audit - Data Analytics',
  },
  {
    id: 'isc-mast-022',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Security Operations',
    subtopic: 'Security Metrics',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Evaluation',
    question: 'Effective security metrics should measure:',
    options: [
      'Number of firewalls',
      'Number of employees',
      'IT budget only',
      'Mean time to detect/respond, patch compliance, incident trends, vulnerability remediation time, and risk reduction'
    ],
    correctAnswer: 3,
    explanation: 'Security metrics: MTTD (mean time to detect), MTTR (mean time to respond/remediate), patch compliance %, vulnerability aging, phishing click rates, incident volume/severity trends, control effectiveness. Align with business risk.',
    reference: 'Security Metrics and KPIs',
  },
  {
    id: 'isc-mast-023',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Incident Response',
    subtopic: 'Evidence Preservation',
    difficulty: 'hard',
    blueprintArea: 'ISC-II',
    skillLevel: 'Analysis',
    question: 'Digital forensic evidence preservation requires:',
    options: [
      'Quick deletion',
      'Ignoring logs',
      'Immediate system restart',
      'Chain of custody documentation, forensic imaging, write blockers, and hash verification'
    ],
    correctAnswer: 3,
    explanation: 'Evidence preservation: maintain chain of custody (document who/when/what), use write blockers, create forensic images (bit-by-bit copy), hash verification (integrity), preserve logs, document everything. Critical for legal proceedings.',
    reference: 'Digital Forensics - Evidence Handling',
  },
  {
    id: 'isc-mast-024',
    section: 'ISC',
    topicId: 'isc-data',
    topic: 'Data Governance',
    subtopic: 'Data Classification',
    difficulty: 'hard',
    blueprintArea: 'ISC-IV',
    skillLevel: 'Analysis',
    question: 'Data classification schemes typically include:',
    options: [
      'Random categories',
      'Public, internal, confidential, and restricted/highly confidential levels based on sensitivity and impact',
      'Only two levels',
      'Technical specifications',
    ],
    correctAnswer: 1,
    explanation: 'Classification levels: Public (no restriction), Internal (business use), Confidential (sensitive, limited access), Restricted/Top Secret (highest sensitivity). Drives: access controls, encryption requirements, handling procedures, retention.',
    reference: 'Data Governance - Classification',
  },
  {
    id: 'isc-mast-025',
    section: 'ISC',
    topicId: 'isc-automation',
    topic: 'Process Automation',
    subtopic: 'Intelligent Automation',
    difficulty: 'hard',
    blueprintArea: 'ISC-VI',
    skillLevel: 'Evaluation',
    question: 'Intelligent automation combines RPA with:',
    options: [
      'AI/ML capabilities for handling unstructured data and decision-making',
      'More manual processes',
      'Legacy systems only',
      'Reduced functionality'
    ],
    correctAnswer: 0,
    explanation: 'Intelligent automation: RPA + AI/ML. RPA handles structured, rule-based tasks. AI adds: document understanding (OCR, NLP), decision-making, learning from data, handling exceptions. Also called: cognitive automation, hyperautomation.',
    reference: 'Intelligent Automation',
  },
];
