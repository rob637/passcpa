// ISC - Information Systems and Controls Questions
// 2026 CPA Exam Blueprint Compliant
// Discipline section replacing parts of legacy BEC

import { Question } from '../../types';

export const ISC_QUESTIONS: Question[] = [
  // ==========================================
  // AREA I: Information Systems and Data Management (35-45%)
  // ==========================================

  {
    id: 'isc-dm-001',
    section: 'ISC',
    topicId: 'isc-database',
    topic: 'Database Management',
    subtopic: 'Relational Databases',
    difficulty: 'medium',
    question: 'Which of the following BEST describes referential integrity in a relational database?',
    options: [
      'Ensuring that all data is encrypted at rest',
      'Ensuring that foreign key values match existing primary key values',
      'Ensuring that all tables have a primary key defined',
      'Ensuring that database backups are performed regularly',
    ],
    correctAnswer: 1,
    explanation: 'Referential integrity ensures that relationships between tables remain consistent. A foreign key in one table must reference a valid primary key in another table, or be null. This prevents orphaned records.',
    reference: 'Database Fundamentals - ITGC',
    blueprintArea: 'ISC-I',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-dm-002',
    section: 'ISC',
    topicId: 'isc-database',
    topic: 'Database Management',
    subtopic: 'ACID Properties',
    difficulty: 'medium',
    question: 'The "Isolation" property of ACID database transactions ensures that:',
    options: [
      'Failed transactions are rolled back completely',
      'Concurrent transactions do not interfere with each other',
      'Committed data survives system crashes',
      'Database constraints are always enforced',
    ],
    correctAnswer: 1,
    explanation: 'Isolation ensures that concurrent transactions execute as if they were running sequentially. This prevents issues like dirty reads (reading uncommitted data) and phantom reads.',
    reference: 'ASC 718-10-30',
    blueprintArea: 'ISC-I',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-dm-003',
    section: 'ISC',
    topicId: 'isc-database',
    topic: 'Database Management',
    subtopic: 'Data Architecture',
    difficulty: 'hard',
    question: 'A company is evaluating database options for a new financial system. Which database type would be MOST appropriate for a general ledger requiring ACID compliance and complex queries across related tables?',
    options: [
      'Document-oriented NoSQL database',
      'Relational database management system (RDBMS)',
      'Key-value store',
      'Graph database',
    ],
    correctAnswer: 1,
    explanation: 'RDBMS (like Oracle, SQL Server, PostgreSQL) is ideal for financial systems requiring ACID compliance, referential integrity, and complex joins across related data. NoSQL databases sacrifice consistency for scalability.',
    reference: 'Database Architecture - ITGC',
    blueprintArea: 'ISC-I',
    skillLevel: 'Application',
  },
  {
    id: 'isc-dm-004',
    section: 'ISC',
    topicId: 'isc-data-management',
    topic: 'Data Management',
    subtopic: 'ETL Processes',
    difficulty: 'medium',
    question: 'In an ETL (Extract, Transform, Load) process, the "Transform" phase typically includes all of the following EXCEPT:',
    options: [
      'Data cleansing and validation',
      'Converting data formats between systems',
      'Applying business rules to calculate derived fields',
      'Creating database indexes for query optimization',
    ],
    correctAnswer: 3,
    explanation: 'Creating indexes is a database administration task performed after data is loaded, not during transformation. ETL Transform includes cleansing, format conversion, business rule application, and data standardization.',
    reference: 'Data Warehouse Concepts',
    blueprintArea: 'ISC-I',
    skillLevel: 'Application',
  },
  {
    id: 'isc-dm-005',
    section: 'ISC',
    topicId: 'isc-data-management',
    topic: 'Data Management',
    subtopic: 'Data Governance',
    difficulty: 'easy',
    question: 'Data governance PRIMARILY focuses on:',
    options: [
      'Installing and configuring database software',
      'Establishing policies and standards for data quality and usage',
      'Writing SQL queries for financial reports',
      'Backing up databases to offsite locations',
    ],
    correctAnswer: 1,
    explanation: 'Data governance establishes the policies, standards, and procedures for managing data as an organizational asset. It addresses data quality, security, privacy, and regulatory compliance.',
    reference: 'Data Governance Framework',
    blueprintArea: 'ISC-I',
    skillLevel: 'Remembering and Understanding',
  },

  // ==========================================
  // AREA II: Security, Confidentiality, and Privacy (35-45%)
  // ==========================================

  {
    id: 'isc-sec-001',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Access Controls',
    difficulty: 'medium',
    question: 'Which access control model assigns permissions based on job function rather than individual identity?',
    options: [
      'Discretionary Access Control (DAC)',
      'Mandatory Access Control (MAC)',
      'Role-Based Access Control (RBAC)',
      'Attribute-Based Access Control (ABAC)',
    ],
    correctAnswer: 2,
    explanation: 'RBAC assigns permissions to roles (e.g., "Accounts Payable Clerk"), and users are assigned to roles. This simplifies administration and enforces segregation of duties more effectively than user-level permissions.',
    reference: 'NIST Access Control Guidelines',
    blueprintArea: 'ISC-II',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-sec-002',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Authentication',
    difficulty: 'easy',
    question: 'Multi-factor authentication requires verification using factors from at least two of which categories?',
    options: [
      'Username, password, and security question',
      'Something you know, something you have, something you are',
      'Primary password and secondary password',
      'Fingerprint and retinal scan',
    ],
    correctAnswer: 1,
    explanation: 'MFA requires factors from different categories: Knowledge (passwords, PINs), Possession (tokens, phones), and Inherence (biometrics). Two passwords are both "something you know" - single factor.',
    reference: 'NIST SP 800-63B',
    blueprintArea: 'ISC-II',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-sec-003',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Encryption',
    difficulty: 'hard',
    question: 'A company transmits sensitive financial data between locations. Which encryption approach provides BOTH confidentiality during transmission AND verification that data was not altered?',
    options: [
      'Symmetric encryption only',
      'Hashing only',
      'Digital signatures with encryption',
      'Transport Layer Security (TLS) with certificate validation',
    ],
    correctAnswer: 3,
    explanation: 'TLS provides confidentiality (encryption), integrity (message authentication codes), and authentication (certificates). Digital signatures alone verify integrity and sender but don\'t encrypt the payload.',
    reference: 'NIST Cryptographic Standards',
    blueprintArea: 'ISC-II',
    skillLevel: 'Application',
  },
  {
    id: 'isc-sec-004',
    section: 'ISC',
    topicId: 'isc-security',
    topic: 'Information Security',
    subtopic: 'Vulnerability Management',
    difficulty: 'medium',
    question: 'Which of the following is the MOST effective control to protect against known software vulnerabilities?',
    options: [
      'Installing antivirus software',
      'Implementing a firewall',
      'Applying security patches promptly',
      'Encrypting all stored data',
    ],
    correctAnswer: 2,
    explanation: 'Patch management addresses known vulnerabilities at their source. Firewalls and antivirus provide defense-in-depth but cannot protect against vulnerabilities in unpatched software that bypasses those controls.',
    reference: 'NIST Vulnerability Management',
    blueprintArea: 'ISC-II',
    skillLevel: 'Application',
  },
  {
    id: 'isc-sec-005',
    section: 'ISC',
    topicId: 'isc-privacy',
    topic: 'Privacy and Confidentiality',
    subtopic: 'Privacy Principles',
    difficulty: 'medium',
    question: 'Under Generally Accepted Privacy Principles (GAPP), the "Use, Retention, and Disposal" principle requires that personal information:',
    options: [
      'Be collected only with explicit written consent',
      'Be used only for the purposes for which it was collected',
      'Be encrypted at all times',
      'Be stored in a domestic data center',
    ],
    correctAnswer: 1,
    explanation: 'GAPP\'s Use principle limits use of personal information to disclosed purposes. Retention requires keeping data only as long as needed. Disposal requires secure destruction when no longer required.',
    reference: 'AICPA GAPP',
    blueprintArea: 'ISC-II',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-sec-006',
    section: 'ISC',
    topicId: 'isc-privacy',
    topic: 'Privacy and Confidentiality',
    subtopic: 'Data Classification',
    difficulty: 'easy',
    question: 'A data classification policy PRIMARILY helps an organization:',
    options: [
      'Reduce the total amount of data stored',
      'Apply appropriate security controls based on data sensitivity',
      'Improve database query performance',
      'Comply with accounting standards',
    ],
    correctAnswer: 1,
    explanation: 'Data classification (e.g., Public, Internal, Confidential, Restricted) enables risk-based security. More sensitive data receives stronger controls, optimizing security investment while ensuring adequate protection.',
    reference: 'Data Classification Standards',
    blueprintArea: 'ISC-II',
    skillLevel: 'Remembering and Understanding',
  },

  // ==========================================
  // AREA III: SOC Engagements (15-25%)
  // ==========================================

  {
    id: 'isc-soc-001',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Engagements',
    subtopic: 'SOC Report Types',
    difficulty: 'medium',
    question: 'A SOC 2 Type 2 report differs from a SOC 2 Type 1 report in that the Type 2 report:',
    options: [
      'Covers more Trust Services Criteria',
      'Is restricted to fewer users',
      'Tests operating effectiveness of controls over a period of time',
      'Is performed by a different type of auditor',
    ],
    correctAnswer: 2,
    explanation: 'Type 1 reports on control design at a point in time. Type 2 tests operating effectiveness over a period (typically 6-12 months), providing greater assurance that controls function consistently.',
    reference: 'AICPA SOC Guidance',
    blueprintArea: 'ISC-III',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-soc-002',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Engagements',
    subtopic: 'Trust Services Criteria',
    difficulty: 'hard',
    question: 'A cloud hosting provider wants a report to provide to any prospective customer. The company wants to demonstrate controls over availability and security. Which report type is MOST appropriate?',
    options: [
      'SOC 1 Type 2',
      'SOC 2 Type 2',
      'SOC 3',
      'SOC for Cybersecurity',
    ],
    correctAnswer: 2,
    explanation: 'SOC 3 is a general-use report (unrestricted distribution) that provides a summary opinion on Trust Services Criteria. SOC 2 has the detail but is restricted use. SOC 1 focuses on financial reporting controls.',
    reference: 'AICPA SOC Suite',
    blueprintArea: 'ISC-III',
    skillLevel: 'Application',
  },
  {
    id: 'isc-soc-003',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Engagements',
    subtopic: 'SOC 1 vs SOC 2',
    difficulty: 'medium',
    question: 'A payroll processing service organization should obtain which type of SOC report for its financial statement audit clients?',
    options: [
      'SOC 1',
      'SOC 2',
      'SOC 3',
      'SOC for Supply Chain',
    ],
    correctAnswer: 0,
    explanation: 'SOC 1 reports address controls relevant to user entities\' internal control over financial reporting (ICFR). Payroll affects financial statements, so auditors need SOC 1. SOC 2 covers broader operational controls.',
    reference: 'SSAE 18',
    blueprintArea: 'ISC-III',
    skillLevel: 'Application',
  },
  {
    id: 'isc-soc-004',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Engagements',
    subtopic: 'Complementary User Entity Controls',
    difficulty: 'hard',
    question: 'In a SOC 1 report, "Complementary User Entity Controls" (CUECs) are:',
    options: [
      'Controls that the service auditor must test',
      'Controls that user organizations are expected to implement',
      'Controls that replace the service organization\'s controls',
      'Optional controls recommended but not required',
    ],
    correctAnswer: 1,
    explanation: 'CUECs are controls that the service organization\'s system design assumes user entities will implement. For example, a payroll service may assume clients review output reports. User auditors must verify these are in place.',
    reference: 'SSAE 18 - CUECs',
    blueprintArea: 'ISC-III',
    skillLevel: 'Analysis',
  },
  {
    id: 'isc-soc-005',
    section: 'ISC',
    topicId: 'isc-soc',
    topic: 'SOC Engagements',
    subtopic: 'Trust Services Criteria',
    difficulty: 'easy',
    question: 'The five Trust Services Criteria categories used in SOC 2 engagements are:',
    options: [
      'Security, Availability, Processing Integrity, Confidentiality, Privacy',
      'Security, Reliability, Accuracy, Completeness, Timeliness',
      'Governance, Risk, Compliance, Security, Operations',
      'Preventive, Detective, Corrective, Directive, Compensating',
    ],
    correctAnswer: 0,
    explanation: 'The TSC categories are Security (common criteria), Availability, Processing Integrity, Confidentiality, and Privacy. Security is required; others are included based on the service and user needs.',
    reference: 'AICPA Trust Services Criteria',
    blueprintArea: 'ISC-III',
    skillLevel: 'Remembering and Understanding',
  },

  // ==========================================
  // Additional ISC Questions
  // ==========================================

  {
    id: 'isc-net-001',
    section: 'ISC',
    topicId: 'isc-network',
    topic: 'Network Security',
    subtopic: 'Network Architecture',
    difficulty: 'medium',
    question: 'A "demilitarized zone" (DMZ) in network architecture is used to:',
    options: [
      'Store backup copies of sensitive data',
      'Host public-facing servers while protecting internal networks',
      'Encrypt all internal network traffic',
      'Monitor employee internet usage',
    ],
    correctAnswer: 1,
    explanation: 'A DMZ is a network segment between the internet and internal network, hosting servers that need external access (web servers, email) while keeping them isolated from sensitive internal systems.',
    reference: 'Network Security Architecture',
    blueprintArea: 'ISC-II',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-bc-001',
    section: 'ISC',
    topicId: 'isc-continuity',
    topic: 'Business Continuity',
    subtopic: 'Recovery Objectives',
    difficulty: 'medium',
    question: 'The Recovery Point Objective (RPO) defines:',
    options: [
      'The maximum time to restore operations after a disaster',
      'The maximum acceptable data loss measured in time',
      'The minimum number of backup copies required',
      'The budget allocated for disaster recovery',
    ],
    correctAnswer: 1,
    explanation: 'RPO is the maximum age of data that must be recovered. An RPO of 4 hours means backups must occur at least every 4 hours to limit data loss. RTO (Recovery Time Objective) is the time to restore operations.',
    reference: 'Business Continuity Planning',
    blueprintArea: 'ISC-II',
    skillLevel: 'Remembering and Understanding',
  },
  {
    id: 'isc-change-001',
    section: 'ISC',
    topicId: 'isc-itgc',
    topic: 'IT General Controls',
    subtopic: 'Change Management',
    difficulty: 'hard',
    question: 'Which of the following is the MOST critical control to prevent unauthorized changes to production financial systems?',
    options: [
      'Requiring all changes be documented in a change management system',
      'Separating development, test, and production environments with access restrictions',
      'Training developers on secure coding practices',
      'Performing code reviews before deployment',
    ],
    correctAnswer: 1,
    explanation: 'Environment segregation with access controls ensures developers cannot directly modify production systems. Documentation, training, and code reviews are important but rely on compliance; environment controls enforce separation.',
    reference: 'ITGC - Change Management',
    blueprintArea: 'ISC-I',
    skillLevel: 'Analysis',
  },
  {
    id: 'isc-audit-001',
    section: 'ISC',
    topicId: 'isc-audit',
    topic: 'IT Audit',
    subtopic: 'Audit Trails',
    difficulty: 'medium',
    question: 'Effective audit trails in a financial system should capture all of the following EXCEPT:',
    options: [
      'User ID performing the transaction',
      'Date and time of the transaction',
      'User\'s password at time of transaction',
      'Before and after values for changed data',
    ],
    correctAnswer: 2,
    explanation: 'Audit trails should capture who, what, when, and the change details. Storing passwords (even hashed) in audit logs is a security risk and unnecessary - the user ID proves identity was authenticated.',
    reference: 'Audit Trail Requirements',
    blueprintArea: 'ISC-I',
    skillLevel: 'Application',
  },
  {
    id: 'isc-cloud-001',
    section: 'ISC',
    topicId: 'isc-cloud',
    topic: 'Cloud Computing',
    subtopic: 'Service Models',
    difficulty: 'easy',
    question: 'In a Software as a Service (SaaS) cloud model, which party is responsible for patching the application software?',
    options: [
      'The customer organization',
      'The cloud service provider',
      'A third-party security vendor',
      'Responsibility is shared equally',
    ],
    correctAnswer: 1,
    explanation: 'In SaaS, the provider manages everything including applications, middleware, OS, and infrastructure. Customers are responsible only for their data and user access. IaaS shifts more responsibility to customers.',
    reference: 'Cloud Computing Models',
    blueprintArea: 'ISC-I',
    skillLevel: 'Remembering and Understanding',
  },
];

export default ISC_QUESTIONS;
