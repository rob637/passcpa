// TCP - Tax Compliance & Planning Comprehensive Questions
// 2026 CPA Exam Blueprint Compliant
// World-Class expansion - Final batch

import { Question } from '../../types';

export const TCP_QUESTIONS_COMPREHENSIVE: Question[] = [
  {
    id: 'tcp-comp-001',
    section: 'TCP',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'Passive Activity Grouping',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'Taxpayers may elect to group passive activities if:',
    options: [
      'They choose to',
      'Activities form an appropriate economic unit based on similarities in business type, location, or interdependence',
      'IRS approves',
      'All activities are profitable',
    ],
    correctAnswer: 1,
    explanation: 'Grouping election (Reg. 1.469-4): activities form appropriate economic unit. Factors: similarities of business, common control, common ownership, location, interdependence. Once grouped, treated as single activity. Regrouping limited.',
    reference: 'IRC §469 - Grouping Rules',
  },
  {
    id: 'tcp-comp-002',
    section: 'TCP',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'Self-Employment Tax',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'Self-employment tax is calculated on:',
    options: [
      'Gross self-employment income',
      '92.35% of net self-employment earnings (up to Social Security wage base for SS portion)',
      'Total wages',
      'Adjusted gross income',
    ],
    correctAnswer: 1,
    explanation: 'SE tax: 92.35% × net SE earnings (equivalent to employer share deduction). Social Security (12.4%) on earnings up to wage base. Medicare (2.9%) on all SE earnings. Additional 0.9% Medicare over $200K/$250K MFJ.',
    reference: 'IRC §1401, §1402',
  },
  {
    id: 'tcp-comp-003',
    section: 'TCP',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'Hobby Loss Rules',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'Under the hobby loss rules, an activity is presumed for profit if:',
    options: [
      'The taxpayer claims profit motive',
      'It produces profit in 3 of 5 consecutive years (2 of 7 for horses)',
      'There is any revenue',
      'It is registered as a business',
    ],
    correctAnswer: 1,
    explanation: '§183 hobby loss: presumption of profit motive if profit in 3 of 5 years (2 of 7 for horse breeding/racing). If hobby: income included, but post-TCJA no misc itemized deductions allowed. Nine factors considered.',
    reference: 'IRC §183',
  },
  {
    id: 'tcp-comp-004',
    section: 'TCP',
    topicId: 'tcp-corporate',
    topic: 'Corporate Taxation',
    subtopic: 'Earnings Stripping',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Analysis',
    question: 'The business interest limitation under §163(j) disallows:',
    options: [
      'All interest',
      'Business interest expense exceeding 30% of adjusted taxable income (with carryforward)',
      'Personal interest only',
      'Foreign interest only',
    ],
    correctAnswer: 1,
    explanation: '§163(j): limit business interest deduction to 30% of ATI (EBITDA through 2025, then EBIT). Excess carried forward indefinitely. Exceptions: small business ($29M gross receipts), electing real property/farming, floor plan financing.',
    reference: 'IRC §163(j)',
  },
  {
    id: 'tcp-comp-005',
    section: 'TCP',
    topicId: 'tcp-corporate',
    topic: 'Corporate Taxation',
    subtopic: 'Affiliated Groups',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Analysis',
    question: 'An affiliated group eligible for consolidated returns requires:',
    options: [
      'Any related corporations',
      'Common parent owning 80% vote and value of at least one subsidiary in unbroken chain',
      '51% ownership',
      'Same business activity',
    ],
    correctAnswer: 1,
    explanation: 'Affiliated group: common parent owns directly ≥80% vote AND value of at least one subsidiary. Each includible corporation must be 80% owned by group members. Exclusions: S corps, foreign corps, tax-exempt, certain REITs.',
    reference: 'IRC §1504',
  },
  {
    id: 'tcp-comp-006',
    section: 'TCP',
    topicId: 'tcp-scorp',
    topic: 'S Corporation',
    subtopic: 'Qualified Subchapter S Subsidiary',
    difficulty: 'hard',
    blueprintArea: 'TCP-III',
    skillLevel: 'Analysis',
    question: 'A QSub (Qualified Subchapter S Subsidiary) is:',
    options: [
      'Any subsidiary',
      'A 100%-owned domestic subsidiary of an S corp that elects QSub status, disregarded for federal tax',
      'An S corp shareholder',
      'A foreign subsidiary',
    ],
    correctAnswer: 1,
    explanation: 'QSub: 100% owned by S corp parent, elects disregarded status. Assets/liabilities/income treated as parent\'s. No separate return. Parent remains S corp. Election irrevocable for 5 years unless consent.',
    reference: 'IRC §1361(b)(3)',
  },
  {
    id: 'tcp-comp-007',
    section: 'TCP',
    topicId: 'tcp-scorp',
    topic: 'S Corporation',
    subtopic: 'Built-In Gains Tax',
    difficulty: 'hard',
    blueprintArea: 'TCP-III',
    skillLevel: 'Analysis',
    question: 'The built-in gains tax applies when an S corporation:',
    options: [
      'Elects S status',
      'Was formerly a C corp and sells appreciated assets within 5 years of conversion',
      'Has any gain',
      'Distributes property',
    ],
    correctAnswer: 1,
    explanation: 'BIG tax: former C corps face corporate-level tax (21%) on built-in gains recognized within recognition period (5 years). BIG = asset FMV at conversion - basis. NUBIG reduced by recognized gains. Prevents double benefit.',
    reference: 'IRC §1374',
  },
  {
    id: 'tcp-comp-008',
    section: 'TCP',
    topicId: 'tcp-partnership',
    topic: 'Partnership Taxation',
    subtopic: 'Substantial Economic Effect',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Evaluation',
    question: 'Special allocations in a partnership must have:',
    options: [
      'IRS approval',
      'Substantial economic effect (economic effect + substantiality) or be allocated according to partners\' interests',
      'Equal allocation',
      'Written consent only',
    ],
    correctAnswer: 1,
    explanation: 'Special allocation valid if substantial economic effect. Economic effect: capital account maintenance, liquidation per capital accounts, deficit restoration. Substantiality: reasonable possibility affects partners\' shares independent of tax.',
    reference: 'IRC §704(b) Regulations',
  },
  {
    id: 'tcp-comp-009',
    section: 'TCP',
    topicId: 'tcp-partnership',
    topic: 'Partnership Taxation',
    subtopic: 'Guaranteed Payments',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Analysis',
    question: 'Guaranteed payments to partners are:',
    options: [
      'Distributions',
      'Payments for services or capital use determined without regard to partnership income',
      'Loans',
      'Return of capital',
    ],
    correctAnswer: 1,
    explanation: 'Guaranteed payments: compensation for services or capital, not dependent on partnership income. Deductible by partnership (ordinary), ordinary income to partner. Timing: partner\'s year includes partnership year-end.',
    reference: 'IRC §707(c)',
  },
  {
    id: 'tcp-comp-010',
    section: 'TCP',
    topicId: 'tcp-property',
    topic: 'Property Transactions',
    subtopic: 'Installment Sales Limitations',
    difficulty: 'hard',
    blueprintArea: 'TCP-V',
    skillLevel: 'Analysis',
    question: 'Installment sale treatment is NOT available for:',
    options: [
      'Real estate sales',
      'Dealer dispositions, depreciation recapture, or publicly traded securities',
      'Personal property sales',
      'Sales to related parties',
    ],
    correctAnswer: 1,
    explanation: 'Installment sale exclusions: dealer property, inventory, stocks/securities, §1245/1250 recapture (recognized in year of sale). Related party rules: if buyer disposes within 2 years, accelerate seller\'s remaining gain.',
    reference: 'IRC §453',
  },
  {
    id: 'tcp-comp-011',
    section: 'TCP',
    topicId: 'tcp-property',
    topic: 'Property Transactions',
    subtopic: 'Opportunity Zones',
    difficulty: 'hard',
    blueprintArea: 'TCP-V',
    skillLevel: 'Analysis',
    question: 'A Qualified Opportunity Zone investment provides:',
    options: [
      'Immediate tax exemption',
      'Gain deferral until 2026, basis step-up, and potential exclusion of new appreciation after 10 years',
      'Tax credits only',
      'Depreciation benefits only',
    ],
    correctAnswer: 1,
    explanation: 'QOZ benefits: (1) defer original capital gain until 2026 (or earlier sale), (2) basis step-up for gains in QOZ (was 10%/5yr, 15%/7yr - expired), (3) exclude appreciation after 10-year hold. Must invest within 180 days of gain.',
    reference: 'IRC §1400Z-2',
  },
  {
    id: 'tcp-comp-012',
    section: 'TCP',
    topicId: 'tcp-international',
    topic: 'International Taxation',
    subtopic: 'Subpart F Income',
    difficulty: 'hard',
    blueprintArea: 'TCP-VI',
    skillLevel: 'Analysis',
    question: 'Subpart F income includes:',
    options: [
      'All foreign income',
      'Foreign base company income and insurance income that is currently taxable to US shareholders',
      'Operating income only',
      'Dividends only',
    ],
    correctAnswer: 1,
    explanation: 'Subpart F: CFC income currently taxed to US shareholders (>10% vote/value). Includes: foreign personal holding company income, foreign base company sales/services income, insurance income. Anti-deferral regime.',
    reference: 'IRC §951, §954',
  },
  {
    id: 'tcp-comp-013',
    section: 'TCP',
    topicId: 'tcp-international',
    topic: 'International Taxation',
    subtopic: 'GILTI',
    difficulty: 'hard',
    blueprintArea: 'TCP-VI',
    skillLevel: 'Analysis',
    question: 'Global Intangible Low-Taxed Income (GILTI) is:',
    options: [
      'A foreign tax',
      'CFC tested income exceeding 10% of qualified business asset investment (QBAI)',
      'All CFC income',
      'Intangible property only',
    ],
    correctAnswer: 1,
    explanation: 'GILTI = CFC tested income - (10% × QBAI) - interest expense. Taxed currently to US shareholders. 50% deduction (37.5% after 2025) for C corps, resulting in effective 10.5% rate. FTC available (limited). Annual inclusion.',
    reference: 'IRC §951A',
  },
  {
    id: 'tcp-comp-014',
    section: 'TCP',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'Kiddie Tax',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Application',
    question: 'The kiddie tax applies to unearned income of:',
    options: [
      'All children',
      'Children under 19 (or under 24 if student) with unearned income above threshold, taxed at parents\' rate',
      'Adult dependents only',
      'Self-employment income',
    ],
    correctAnswer: 1,
    explanation: 'Kiddie tax: child\'s unearned income above threshold ($2,500 for 2024) taxed at parents\' marginal rate. Applies: under 19, or under 24 if student and not self-supporting. Prevents income shifting. Form 8615.',
    reference: 'IRC §1(g)',
  },
  {
    id: 'tcp-comp-015',
    section: 'TCP',
    topicId: 'tcp-estate',
    topic: 'Estate & Gift Tax',
    subtopic: 'Generation-Skipping Tax',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'The generation-skipping transfer tax applies to:',
    options: [
      'All gifts',
      'Transfers to beneficiaries more than one generation below the transferor (skip persons)',
      'Spouse gifts only',
      'Charitable transfers',
    ],
    correctAnswer: 1,
    explanation: 'GST tax: prevents avoiding estate tax by skipping generations. Skip person = 2+ generations below (grandchild). Types: direct skip, taxable termination, taxable distribution. Separate GST exemption ($13.61M for 2024). 40% flat rate.',
    reference: 'IRC §§2601-2664',
  },
  {
    id: 'tcp-comp-016',
    section: 'TCP',
    topicId: 'tcp-estate',
    topic: 'Estate & Gift Tax',
    subtopic: 'Special Use Valuation',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'Special use valuation under §2032A allows:',
    options: [
      'FMV reduction for any property',
      'Qualifying farm or business real property to be valued based on actual use rather than highest and best use',
      'Immediate step-up',
      'Unlimited reduction',
    ],
    correctAnswer: 1,
    explanation: '§2032A: value farm/business realty at actual use (not development potential). Requirements: 50% of estate in farm/business, 25% in real property, qualified use 5 of 8 years before death, heir continues use. Recapture if sold/changed within 10 years.',
    reference: 'IRC §2032A',
  },
  {
    id: 'tcp-comp-017',
    section: 'TCP',
    topicId: 'tcp-corporate',
    topic: 'Corporate Taxation',
    subtopic: 'Corporate Alternative Minimum Tax',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Analysis',
    question: 'The new Corporate Alternative Minimum Tax (CAMT) applies to:',
    options: [
      'All corporations',
      'Corporations with average annual adjusted financial statement income exceeding $1 billion',
      'Small businesses',
      'S corporations',
    ],
    correctAnswer: 1,
    explanation: 'CAMT (post-IRA 2022): 15% minimum tax on adjusted financial statement income for corporations averaging >$1B book income (3-year test). Adjustments for depreciation, NOLs, tax credits. FTC allowed. Tentative minimum tax minus regular tax.',
    reference: 'IRC §55 (as amended)',
  },
  {
    id: 'tcp-comp-018',
    section: 'TCP',
    topicId: 'tcp-qbi',
    topic: 'Qualified Business Income',
    subtopic: 'SSTB Limitations',
    difficulty: 'hard',
    blueprintArea: 'TCP-IV',
    skillLevel: 'Analysis',
    question: 'Specified service trades or businesses (SSTBs) face QBI deduction limitations when:',
    options: [
      'Always limited',
      'Taxable income exceeds the threshold amount ($182,100 single / $364,200 MFJ for 2024)',
      'Any service income',
      'Never limited',
    ],
    correctAnswer: 1,
    explanation: 'SSTB: health, law, accounting, actuarial, performing arts, consulting, athletics, financial services, brokerage, reputation-based. Above threshold: phaseout over $50K/$100K. Fully excluded above. Non-SSTB uses W-2/capital limits.',
    reference: 'IRC §199A(d)',
  },
  {
    id: 'tcp-comp-019',
    section: 'TCP',
    topicId: 'tcp-individual',
    topic: 'Individual Taxation',
    subtopic: 'State Tax Workarounds',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'Pass-through entity (PTE) elective taxes allow:',
    options: [
      'Unlimited SALT deduction',
      'Entity-level state tax payment deductible by the entity, bypassing $10,000 SALT cap for owners',
      'Federal tax credits',
      'State tax elimination',
    ],
    correctAnswer: 1,
    explanation: 'PTE tax election: many states allow pass-through entities to pay state tax at entity level. Deductible for federal purposes (no $10K limit). Owner receives credit/adjustment for state taxes. IRS Notice 2020-75 blessed.',
    reference: 'IRS Notice 2020-75',
  },
  {
    id: 'tcp-comp-020',
    section: 'TCP',
    topicId: 'tcp-retirement',
    topic: 'Retirement Planning',
    subtopic: 'Roth Conversions',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Analysis',
    question: 'A Roth conversion strategy is most beneficial when:',
    options: [
      'Always beneficial',
      'Current tax rate is lower than expected future rate, and taxpayer can pay tax from non-retirement funds',
      'Taxpayer needs immediate income',
      'Already in highest bracket',
    ],
    correctAnswer: 1,
    explanation: 'Roth conversion: pay tax now for tax-free future growth/withdrawals. Best when: current low bracket, long time horizon, can pay tax externally. Consider: Medicare surcharges, ACA subsidies, state taxes. No income limits for conversion.',
    reference: 'IRC §408A - Roth IRAs',
  },
  {
    id: 'tcp-comp-021',
    section: 'TCP',
    topicId: 'tcp-credits',
    topic: 'Tax Credits',
    subtopic: 'R&D Credit',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Analysis',
    question: 'The R&D tax credit under §41 requires activities that:',
    options: [
      'Are routine quality control',
      'Involve technological uncertainty, process of experimentation, and qualified purpose (new/improved product/process)',
      'Use existing technology',
      'Are market research',
    ],
    correctAnswer: 1,
    explanation: '§41 R&D credit: 4-part test: (1) permitted purpose (new/improved function, performance, reliability, quality), (2) technological uncertainty, (3) process of experimentation, (4) technological in nature. QREs: wages, supplies, contract research.',
    reference: 'IRC §41',
  },
  {
    id: 'tcp-comp-022',
    section: 'TCP',
    topicId: 'tcp-credits',
    topic: 'Tax Credits',
    subtopic: 'Energy Credits',
    difficulty: 'hard',
    blueprintArea: 'TCP-II',
    skillLevel: 'Application',
    question: 'The Inflation Reduction Act enhanced clean energy tax credits by:',
    options: [
      'Eliminating all credits',
      'Extending credits, adding transferability, and bonus credits for domestic content/prevailing wage',
      'Reducing credit amounts',
      'Limiting to corporations',
    ],
    correctAnswer: 1,
    explanation: 'IRA 2022: extended ITC/PTC through 2032+, added direct pay for tax-exempt entities, transferability to third parties, bonus credits for domestic content, prevailing wage/apprenticeship, energy communities, low-income.',
    reference: 'Inflation Reduction Act - Clean Energy',
  },
  {
    id: 'tcp-comp-023',
    section: 'TCP',
    topicId: 'tcp-international',
    topic: 'International Taxation',
    subtopic: 'BEAT',
    difficulty: 'hard',
    blueprintArea: 'TCP-VI',
    skillLevel: 'Analysis',
    question: 'The Base Erosion and Anti-Abuse Tax (BEAT) applies to:',
    options: [
      'All taxpayers',
      'Large corporations making significant deductible payments to foreign related parties',
      'Individuals only',
      'Domestic transactions',
    ],
    correctAnswer: 1,
    explanation: 'BEAT: corporations with >$500M gross receipts and >3% base erosion percentage. 10% tax on modified taxable income (adds back base erosion payments). Payments: interest, royalties, services to foreign related parties. R&D credit allowed.',
    reference: 'IRC §59A',
  },
  {
    id: 'tcp-comp-024',
    section: 'TCP',
    topicId: 'tcp-property',
    topic: 'Property Transactions',
    subtopic: 'Related Party Sales',
    difficulty: 'hard',
    blueprintArea: 'TCP-V',
    skillLevel: 'Analysis',
    question: 'Losses on sales between related parties are:',
    options: [
      'Fully deductible',
      'Disallowed to seller but buyer gets carryover basis that may offset gain on subsequent sale',
      'Capitalized',
      'Ordinary deductions',
    ],
    correctAnswer: 1,
    explanation: '§267 related party loss: disallowed. Buyer\'s basis = cost. On buyer\'s subsequent sale to unrelated party, gain reduced (not below zero) by disallowed loss. Constructive ownership rules apply. Does not apply to controlled group sales.',
    reference: 'IRC §267',
  },
  {
    id: 'tcp-comp-025',
    section: 'TCP',
    topicId: 'tcp-procedures',
    topic: 'Tax Procedures',
    subtopic: 'Statute of Limitations',
    difficulty: 'hard',
    blueprintArea: 'TCP-I',
    skillLevel: 'Application',
    question: 'The statute of limitations for IRS assessment is extended to 6 years when:',
    options: [
      'Any adjustment is made',
      'Gross income is understated by more than 25% of the amount reported',
      'A refund is claimed',
      'The taxpayer files late',
    ],
    correctAnswer: 1,
    explanation: 'Normal: 3 years from later of due date or filing. 6-year statute: >25% gross income omission (including items not included - overstatement of basis). Unlimited: fraud, no return filed. Taxpayer can consent to extend.',
    reference: 'IRC §6501',
  },
];
